{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/redis/client.ts"],"sourcesContent":["import { Redis } from '@upstash/redis';\n\nfunction getRedisClient(): Redis {\n  const url = process.env.UPSTASH_REDIS_REST_URL;\n  const token = process.env.UPSTASH_REDIS_REST_TOKEN;\n\n  if (!url || !token) {\n    // During build time, return a dummy client that will fail gracefully\n    if (process.env.NODE_ENV === 'production' && typeof window === 'undefined') {\n      console.error('Redis credentials not configured');\n    }\n    // Return a Redis instance that will fail on actual operations\n    // This allows the build to succeed\n    return new Redis({\n      url: url || 'https://placeholder.upstash.io',\n      token: token || 'placeholder',\n    });\n  }\n\n  return new Redis({ url, token });\n}\n\nexport const redis = getRedisClient();\nexport default redis;\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,SAAS;IACP,MAAM,MAAM,QAAQ,GAAG,CAAC,sBAAsB;IAC9C,MAAM,QAAQ,QAAQ,GAAG,CAAC,wBAAwB;IAElD,IAAI,CAAC,OAAO,CAAC,OAAO;QAClB,qEAAqE;QACrE;;QAGA,8DAA8D;QAC9D,mCAAmC;QACnC,OAAO,IAAI,wOAAK,CAAC;YACf,KAAK,OAAO;YACZ,OAAO,SAAS;QAClB;IACF;IAEA,OAAO,IAAI,wOAAK,CAAC;QAAE;QAAK;IAAM;AAChC;AAEO,MAAM,QAAQ;uCACN"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/redis/keys.ts"],"sourcesContent":["// Redis Key Patterns for Partner Portal\n\nexport const keys = {\n  // Partners\n  partner: (id: string) => `partner:${id}`,\n  partnerUsers: (partnerId: string) => `partner:${partnerId}:users`,\n  partnersByTier: (tier: string) => `partners:by-tier:${tier}`,\n  partnersByStatus: (status: string) => `partners:by-status:${status}`,\n  partnersByCountry: (country: string) => `partners:by-country:${country}`,\n  allPartners: () => `partners:all`,\n\n  // Partner Credentials (SovraID)\n  partnerCredential: (id: string) => `credential:${id}`,\n  partnerCredentials: (partnerId: string) => `partner:${partnerId}:credentials`,\n  allCredentials: () => `credentials:all`,\n  credentialsByStatus: (status: string) => `credentials:by-status:${status}`,\n  credentialByEmail: (email: string) => `credential:email:${email.toLowerCase()}`,\n\n  // Users & Sessions\n  user: (id: string) => `user:${id}`,\n  userByEmail: (email: string) => `user:email:${email.toLowerCase()}`,\n  session: (id: string) => `session:${id}`,\n\n  // Deals\n  deal: (id: string) => `deal:${id}`,\n  partnerDeals: (partnerId: string) => `partner:${partnerId}:deals`,\n  dealsByDomain: (domain: string) => `deals:by-domain:${domain.toLowerCase()}`,\n  dealsByStage: (stage: string) => `deals:by-stage:${stage}`,\n  dealsByStatus: (status: string) => `deals:by-status:${status}`,\n  allDeals: () => `deals:all`,\n\n  // Quotes\n  quote: (id: string) => `quote:${id}`,\n  dealQuotes: (dealId: string) => `deal:${dealId}:quotes`,\n  partnerQuotes: (partnerId: string) => `partner:${partnerId}:quotes`,\n\n  // Pricing Configuration\n  pricingConfig: () => `pricing:config`,\n\n  // Training & Certifications\n  trainingModule: (id: string) => `training:module:${id}`,\n  trainingModules: () => `training:modules`,\n  userTrainingProgress: (userId: string) => `user:${userId}:training:progress`,\n  certification: (id: string) => `certification:${id}`,\n  userCertifications: (userId: string) => `user:${userId}:certifications`,\n  partnerCertifications: (partnerId: string) => `partner:${partnerId}:certifications`,\n\n  // Legal - Legacy\n  legalDocument: (id: string) => `legal:document:${id}`,\n  legalDocuments: () => `legal:documents`,\n  legalSignature: (id: string) => `legal:signature:${id}`,\n  userSignatures: (userId: string) => `user:${userId}:signatures`,\n  partnerSignatures: (partnerId: string) => `partner:${partnerId}:signatures`,\n\n  // Legal - Enhanced Documents\n  legalDocumentV2: (id: string) => `legal:v2:document:${id}`,\n  partnerLegalDocuments: (partnerId: string) => `partner:${partnerId}:legal:documents`,\n  allLegalDocumentsV2: () => `legal:v2:all`,\n  legalDocumentsByCategory: (category: string) => `legal:v2:by-category:${category}`,\n  legalDocumentsByStatus: (status: string) => `legal:v2:by-status:${status}`,\n  docusignEnvelope: (envelopeId: string) => `legal:docusign:envelope:${envelopeId}`,\n\n  // Legal - Audit Events\n  documentAuditEvents: (documentId: string) => `legal:v2:document:${documentId}:audit`,\n  documentAuditEvent: (eventId: string) => `legal:v2:audit:${eventId}`,\n\n  // Copilot\n  copilotSession: (id: string) => `copilot:session:${id}`,\n  copilotMessages: (sessionId: string) => `copilot:session:${sessionId}:messages`,\n  copilotMeddic: (sessionId: string) => `copilot:session:${sessionId}:meddic`,\n  dealCopilotSessions: (dealId: string) => `deal:${dealId}:copilot:sessions`,\n\n  // Commissions\n  commission: (id: string) => `commission:${id}`,\n  partnerCommissions: (partnerId: string) => `partner:${partnerId}:commissions`,\n  dealCommission: (dealId: string) => `deal:${dealId}:commission`,\n\n  // Rating\n  ratingEvents: (partnerId: string) => `partner:${partnerId}:rating:events`,\n  ratingCalculation: (partnerId: string) => `partner:${partnerId}:rating:calculation`,\n  partnerLastLogin: (partnerId: string) => `partner:${partnerId}:last-login`,\n\n  // Training Courses (Admin-managed)\n  trainingCourse: (id: string) => `training:course:${id}`,\n  allTrainingCourses: () => `training:courses:all`,\n  publishedTrainingCourses: () => `training:courses:published`,\n  trainingCoursesByCategory: (category: string) => `training:courses:by-category:${category}`,\n  userCourseProgress: (userId: string) => `user:${userId}:courses:progress`,\n\n  // Audit Logs\n  auditLog: (id: string) => `audit:log:${id}`,\n  allAuditLogs: () => `audit:logs:all`,\n  auditLogsByEntity: (entityType: string, entityId: string) => `audit:logs:entity:${entityType}:${entityId}`,\n  auditLogsByAction: (action: string) => `audit:logs:by-action:${action}`,\n  auditLogsByActor: (actorId: string) => `audit:logs:by-actor:${actorId}`,\n\n  // Rewards system keys\n  rewardPoints: (partnerId: string) => `partner:${partnerId}:reward-points`,\n  achievements: (partnerId: string) => `partner:${partnerId}:achievements`,\n  rewardsLeaderboard: () => `partners:rewards-leaderboard`,\n  rewardEvents: (partnerId: string) => `partner:${partnerId}:reward-events`,\n  partnerStats: (partnerId: string) => `partner:${partnerId}:stats`,\n};\n\n// TTL values in seconds\nexport const TTL = {\n  session: 24 * 60 * 60, // 24 hours\n  dealExclusivity: 90 * 24 * 60 * 60, // 90 days\n  copilotSession: 7 * 24 * 60 * 60, // 7 days\n};\n"],"names":[],"mappings":"AAAA,wCAAwC;;;;;;;AAEjC,MAAM,OAAO;IAClB,WAAW;IACX,SAAS,CAAC,KAAe,CAAC,QAAQ,EAAE,IAAI;IACxC,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,MAAM,CAAC;IACjE,gBAAgB,CAAC,OAAiB,CAAC,iBAAiB,EAAE,MAAM;IAC5D,kBAAkB,CAAC,SAAmB,CAAC,mBAAmB,EAAE,QAAQ;IACpE,mBAAmB,CAAC,UAAoB,CAAC,oBAAoB,EAAE,SAAS;IACxE,aAAa,IAAM,CAAC,YAAY,CAAC;IAEjC,gCAAgC;IAChC,mBAAmB,CAAC,KAAe,CAAC,WAAW,EAAE,IAAI;IACrD,oBAAoB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,YAAY,CAAC;IAC7E,gBAAgB,IAAM,CAAC,eAAe,CAAC;IACvC,qBAAqB,CAAC,SAAmB,CAAC,sBAAsB,EAAE,QAAQ;IAC1E,mBAAmB,CAAC,QAAkB,CAAC,iBAAiB,EAAE,MAAM,WAAW,IAAI;IAE/E,mBAAmB;IACnB,MAAM,CAAC,KAAe,CAAC,KAAK,EAAE,IAAI;IAClC,aAAa,CAAC,QAAkB,CAAC,WAAW,EAAE,MAAM,WAAW,IAAI;IACnE,SAAS,CAAC,KAAe,CAAC,QAAQ,EAAE,IAAI;IAExC,QAAQ;IACR,MAAM,CAAC,KAAe,CAAC,KAAK,EAAE,IAAI;IAClC,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,MAAM,CAAC;IACjE,eAAe,CAAC,SAAmB,CAAC,gBAAgB,EAAE,OAAO,WAAW,IAAI;IAC5E,cAAc,CAAC,QAAkB,CAAC,eAAe,EAAE,OAAO;IAC1D,eAAe,CAAC,SAAmB,CAAC,gBAAgB,EAAE,QAAQ;IAC9D,UAAU,IAAM,CAAC,SAAS,CAAC;IAE3B,SAAS;IACT,OAAO,CAAC,KAAe,CAAC,MAAM,EAAE,IAAI;IACpC,YAAY,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,OAAO,CAAC;IACvD,eAAe,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,OAAO,CAAC;IAEnE,wBAAwB;IACxB,eAAe,IAAM,CAAC,cAAc,CAAC;IAErC,4BAA4B;IAC5B,gBAAgB,CAAC,KAAe,CAAC,gBAAgB,EAAE,IAAI;IACvD,iBAAiB,IAAM,CAAC,gBAAgB,CAAC;IACzC,sBAAsB,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,kBAAkB,CAAC;IAC5E,eAAe,CAAC,KAAe,CAAC,cAAc,EAAE,IAAI;IACpD,oBAAoB,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,eAAe,CAAC;IACvE,uBAAuB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,eAAe,CAAC;IAEnF,iBAAiB;IACjB,eAAe,CAAC,KAAe,CAAC,eAAe,EAAE,IAAI;IACrD,gBAAgB,IAAM,CAAC,eAAe,CAAC;IACvC,gBAAgB,CAAC,KAAe,CAAC,gBAAgB,EAAE,IAAI;IACvD,gBAAgB,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,WAAW,CAAC;IAC/D,mBAAmB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,WAAW,CAAC;IAE3E,6BAA6B;IAC7B,iBAAiB,CAAC,KAAe,CAAC,kBAAkB,EAAE,IAAI;IAC1D,uBAAuB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,gBAAgB,CAAC;IACpF,qBAAqB,IAAM,CAAC,YAAY,CAAC;IACzC,0BAA0B,CAAC,WAAqB,CAAC,qBAAqB,EAAE,UAAU;IAClF,wBAAwB,CAAC,SAAmB,CAAC,mBAAmB,EAAE,QAAQ;IAC1E,kBAAkB,CAAC,aAAuB,CAAC,wBAAwB,EAAE,YAAY;IAEjF,uBAAuB;IACvB,qBAAqB,CAAC,aAAuB,CAAC,kBAAkB,EAAE,WAAW,MAAM,CAAC;IACpF,oBAAoB,CAAC,UAAoB,CAAC,eAAe,EAAE,SAAS;IAEpE,UAAU;IACV,gBAAgB,CAAC,KAAe,CAAC,gBAAgB,EAAE,IAAI;IACvD,iBAAiB,CAAC,YAAsB,CAAC,gBAAgB,EAAE,UAAU,SAAS,CAAC;IAC/E,eAAe,CAAC,YAAsB,CAAC,gBAAgB,EAAE,UAAU,OAAO,CAAC;IAC3E,qBAAqB,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,iBAAiB,CAAC;IAE1E,cAAc;IACd,YAAY,CAAC,KAAe,CAAC,WAAW,EAAE,IAAI;IAC9C,oBAAoB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,YAAY,CAAC;IAC7E,gBAAgB,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,WAAW,CAAC;IAE/D,SAAS;IACT,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,cAAc,CAAC;IACzE,mBAAmB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,mBAAmB,CAAC;IACnF,kBAAkB,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,WAAW,CAAC;IAE1E,mCAAmC;IACnC,gBAAgB,CAAC,KAAe,CAAC,gBAAgB,EAAE,IAAI;IACvD,oBAAoB,IAAM,CAAC,oBAAoB,CAAC;IAChD,0BAA0B,IAAM,CAAC,0BAA0B,CAAC;IAC5D,2BAA2B,CAAC,WAAqB,CAAC,6BAA6B,EAAE,UAAU;IAC3F,oBAAoB,CAAC,SAAmB,CAAC,KAAK,EAAE,OAAO,iBAAiB,CAAC;IAEzE,aAAa;IACb,UAAU,CAAC,KAAe,CAAC,UAAU,EAAE,IAAI;IAC3C,cAAc,IAAM,CAAC,cAAc,CAAC;IACpC,mBAAmB,CAAC,YAAoB,WAAqB,CAAC,kBAAkB,EAAE,WAAW,CAAC,EAAE,UAAU;IAC1G,mBAAmB,CAAC,SAAmB,CAAC,qBAAqB,EAAE,QAAQ;IACvE,kBAAkB,CAAC,UAAoB,CAAC,oBAAoB,EAAE,SAAS;IAEvE,sBAAsB;IACtB,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,cAAc,CAAC;IACzE,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,aAAa,CAAC;IACxE,oBAAoB,IAAM,CAAC,4BAA4B,CAAC;IACxD,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,cAAc,CAAC;IACzE,cAAc,CAAC,YAAsB,CAAC,QAAQ,EAAE,UAAU,MAAM,CAAC;AACnE;AAGO,MAAM,MAAM;IACjB,SAAS,KAAK,KAAK;IACnB,iBAAiB,KAAK,KAAK,KAAK;IAChC,gBAAgB,IAAI,KAAK,KAAK;AAChC"}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/redis/operations.ts"],"sourcesContent":["import { redis } from './client';\nimport { keys, TTL } from './keys';\nimport type {\n  Partner,\n  PartnerTier,\n  PartnerCredential,\n  CredentialStatus,\n  User,\n  Session,\n  Deal,\n  DealStage,\n  DealStatus,\n  Quote,\n  PricingConfig,\n  TrainingModule,\n  TrainingProgress,\n  TrainingCourse,\n  Certification,\n  LegalDocument,\n  LegalSignature,\n  CopilotSession,\n  CopilotMessage,\n  Commission,\n  MEDDICScores,\n  DocumentCategory,\n  DocumentStatus,\n  DocumentAuditEvent,\n  LegacyLegalDocument,\n  AuditLog,\n  AuditAction,\n} from '@/types';\n\n// Helper to convert objects to Redis-compatible format\nfunction toRedisHash<T extends object>(obj: T): Record<string, string | number | boolean> {\n  const result: Record<string, string | number | boolean> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    if (value === null || value === undefined) {\n      result[key] = '';\n    } else if (typeof value === 'object') {\n      result[key] = JSON.stringify(value);\n    } else {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n\n// Generate unique IDs\nexport function generateId(): string {\n  return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n\n// ============ Partner Operations ============\n\nexport async function getPartner(id: string): Promise<Partner | null> {\n  const partner = await redis.hgetall(keys.partner(id)) as Partner | null;\n  if (!partner || !partner.id) return null;\n  // Parse numbers\n  if (typeof partner.rating === 'string') partner.rating = parseFloat(partner.rating);\n  if (typeof partner.totalDeals === 'string') partner.totalDeals = parseInt(partner.totalDeals, 10);\n  if (typeof partner.wonDeals === 'string') partner.wonDeals = parseInt(partner.wonDeals, 10);\n  if (typeof partner.totalRevenue === 'string') partner.totalRevenue = parseFloat(partner.totalRevenue);\n  // Parse certifications if JSON\n  if (typeof partner.certifications === 'string' && partner.certifications) {\n    partner.certifications = JSON.parse(partner.certifications);\n  }\n  return partner;\n}\n\nexport async function createPartner(partner: Partner): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  const partnerData = {\n    ...partner,\n    certifications: partner.certifications ? JSON.stringify(partner.certifications) : '',\n  };\n\n  pipeline.hset(keys.partner(partner.id), toRedisHash(partnerData));\n\n  // Add to tier index\n  pipeline.zadd(keys.partnersByTier(partner.tier), {\n    score: partner.rating,\n    member: partner.id,\n  });\n\n  // Add to status index\n  pipeline.sadd(keys.partnersByStatus(partner.status), partner.id);\n\n  // Add to country index\n  if (partner.country) {\n    pipeline.sadd(keys.partnersByCountry(partner.country), partner.id);\n  }\n\n  // Add to all partners sorted by creation time\n  pipeline.zadd(keys.allPartners(), {\n    score: new Date(partner.createdAt).getTime(),\n    member: partner.id,\n  });\n\n  await pipeline.exec();\n}\n\nexport async function getAllPartners(limit = 100): Promise<Partner[]> {\n  // First try the allPartners index\n  let partnerIds = await redis.zrange<string[]>(keys.allPartners(), 0, limit - 1, { rev: true });\n\n  // If empty, scan for partner keys (for existing data)\n  if (!partnerIds.length) {\n    const partnerKeys = await redis.keys('partner:*');\n    partnerIds = partnerKeys\n      .filter(k => !k.includes(':') || k.split(':').length === 2) // Only partner:{id} keys\n      .filter(k => !k.includes('users') && !k.includes('deals') && !k.includes('legal'))\n      .map(k => k.replace('partner:', ''));\n  }\n\n  if (!partnerIds.length) return [];\n\n  const partners = await Promise.all(partnerIds.map(id => getPartner(id)));\n  return partners.filter((p): p is Partner => p !== null);\n}\n\nexport async function getPartnersByStatus(status: 'active' | 'suspended'): Promise<Partner[]> {\n  const partnerIds = await redis.smembers<string[]>(keys.partnersByStatus(status));\n  if (!partnerIds.length) return [];\n  const partners = await Promise.all(partnerIds.map(id => getPartner(id)));\n  return partners.filter((p): p is Partner => p !== null);\n}\n\nexport async function getPartnersByTier(tier: PartnerTier): Promise<Partner[]> {\n  const partnerIds = await redis.zrange<string[]>(keys.partnersByTier(tier), 0, -1);\n  if (!partnerIds.length) return [];\n  const partners = await Promise.all(partnerIds.map(id => getPartner(id)));\n  return partners.filter((p): p is Partner => p !== null);\n}\n\nexport async function getPartnersByCountry(country: string): Promise<Partner[]> {\n  const partnerIds = await redis.smembers<string[]>(keys.partnersByCountry(country));\n  if (!partnerIds.length) return [];\n  const partners = await Promise.all(partnerIds.map(id => getPartner(id)));\n  return partners.filter((p): p is Partner => p !== null);\n}\n\nexport async function updatePartner(id: string, updates: Partial<Partner>): Promise<void> {\n  const partner = await getPartner(id);\n  if (!partner) throw new Error('Partner not found');\n\n  const pipeline = redis.pipeline();\n\n  const updateData: Record<string, unknown> = { ...updates, updatedAt: new Date().toISOString() };\n  if (updates.certifications) updateData.certifications = JSON.stringify(updates.certifications);\n\n  pipeline.hset(keys.partner(id), toRedisHash(updateData as Record<string, unknown>));\n\n  // Update tier index if changed\n  if (updates.tier && updates.tier !== partner.tier) {\n    pipeline.zrem(keys.partnersByTier(partner.tier), id);\n    pipeline.zadd(keys.partnersByTier(updates.tier), {\n      score: updates.rating ?? partner.rating,\n      member: id,\n    });\n  }\n\n  // Update status index if changed\n  if (updates.status && updates.status !== partner.status) {\n    pipeline.srem(keys.partnersByStatus(partner.status), id);\n    pipeline.sadd(keys.partnersByStatus(updates.status), id);\n  }\n\n  // Update country index if changed\n  if (updates.country && updates.country !== partner.country) {\n    if (partner.country) {\n      pipeline.srem(keys.partnersByCountry(partner.country), id);\n    }\n    pipeline.sadd(keys.partnersByCountry(updates.country), id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function suspendPartner(\n  id: string,\n  suspendedBy: string,\n  reason: string\n): Promise<void> {\n  await updatePartner(id, {\n    status: 'suspended',\n    suspendedAt: new Date().toISOString(),\n    suspendedBy,\n    suspendedReason: reason,\n  });\n}\n\nexport async function reactivatePartner(id: string): Promise<void> {\n  const partner = await getPartner(id);\n  if (!partner) throw new Error('Partner not found');\n\n  const pipeline = redis.pipeline();\n\n  // Clear suspension fields and set active\n  pipeline.hset(keys.partner(id), toRedisHash({\n    status: 'active',\n    suspendedAt: '',\n    suspendedBy: '',\n    suspendedReason: '',\n    updatedAt: new Date().toISOString(),\n  }));\n\n  // Update status index\n  pipeline.srem(keys.partnersByStatus('suspended'), id);\n  pipeline.sadd(keys.partnersByStatus('active'), id);\n\n  await pipeline.exec();\n}\n\nexport async function deletePartner(id: string): Promise<void> {\n  const partner = await getPartner(id);\n  if (!partner) throw new Error('Partner not found');\n\n  const pipeline = redis.pipeline();\n\n  // Delete partner hash\n  pipeline.del(keys.partner(id));\n\n  // Remove from all indexes\n  pipeline.zrem(keys.allPartners(), id);\n  pipeline.zrem(keys.partnersByTier(partner.tier), id);\n  pipeline.srem(keys.partnersByStatus(partner.status), id);\n  if (partner.country) {\n    pipeline.srem(keys.partnersByCountry(partner.country), id);\n  }\n\n  // Get and delete all partner deals\n  const dealIds = await redis.zrange<string[]>(keys.partnerDeals(id), 0, -1);\n  for (const dealId of dealIds) {\n    pipeline.del(`deal:${dealId}`);\n    pipeline.zrem(keys.allDeals(), dealId);\n  }\n  pipeline.del(keys.partnerDeals(id));\n\n  // Get and delete all partner credentials\n  const credentialIds = await redis.smembers<string[]>(keys.partnerCredentials(id));\n  for (const credId of credentialIds) {\n    pipeline.del(keys.partnerCredential(credId));\n  }\n  pipeline.del(keys.partnerCredentials(id));\n\n  // Delete partner users\n  const userIds = await redis.smembers<string[]>(keys.partnerUsers(id));\n  for (const userId of userIds) {\n    const user = await redis.hgetall(`user:${userId}`) as { email?: string } | null;\n    if (user?.email) {\n      pipeline.del(`user:email:${user.email}`);\n    }\n    pipeline.del(`user:${userId}`);\n  }\n  pipeline.del(keys.partnerUsers(id));\n\n  // Delete partner legal documents\n  pipeline.del(`partner:${id}:legal:documents`);\n  pipeline.del(`partner:${id}:signatures`);\n\n  // Delete partner certifications\n  pipeline.del(`partner:${id}:certifications`);\n\n  // Delete partner commissions\n  pipeline.del(`partner:${id}:commissions`);\n\n  await pipeline.exec();\n}\n\nexport async function getPartnerStats(partnerId: string): Promise<{\n  totalDeals: number;\n  wonDeals: number;\n  lostDeals: number;\n  pendingDeals: number;\n  totalRevenue: number;\n  credentialsCount: number;\n  activeCredentials: number;\n}> {\n  const [deals, credentials] = await Promise.all([\n    getPartnerDeals(partnerId),\n    getPartnerCredentials(partnerId),\n  ]);\n\n  const wonDeals = deals.filter(d => d.status === 'closed_won').length;\n  const lostDeals = deals.filter(d => d.status === 'closed_lost').length;\n  const pendingDeals = deals.filter(d => !['closed_won', 'closed_lost', 'rejected'].includes(d.status)).length;\n\n  return {\n    totalDeals: deals.length,\n    wonDeals,\n    lostDeals,\n    pendingDeals,\n    totalRevenue: 0, // Would need quote data to calculate\n    credentialsCount: credentials.length,\n    activeCredentials: credentials.filter(c => c.status === 'active').length,\n  };\n}\n\n// ============ User Operations ============\n\nexport async function getUser(id: string): Promise<User | null> {\n  const user = await redis.hgetall(keys.user(id)) as User | null;\n  if (!user || !user.id) return null;\n  return user;\n}\n\nexport async function getUserByEmail(email: string): Promise<User | null> {\n  const userId = await redis.get<string>(keys.userByEmail(email));\n  if (!userId) return null;\n  return getUser(userId);\n}\n\nexport async function createUser(user: User): Promise<void> {\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.user(user.id), toRedisHash(user));\n  pipeline.set(keys.userByEmail(user.email), user.id);\n  pipeline.sadd(keys.partnerUsers(user.partnerId), user.id);\n  await pipeline.exec();\n}\n\nexport async function updateUser(id: string, updates: Partial<User>): Promise<void> {\n  await redis.hset(keys.user(id), toRedisHash({ ...updates, updatedAt: new Date().toISOString() }));\n}\n\nexport async function getPartnerUsers(partnerId: string): Promise<User[]> {\n  const userIds = await redis.smembers<string[]>(keys.partnerUsers(partnerId));\n  if (!userIds.length) return [];\n  const users = await Promise.all(userIds.map((id) => getUser(id)));\n  return users.filter((u): u is User => u !== null);\n}\n\n// ============ Session Operations ============\n\nexport async function createSession(userId: string, partnerId: string): Promise<Session> {\n  const session: Session = {\n    id: generateId(),\n    userId,\n    partnerId,\n    expiresAt: new Date(Date.now() + TTL.session * 1000).toISOString(),\n    createdAt: new Date().toISOString(),\n  };\n  await redis.hset(keys.session(session.id), toRedisHash(session));\n  await redis.expire(keys.session(session.id), TTL.session);\n  return session;\n}\n\nexport async function getSession(id: string): Promise<Session | null> {\n  const session = await redis.hgetall(keys.session(id)) as Session | null;\n  if (!session || !session.id) return null;\n  if (new Date(session.expiresAt) < new Date()) {\n    await deleteSession(id);\n    return null;\n  }\n  return session;\n}\n\nexport async function deleteSession(id: string): Promise<void> {\n  await redis.del(keys.session(id));\n}\n\n// ============ Deal Operations ============\n\nexport async function getDeal(id: string): Promise<Deal | null> {\n  const deal = await redis.hgetall(keys.deal(id)) as Deal | null;\n  if (!deal || !deal.id) return null;\n  // Parse population as number if stored as string\n  if (typeof deal.population === 'string') {\n    deal.population = parseInt(deal.population, 10);\n  }\n  // Parse boolean if stored as string\n  if (typeof deal.partnerGeneratedLead === 'string') {\n    deal.partnerGeneratedLead = deal.partnerGeneratedLead === 'true';\n  }\n  return deal;\n}\n\nexport async function getPartnerDeals(partnerId: string, limit = 50): Promise<Deal[]> {\n  const dealIds = await redis.zrange<string[]>(keys.partnerDeals(partnerId), 0, limit - 1, {\n    rev: true,\n  });\n  if (!dealIds.length) return [];\n\n  const deals = await Promise.all(dealIds.map((id) => getDeal(id)));\n  return deals.filter((d): d is Deal => d !== null);\n}\n\nexport async function createDeal(deal: Deal): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  pipeline.hset(keys.deal(deal.id), toRedisHash(deal));\n\n  // Add to partner's deals sorted by creation time\n  pipeline.zadd(keys.partnerDeals(deal.partnerId), {\n    score: new Date(deal.createdAt).getTime(),\n    member: deal.id,\n  });\n\n  // Add to all deals index\n  pipeline.zadd(keys.allDeals(), {\n    score: new Date(deal.createdAt).getTime(),\n    member: deal.id,\n  });\n\n  // Add to status index\n  pipeline.sadd(keys.dealsByStatus(deal.status), deal.id);\n\n  await pipeline.exec();\n}\n\nexport async function updateDeal(id: string, updates: Partial<Deal>): Promise<void> {\n  const deal = await getDeal(id);\n  if (!deal) throw new Error('Deal not found');\n\n  const pipeline = redis.pipeline();\n\n  const updateData: Record<string, unknown> = { ...updates, updatedAt: new Date().toISOString() };\n\n  pipeline.hset(keys.deal(id), toRedisHash(updateData as Record<string, unknown>));\n\n  // Update status index if changed\n  if (updates.status && updates.status !== deal.status) {\n    pipeline.srem(keys.dealsByStatus(deal.status), id);\n    pipeline.sadd(keys.dealsByStatus(updates.status), id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function getDealsByStatus(status: DealStatus): Promise<Deal[]> {\n  const dealIds = await redis.smembers<string[]>(keys.dealsByStatus(status));\n  if (!dealIds.length) return [];\n  const deals = await Promise.all(dealIds.map((id) => getDeal(id)));\n  return deals.filter((d): d is Deal => d !== null);\n}\n\nexport async function getAllDeals(limit = 100): Promise<Deal[]> {\n  const dealIds = await redis.zrange<string[]>(keys.allDeals(), 0, limit - 1, {\n    rev: true,\n  });\n  if (!dealIds.length) return [];\n  const deals = await Promise.all(dealIds.map((id) => getDeal(id)));\n  return deals.filter((d): d is Deal => d !== null);\n}\n\n// Legacy function - kept for backward compatibility\nexport async function checkDomainConflict(domain: string, excludeDealId?: string): Promise<string[]> {\n  const existingDealIds = await redis.smembers<string[]>(keys.dealsByDomain(domain.toLowerCase()));\n  if (excludeDealId) {\n    return existingDealIds.filter((id) => id !== excludeDealId);\n  }\n  return existingDealIds;\n}\n\nexport async function getDealsByStage(stage: DealStage): Promise<Deal[]> {\n  const dealIds = await redis.smembers<string[]>(keys.dealsByStage(stage));\n  if (!dealIds.length) return [];\n  const deals = await Promise.all(dealIds.map((id) => getDeal(id)));\n  return deals.filter((d): d is Deal => d !== null);\n}\n\n// ============ Training Operations ============\n\nexport async function getTrainingModule(id: string): Promise<TrainingModule | null> {\n  const module = await redis.hgetall(keys.trainingModule(id)) as TrainingModule | null;\n  if (!module || !module.id) return null;\n  // Parse JSON fields\n  if (typeof module.title === 'string') module.title = JSON.parse(module.title);\n  if (typeof module.description === 'string') module.description = JSON.parse(module.description);\n  if (typeof module.content === 'string') module.content = JSON.parse(module.content);\n  if (typeof module.quiz === 'string') module.quiz = JSON.parse(module.quiz);\n  return module;\n}\n\nexport async function getAllTrainingModules(): Promise<TrainingModule[]> {\n  const moduleIds = await redis.smembers<string[]>(keys.trainingModules());\n  if (!moduleIds.length) return [];\n  const modules = await Promise.all(moduleIds.map((id) => getTrainingModule(id)));\n  return modules.filter((m): m is TrainingModule => m !== null).sort((a, b) => a.order - b.order);\n}\n\nexport async function createTrainingModule(module: TrainingModule): Promise<void> {\n  const moduleData = {\n    ...module,\n    title: JSON.stringify(module.title),\n    description: JSON.stringify(module.description),\n    content: JSON.stringify(module.content),\n    quiz: JSON.stringify(module.quiz),\n  };\n\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.trainingModule(module.id), toRedisHash(moduleData));\n  pipeline.sadd(keys.trainingModules(), module.id);\n  await pipeline.exec();\n}\n\nexport async function getUserTrainingProgress(userId: string): Promise<Record<string, TrainingProgress>> {\n  const progress = await redis.hgetall(keys.userTrainingProgress(userId)) as Record<string, string> | null;\n  if (!progress) return {};\n\n  const parsed: Record<string, TrainingProgress> = {};\n  for (const [moduleId, data] of Object.entries(progress)) {\n    parsed[moduleId] = typeof data === 'string' ? JSON.parse(data) : data;\n  }\n  return parsed;\n}\n\nexport async function updateTrainingProgress(userId: string, progress: TrainingProgress): Promise<void> {\n  await redis.hset(keys.userTrainingProgress(userId), {\n    [progress.moduleId]: JSON.stringify(progress),\n  });\n}\n\n// ============ Certification Operations ============\n\nexport async function getCertification(id: string): Promise<Certification | null> {\n  const cert = await redis.hgetall(keys.certification(id)) as Certification | null;\n  if (!cert || !cert.id) return null;\n  return cert;\n}\n\nexport async function getUserCertifications(userId: string): Promise<Certification[]> {\n  const certIds = await redis.smembers<string[]>(keys.userCertifications(userId));\n  if (!certIds.length) return [];\n  const certs = await Promise.all(certIds.map((id) => getCertification(id)));\n  return certs.filter((c): c is Certification => c !== null);\n}\n\nexport async function createCertification(cert: Certification): Promise<void> {\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.certification(cert.id), toRedisHash(cert));\n  pipeline.sadd(keys.userCertifications(cert.userId), cert.id);\n  pipeline.sadd(keys.partnerCertifications(cert.partnerId), cert.id);\n  await pipeline.exec();\n}\n\nexport async function hasValidCertification(userId: string): Promise<boolean> {\n  const certs = await getUserCertifications(userId);\n  return certs.some(\n    (cert) => cert.status === 'active' && new Date(cert.expiresAt) > new Date()\n  );\n}\n\n// ============ Legal Operations (Legacy) ============\n\nexport async function getLegalDocument(id: string): Promise<LegacyLegalDocument | null> {\n  const doc = await redis.hgetall(keys.legalDocument(id)) as LegacyLegalDocument | null;\n  if (!doc || !doc.id) return null;\n  if (typeof doc.title === 'string') doc.title = JSON.parse(doc.title);\n  if (typeof doc.content === 'string') doc.content = JSON.parse(doc.content);\n  return doc;\n}\n\nexport async function getAllLegalDocuments(): Promise<LegacyLegalDocument[]> {\n  const docIds = await redis.smembers<string[]>(keys.legalDocuments());\n  if (!docIds.length) return [];\n  const docs = await Promise.all(docIds.map((id) => getLegalDocument(id)));\n  return docs.filter((d): d is LegacyLegalDocument => d !== null);\n}\n\nexport async function createLegalDocument(doc: LegacyLegalDocument): Promise<void> {\n  const docData = {\n    ...doc,\n    title: JSON.stringify(doc.title),\n    content: JSON.stringify(doc.content),\n  };\n\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.legalDocument(doc.id), toRedisHash(docData));\n  pipeline.sadd(keys.legalDocuments(), doc.id);\n  await pipeline.exec();\n}\n\nexport async function signLegalDocument(signature: LegalSignature): Promise<void> {\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.legalSignature(signature.id), toRedisHash(signature));\n  pipeline.sadd(keys.userSignatures(signature.userId), signature.id);\n  pipeline.sadd(keys.partnerSignatures(signature.partnerId), signature.id);\n  await pipeline.exec();\n}\n\nexport async function getUserSignatures(userId: string): Promise<LegalSignature[]> {\n  const sigIds = await redis.smembers<string[]>(keys.userSignatures(userId));\n  if (!sigIds.length) return [];\n  const sigs = await Promise.all(\n    sigIds.map((id) => redis.hgetall(keys.legalSignature(id)) as Promise<LegalSignature | null>)\n  );\n  return sigs.filter((s): s is LegalSignature => s !== null && !!s.id);\n}\n\nexport async function hasSignedRequiredDocs(userId: string): Promise<boolean> {\n  const [docs, signatures] = await Promise.all([\n    getAllLegalDocuments(),\n    getUserSignatures(userId),\n  ]);\n\n  const requiredDocs = docs.filter((d) => d.requiredForDeals);\n  const signedDocIds = new Set(signatures.map((s) => s.documentId));\n\n  return requiredDocs.every((doc) => signedDocIds.has(doc.id));\n}\n\n// ============ Copilot Operations ============\n\nexport async function createCopilotSession(dealId: string, userId: string): Promise<CopilotSession> {\n  const session: CopilotSession = {\n    id: generateId(),\n    dealId,\n    userId,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n  };\n\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.copilotSession(session.id), toRedisHash(session));\n  pipeline.expire(keys.copilotSession(session.id), TTL.copilotSession);\n  pipeline.sadd(keys.dealCopilotSessions(dealId), session.id);\n  await pipeline.exec();\n\n  return session;\n}\n\nexport async function getCopilotSession(id: string): Promise<CopilotSession | null> {\n  const session = await redis.hgetall(keys.copilotSession(id)) as CopilotSession | null;\n  if (!session || !session.id) return null;\n  return session;\n}\n\nexport async function addCopilotMessage(sessionId: string, message: CopilotMessage): Promise<void> {\n  await redis.rpush(keys.copilotMessages(sessionId), JSON.stringify(message));\n}\n\nexport async function getCopilotMessages(sessionId: string): Promise<CopilotMessage[]> {\n  const messages = await redis.lrange<string>(keys.copilotMessages(sessionId), 0, -1);\n  return messages.map((m) => (typeof m === 'string' ? JSON.parse(m) : m));\n}\n\nexport async function updateCopilotMeddic(sessionId: string, scores: Partial<MEDDICScores>): Promise<void> {\n  await redis.hset(keys.copilotMeddic(sessionId), toRedisHash(scores as Record<string, number>));\n}\n\nexport async function getCopilotMeddic(sessionId: string): Promise<Partial<MEDDICScores>> {\n  return (await redis.hgetall(keys.copilotMeddic(sessionId))) as Partial<MEDDICScores> || {};\n}\n\n// ============ Commission Operations ============\n\nexport async function getCommission(id: string): Promise<Commission | null> {\n  const commission = await redis.hgetall(keys.commission(id)) as Commission | null;\n  if (!commission || !commission.id) return null;\n  return commission;\n}\n\nexport async function getPartnerCommissions(partnerId: string): Promise<Commission[]> {\n  const commIds = await redis.smembers<string[]>(keys.partnerCommissions(partnerId));\n  if (!commIds.length) return [];\n  const comms = await Promise.all(commIds.map((id) => getCommission(id)));\n  return comms.filter((c): c is Commission => c !== null);\n}\n\nexport async function createCommission(commission: Commission): Promise<void> {\n  const pipeline = redis.pipeline();\n  pipeline.hset(keys.commission(commission.id), toRedisHash(commission));\n  pipeline.sadd(keys.partnerCommissions(commission.partnerId), commission.id);\n  pipeline.set(keys.dealCommission(commission.dealId), commission.id);\n  await pipeline.exec();\n}\n\nexport async function updateCommission(id: string, updates: Partial<Commission>): Promise<void> {\n  await redis.hset(keys.commission(id), toRedisHash(updates as Record<string, unknown>));\n}\n\n// ============ Quote Operations ============\n\nexport async function getQuote(id: string): Promise<Quote | null> {\n  const quote = await redis.hgetall(keys.quote(id)) as Quote | null;\n  if (!quote || !quote.id) return null;\n  // Parse JSON fields\n  if (typeof quote.products === 'string') quote.products = JSON.parse(quote.products);\n  if (typeof quote.services === 'string') quote.services = JSON.parse(quote.services);\n  if (typeof quote.discounts === 'string') quote.discounts = JSON.parse(quote.discounts);\n  // Parse numbers\n  if (typeof quote.version === 'string') quote.version = parseInt(quote.version, 10);\n  if (typeof quote.subtotal === 'string') quote.subtotal = parseFloat(quote.subtotal);\n  if (typeof quote.totalDiscount === 'string') quote.totalDiscount = parseFloat(quote.totalDiscount);\n  if (typeof quote.total === 'string') quote.total = parseFloat(quote.total);\n  return quote;\n}\n\nexport async function getDealQuotes(dealId: string): Promise<Quote[]> {\n  const quoteIds = await redis.zrange<string[]>(keys.dealQuotes(dealId), 0, -1, {\n    rev: true,\n  });\n  if (!quoteIds.length) return [];\n  const quotes = await Promise.all(quoteIds.map((id) => getQuote(id)));\n  return quotes.filter((q): q is Quote => q !== null);\n}\n\nexport async function getPartnerQuotes(partnerId: string, limit = 50): Promise<Quote[]> {\n  const quoteIds = await redis.zrange<string[]>(keys.partnerQuotes(partnerId), 0, limit - 1, {\n    rev: true,\n  });\n  if (!quoteIds.length) return [];\n  const quotes = await Promise.all(quoteIds.map((id) => getQuote(id)));\n  return quotes.filter((q): q is Quote => q !== null);\n}\n\nexport async function createQuote(quote: Quote): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  const quoteData = {\n    ...quote,\n    products: JSON.stringify(quote.products),\n    services: JSON.stringify(quote.services),\n    discounts: JSON.stringify(quote.discounts),\n  };\n\n  pipeline.hset(keys.quote(quote.id), toRedisHash(quoteData));\n\n  // Add to deal's quotes sorted by version\n  pipeline.zadd(keys.dealQuotes(quote.dealId), {\n    score: quote.version,\n    member: quote.id,\n  });\n\n  // Add to partner's quotes sorted by creation time\n  pipeline.zadd(keys.partnerQuotes(quote.partnerId), {\n    score: new Date(quote.createdAt).getTime(),\n    member: quote.id,\n  });\n\n  await pipeline.exec();\n}\n\nexport async function updateQuote(id: string, updates: Partial<Quote>): Promise<void> {\n  const updateData: Record<string, unknown> = { ...updates, updatedAt: new Date().toISOString() };\n\n  // Serialize nested objects\n  if (updates.products) updateData.products = JSON.stringify(updates.products);\n  if (updates.services) updateData.services = JSON.stringify(updates.services);\n  if (updates.discounts) updateData.discounts = JSON.stringify(updates.discounts);\n\n  await redis.hset(keys.quote(id), toRedisHash(updateData as Record<string, unknown>));\n}\n\nexport async function getNextQuoteVersion(dealId: string): Promise<number> {\n  const quotes = await getDealQuotes(dealId);\n  if (!quotes.length) return 1;\n  return Math.max(...quotes.map(q => q.version)) + 1;\n}\n\n// ============ Pricing Config Operations ============\n\nconst DEFAULT_PRICING_CONFIG: PricingConfig = {\n  sovraGov: {\n    tiers: [\n      { maxPopulation: 100000, pricePerInhabitant: 0.50 },\n      { maxPopulation: 250000, pricePerInhabitant: 0.40 },\n      { maxPopulation: 500000, pricePerInhabitant: 0.32 },\n      { maxPopulation: 1000000, pricePerInhabitant: 0.26 },\n      { maxPopulation: 2500000, pricePerInhabitant: 0.20 },\n      { maxPopulation: 5000000, pricePerInhabitant: 0.16 },\n      { maxPopulation: 10000000, pricePerInhabitant: 0.13 },\n    ],\n  },\n  sovraId: {\n    essentials: { monthlyLimit: 10000, monthlyPrice: 1000 },\n    professional: { monthlyLimit: 30000, monthlyPrice: 2000 },\n    enterprise: { monthlyLimit: 50000, monthlyPrice: 3000 },\n  },\n  services: {\n    walletImplementation: 5000,\n    integrationHourlyRate: 150,\n  },\n  discounts: {\n    bronze: { base: 5, leadBonus: 0 },\n    silver: { base: 20, leadBonus: 10 },\n    gold: { base: 25, leadBonus: 15 },\n    platinum: { base: 30, leadBonus: 20 },\n  },\n};\n\nexport async function getPricingConfig(): Promise<PricingConfig> {\n  const config = await redis.get<string>(keys.pricingConfig());\n  if (!config) {\n    // Initialize with default config\n    await savePricingConfig(DEFAULT_PRICING_CONFIG);\n    return DEFAULT_PRICING_CONFIG;\n  }\n  return typeof config === 'string' ? JSON.parse(config) : config;\n}\n\nexport async function savePricingConfig(config: PricingConfig): Promise<void> {\n  await redis.set(keys.pricingConfig(), JSON.stringify(config));\n}\n\nexport async function updatePricingConfig(updates: Partial<PricingConfig>): Promise<PricingConfig> {\n  const current = await getPricingConfig();\n  const updated = { ...current, ...updates };\n  await savePricingConfig(updated);\n  return updated;\n}\n\nexport { DEFAULT_PRICING_CONFIG };\n\n// ============ Enhanced Legal Document Operations (V2) ============\n\nexport async function getLegalDocumentV2(id: string): Promise<LegalDocument | null> {\n  const doc = await redis.hgetall(keys.legalDocumentV2(id)) as LegalDocument | null;\n  if (!doc || !doc.id) return null;\n  // Parse JSON fields (handle empty strings)\n  if (typeof doc.docusignMetadata === 'string' && doc.docusignMetadata) {\n    doc.docusignMetadata = JSON.parse(doc.docusignMetadata);\n  } else {\n    doc.docusignMetadata = undefined;\n  }\n  if (typeof doc.uploadMetadata === 'string' && doc.uploadMetadata) {\n    doc.uploadMetadata = JSON.parse(doc.uploadMetadata);\n  } else {\n    doc.uploadMetadata = undefined;\n  }\n  // Parse numbers\n  if (typeof doc.version === 'string') doc.version = parseInt(doc.version, 10);\n  return doc;\n}\n\nexport async function getPartnerLegalDocuments(partnerId: string, limit = 100): Promise<LegalDocument[]> {\n  console.log('[Redis] Fetching documents for partner:', partnerId, 'key:', keys.partnerLegalDocuments(partnerId));\n  const docIds = await redis.zrange<string[]>(keys.partnerLegalDocuments(partnerId), 0, limit - 1, {\n    rev: true,\n  });\n  console.log('[Redis] Found document IDs:', docIds.length, docIds);\n  if (!docIds.length) return [];\n  const docs = await Promise.all(docIds.map((id) => getLegalDocumentV2(id)));\n  return docs.filter((d): d is LegalDocument => d !== null);\n}\n\nexport async function getAllLegalDocumentsV2(limit = 100): Promise<LegalDocument[]> {\n  const docIds = await redis.zrange<string[]>(keys.allLegalDocumentsV2(), 0, limit - 1, {\n    rev: true,\n  });\n  if (!docIds.length) return [];\n  const docs = await Promise.all(docIds.map((id) => getLegalDocumentV2(id)));\n  return docs.filter((d): d is LegalDocument => d !== null);\n}\n\nexport async function getLegalDocumentsByCategory(category: DocumentCategory, limit = 100): Promise<LegalDocument[]> {\n  const docIds = await redis.smembers<string[]>(keys.legalDocumentsByCategory(category));\n  if (!docIds.length) return [];\n  const docs = await Promise.all(docIds.map((id) => getLegalDocumentV2(id)));\n  return docs.filter((d): d is LegalDocument => d !== null).slice(0, limit);\n}\n\nexport async function getLegalDocumentsByStatus(status: DocumentStatus, limit = 100): Promise<LegalDocument[]> {\n  const docIds = await redis.smembers<string[]>(keys.legalDocumentsByStatus(status));\n  if (!docIds.length) return [];\n  const docs = await Promise.all(docIds.map((id) => getLegalDocumentV2(id)));\n  return docs.filter((d): d is LegalDocument => d !== null).slice(0, limit);\n}\n\nexport async function createLegalDocumentV2(doc: LegalDocument): Promise<void> {\n  console.log('[Redis] Creating legal document:', doc.id, 'for partner:', doc.partnerId);\n\n  const pipeline = redis.pipeline();\n\n  const docData = {\n    ...doc,\n    docusignMetadata: doc.docusignMetadata ? JSON.stringify(doc.docusignMetadata) : '',\n    uploadMetadata: doc.uploadMetadata ? JSON.stringify(doc.uploadMetadata) : '',\n  };\n\n  pipeline.hset(keys.legalDocumentV2(doc.id), toRedisHash(docData));\n\n  // Add to partner's documents sorted by creation time\n  pipeline.zadd(keys.partnerLegalDocuments(doc.partnerId), {\n    score: new Date(doc.createdAt).getTime(),\n    member: doc.id,\n  });\n\n  // Add to all documents index\n  pipeline.zadd(keys.allLegalDocumentsV2(), {\n    score: new Date(doc.createdAt).getTime(),\n    member: doc.id,\n  });\n\n  // Add to category index\n  pipeline.sadd(keys.legalDocumentsByCategory(doc.category), doc.id);\n\n  // Add to status index\n  pipeline.sadd(keys.legalDocumentsByStatus(doc.status), doc.id);\n\n  // If DocuSign document, create envelope mapping\n  if (doc.type === 'docusign' && doc.docusignMetadata?.envelopeId) {\n    pipeline.set(keys.docusignEnvelope(doc.docusignMetadata.envelopeId), doc.id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function updateLegalDocumentV2(id: string, updates: Partial<LegalDocument>): Promise<void> {\n  const doc = await getLegalDocumentV2(id);\n  if (!doc) throw new Error('Document not found');\n\n  const pipeline = redis.pipeline();\n\n  const updateData: Record<string, unknown> = { ...updates, updatedAt: new Date().toISOString() };\n\n  // Serialize nested objects\n  if (updates.docusignMetadata) updateData.docusignMetadata = JSON.stringify(updates.docusignMetadata);\n  if (updates.uploadMetadata) updateData.uploadMetadata = JSON.stringify(updates.uploadMetadata);\n\n  pipeline.hset(keys.legalDocumentV2(id), toRedisHash(updateData as Record<string, unknown>));\n\n  // Update status index if changed\n  if (updates.status && updates.status !== doc.status) {\n    pipeline.srem(keys.legalDocumentsByStatus(doc.status), id);\n    pipeline.sadd(keys.legalDocumentsByStatus(updates.status), id);\n  }\n\n  // Update category index if changed\n  if (updates.category && updates.category !== doc.category) {\n    pipeline.srem(keys.legalDocumentsByCategory(doc.category), id);\n    pipeline.sadd(keys.legalDocumentsByCategory(updates.category), id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function getLegalDocumentByEnvelopeId(envelopeId: string): Promise<LegalDocument | null> {\n  const docId = await redis.get<string>(keys.docusignEnvelope(envelopeId));\n  if (!docId) return null;\n  return getLegalDocumentV2(docId);\n}\n\n// ============ Document Audit Operations ============\n\nexport async function createDocumentAuditEvent(event: DocumentAuditEvent): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  pipeline.hset(keys.documentAuditEvent(event.id), toRedisHash(event));\n  pipeline.zadd(keys.documentAuditEvents(event.documentId), {\n    score: new Date(event.timestamp).getTime(),\n    member: event.id,\n  });\n\n  await pipeline.exec();\n}\n\nexport async function getDocumentAuditEvents(documentId: string, limit = 50): Promise<DocumentAuditEvent[]> {\n  const eventIds = await redis.zrange<string[]>(keys.documentAuditEvents(documentId), 0, limit - 1, {\n    rev: true,\n  });\n  if (!eventIds.length) return [];\n\n  const events = await Promise.all(\n    eventIds.map(async (id) => {\n      const event = await redis.hgetall(keys.documentAuditEvent(id)) as DocumentAuditEvent | null;\n      if (!event || !event.id) return null;\n      if (typeof event.details === 'string') event.details = JSON.parse(event.details);\n      return event;\n    })\n  );\n\n  return events.filter((e): e is DocumentAuditEvent => e !== null);\n}\n\nexport async function addDocumentAuditLog(\n  documentId: string,\n  action: DocumentAuditEvent['action'],\n  actor: { type: 'partner' | 'sovra' | 'system'; id?: string; name?: string },\n  details?: Record<string, unknown>,\n  request?: { ipAddress?: string; userAgent?: string }\n): Promise<void> {\n  const event: DocumentAuditEvent = {\n    id: generateId(),\n    documentId,\n    action,\n    actorType: actor.type,\n    actorId: actor.id,\n    actorName: actor.name,\n    details,\n    ipAddress: request?.ipAddress,\n    userAgent: request?.userAgent,\n    timestamp: new Date().toISOString(),\n  };\n\n  await createDocumentAuditEvent(event);\n}\n\n// ============ Partner Pending Documents ============\n\nexport async function getPartnerPendingDocuments(partnerId: string): Promise<LegalDocument[]> {\n  const docs = await getPartnerLegalDocuments(partnerId);\n  return docs.filter(\n    (doc) =>\n      doc.status === 'pending_signature' ||\n      (doc.type === 'upload' &&\n        doc.uploadMetadata?.verificationStatus === 'pending' &&\n        doc.uploadMetadata?.uploadedBy === 'partner')\n  );\n}\n\nexport async function getPartnerDocumentsRequiringAction(partnerId: string): Promise<{\n  pendingSignature: LegalDocument[];\n  expiringSOon: LegalDocument[];\n}> {\n  const docs = await getPartnerLegalDocuments(partnerId);\n  const now = new Date();\n  const thirtyDaysFromNow = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000);\n\n  const pendingSignature = docs.filter(\n    (doc) => doc.status === 'pending_signature' || doc.status === 'partially_signed'\n  );\n\n  const expiringSOon = docs.filter((doc) => {\n    if (!doc.expirationDate || doc.status !== 'active') return false;\n    const expDate = new Date(doc.expirationDate);\n    return expDate > now && expDate <= thirtyDaysFromNow;\n  });\n\n  return { pendingSignature, expiringSOon };\n}\n\n// ============ Partner Credentials (SovraID) Operations ============\n\nexport async function getPartnerCredential(id: string): Promise<PartnerCredential | null> {\n  const credential = await redis.hgetall(keys.partnerCredential(id)) as PartnerCredential | null;\n  if (!credential || !credential.id) return null;\n  return credential;\n}\n\nexport async function getPartnerCredentials(partnerId: string, limit = 100): Promise<PartnerCredential[]> {\n  const credentialIds = await redis.zrange<string[]>(keys.partnerCredentials(partnerId), 0, limit - 1, {\n    rev: true,\n  });\n  if (!credentialIds.length) return [];\n  const credentials = await Promise.all(credentialIds.map((id) => getPartnerCredential(id)));\n  return credentials.filter((c): c is PartnerCredential => c !== null);\n}\n\nexport async function getCredentialsByStatus(status: CredentialStatus): Promise<PartnerCredential[]> {\n  const credentialIds = await redis.smembers<string[]>(keys.credentialsByStatus(status));\n  if (!credentialIds.length) return [];\n  const credentials = await Promise.all(credentialIds.map((id) => getPartnerCredential(id)));\n  return credentials.filter((c): c is PartnerCredential => c !== null);\n}\n\nexport async function getCredentialByEmail(email: string): Promise<PartnerCredential | null> {\n  const credentialId = await redis.get<string>(keys.credentialByEmail(email));\n  if (!credentialId) return null;\n  return getPartnerCredential(credentialId);\n}\n\nexport async function createPartnerCredential(credential: PartnerCredential): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  pipeline.hset(keys.partnerCredential(credential.id), toRedisHash(credential));\n\n  // Add to partner's credentials sorted by creation time\n  pipeline.zadd(keys.partnerCredentials(credential.partnerId), {\n    score: new Date(credential.createdAt).getTime(),\n    member: credential.id,\n  });\n\n  // Add to all credentials index\n  pipeline.zadd(keys.allCredentials(), {\n    score: new Date(credential.createdAt).getTime(),\n    member: credential.id,\n  });\n\n  // Add to status index\n  pipeline.sadd(keys.credentialsByStatus(credential.status), credential.id);\n\n  // Add email index\n  pipeline.set(keys.credentialByEmail(credential.holderEmail), credential.id);\n\n  await pipeline.exec();\n}\n\nexport async function updatePartnerCredential(id: string, updates: Partial<PartnerCredential>): Promise<void> {\n  const credential = await getPartnerCredential(id);\n  if (!credential) throw new Error('Credential not found');\n\n  const pipeline = redis.pipeline();\n\n  const updateData = { ...updates, updatedAt: new Date().toISOString() };\n  pipeline.hset(keys.partnerCredential(id), toRedisHash(updateData as Record<string, unknown>));\n\n  // Update status index if changed\n  if (updates.status && updates.status !== credential.status) {\n    pipeline.srem(keys.credentialsByStatus(credential.status), id);\n    pipeline.sadd(keys.credentialsByStatus(updates.status), id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function revokePartnerCredential(\n  id: string,\n  revokedBy: string,\n  reason: string\n): Promise<void> {\n  await updatePartnerCredential(id, {\n    status: 'revoked',\n    revokedAt: new Date().toISOString(),\n    revokedBy,\n    revokedReason: reason,\n  });\n}\n\nexport async function revokeAllPartnerCredentials(\n  partnerId: string,\n  revokedBy: string,\n  reason: string\n): Promise<void> {\n  const credentials = await getPartnerCredentials(partnerId);\n  const activeCredentials = credentials.filter(c => ['active', 'claimed', 'issued'].includes(c.status));\n\n  for (const credential of activeCredentials) {\n    await revokePartnerCredential(credential.id, revokedBy, reason);\n  }\n}\n\n// ============ Training Courses (Admin) Operations ============\n\nexport async function getTrainingCourse(id: string): Promise<TrainingCourse | null> {\n  const course = await redis.hgetall(keys.trainingCourse(id)) as TrainingCourse | null;\n  if (!course || !course.id) return null;\n  // Parse JSON fields\n  if (typeof course.title === 'string') course.title = JSON.parse(course.title);\n  if (typeof course.description === 'string') course.description = JSON.parse(course.description);\n  if (typeof course.modules === 'string') course.modules = JSON.parse(course.modules);\n  if (typeof course.requiredForTiers === 'string' && course.requiredForTiers) {\n    course.requiredForTiers = JSON.parse(course.requiredForTiers as unknown as string);\n  }\n  // Parse booleans\n  if (typeof course.isPublished === 'string') course.isPublished = course.isPublished === 'true';\n  if (typeof course.isRequired === 'string') course.isRequired = course.isRequired === 'true';\n  if (typeof course.certificateEnabled === 'string') course.certificateEnabled = course.certificateEnabled === 'true';\n  // Parse numbers\n  if (typeof course.duration === 'string') course.duration = parseInt(course.duration, 10);\n  if (typeof course.passingScore === 'string') course.passingScore = parseInt(course.passingScore, 10);\n  if (typeof course.order === 'string') course.order = parseInt(course.order, 10);\n  return course;\n}\n\nexport async function getAllTrainingCourses(): Promise<TrainingCourse[]> {\n  const courseIds = await redis.zrange<string[]>(keys.allTrainingCourses(), 0, -1, { rev: true });\n  if (!courseIds.length) return [];\n  const courses = await Promise.all(courseIds.map((id) => getTrainingCourse(id)));\n  return courses.filter((c): c is TrainingCourse => c !== null).sort((a, b) => a.order - b.order);\n}\n\nexport async function getPublishedTrainingCourses(): Promise<TrainingCourse[]> {\n  const courseIds = await redis.smembers<string[]>(keys.publishedTrainingCourses());\n  if (!courseIds.length) return [];\n  const courses = await Promise.all(courseIds.map((id) => getTrainingCourse(id)));\n  return courses.filter((c): c is TrainingCourse => c !== null).sort((a, b) => a.order - b.order);\n}\n\nexport async function getTrainingCoursesByCategory(category: string): Promise<TrainingCourse[]> {\n  const courseIds = await redis.smembers<string[]>(keys.trainingCoursesByCategory(category));\n  if (!courseIds.length) return [];\n  const courses = await Promise.all(courseIds.map((id) => getTrainingCourse(id)));\n  return courses.filter((c): c is TrainingCourse => c !== null).sort((a, b) => a.order - b.order);\n}\n\nexport async function createTrainingCourse(course: TrainingCourse): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  const courseData = {\n    ...course,\n    title: JSON.stringify(course.title),\n    description: JSON.stringify(course.description),\n    modules: JSON.stringify(course.modules),\n    requiredForTiers: course.requiredForTiers ? JSON.stringify(course.requiredForTiers) : '',\n  };\n\n  pipeline.hset(keys.trainingCourse(course.id), toRedisHash(courseData));\n\n  // Add to all courses sorted by order\n  pipeline.zadd(keys.allTrainingCourses(), {\n    score: course.order,\n    member: course.id,\n  });\n\n  // Add to category index\n  pipeline.sadd(keys.trainingCoursesByCategory(course.category), course.id);\n\n  // Add to published index if published\n  if (course.isPublished) {\n    pipeline.sadd(keys.publishedTrainingCourses(), course.id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function updateTrainingCourse(id: string, updates: Partial<TrainingCourse>): Promise<void> {\n  const course = await getTrainingCourse(id);\n  if (!course) throw new Error('Course not found');\n\n  const pipeline = redis.pipeline();\n\n  const updateData: Record<string, unknown> = { ...updates, updatedAt: new Date().toISOString() };\n  if (updates.title) updateData.title = JSON.stringify(updates.title);\n  if (updates.description) updateData.description = JSON.stringify(updates.description);\n  if (updates.modules) updateData.modules = JSON.stringify(updates.modules);\n  if (updates.requiredForTiers) updateData.requiredForTiers = JSON.stringify(updates.requiredForTiers);\n\n  pipeline.hset(keys.trainingCourse(id), toRedisHash(updateData as Record<string, unknown>));\n\n  // Update category index if changed\n  if (updates.category && updates.category !== course.category) {\n    pipeline.srem(keys.trainingCoursesByCategory(course.category), id);\n    pipeline.sadd(keys.trainingCoursesByCategory(updates.category), id);\n  }\n\n  // Update published index if changed\n  if (updates.isPublished !== undefined && updates.isPublished !== course.isPublished) {\n    if (updates.isPublished) {\n      pipeline.sadd(keys.publishedTrainingCourses(), id);\n    } else {\n      pipeline.srem(keys.publishedTrainingCourses(), id);\n    }\n  }\n\n  // Update order in sorted set if changed\n  if (updates.order !== undefined && updates.order !== course.order) {\n    pipeline.zadd(keys.allTrainingCourses(), {\n      score: updates.order,\n      member: id,\n    });\n  }\n\n  await pipeline.exec();\n}\n\nexport async function deleteTrainingCourse(id: string): Promise<void> {\n  const course = await getTrainingCourse(id);\n  if (!course) throw new Error('Course not found');\n\n  const pipeline = redis.pipeline();\n\n  pipeline.del(keys.trainingCourse(id));\n  pipeline.zrem(keys.allTrainingCourses(), id);\n  pipeline.srem(keys.trainingCoursesByCategory(course.category), id);\n  if (course.isPublished) {\n    pipeline.srem(keys.publishedTrainingCourses(), id);\n  }\n\n  await pipeline.exec();\n}\n\nexport async function publishTrainingCourse(id: string): Promise<void> {\n  await updateTrainingCourse(id, { isPublished: true });\n}\n\nexport async function unpublishTrainingCourse(id: string): Promise<void> {\n  await updateTrainingCourse(id, { isPublished: false });\n}\n\n// ============ Audit Log Operations ============\n\nexport async function createAuditLog(log: AuditLog): Promise<void> {\n  const pipeline = redis.pipeline();\n\n  const logData = {\n    ...log,\n    changes: log.changes ? JSON.stringify(log.changes) : '',\n    metadata: log.metadata ? JSON.stringify(log.metadata) : '',\n  };\n\n  pipeline.hset(keys.auditLog(log.id), toRedisHash(logData));\n\n  // Add to all logs sorted by timestamp\n  pipeline.zadd(keys.allAuditLogs(), {\n    score: new Date(log.timestamp).getTime(),\n    member: log.id,\n  });\n\n  // Add to entity index\n  pipeline.zadd(keys.auditLogsByEntity(log.entityType, log.entityId), {\n    score: new Date(log.timestamp).getTime(),\n    member: log.id,\n  });\n\n  // Add to action index\n  pipeline.sadd(keys.auditLogsByAction(log.action), log.id);\n\n  // Add to actor index\n  if (log.actorId) {\n    pipeline.zadd(keys.auditLogsByActor(log.actorId), {\n      score: new Date(log.timestamp).getTime(),\n      member: log.id,\n    });\n  }\n\n  await pipeline.exec();\n}\n\nexport async function getAuditLog(id: string): Promise<AuditLog | null> {\n  const log = await redis.hgetall(keys.auditLog(id)) as AuditLog | null;\n  if (!log || !log.id) return null;\n  // Parse JSON fields\n  if (typeof log.changes === 'string' && log.changes) log.changes = JSON.parse(log.changes);\n  if (typeof log.metadata === 'string' && log.metadata) log.metadata = JSON.parse(log.metadata);\n  return log;\n}\n\nexport async function getAllAuditLogs(limit = 100, offset = 0): Promise<AuditLog[]> {\n  const logIds = await redis.zrange<string[]>(keys.allAuditLogs(), offset, offset + limit - 1, {\n    rev: true,\n  });\n  if (!logIds.length) return [];\n  const logs = await Promise.all(logIds.map((id) => getAuditLog(id)));\n  return logs.filter((l): l is AuditLog => l !== null);\n}\n\nexport async function getAuditLogsByEntity(\n  entityType: string,\n  entityId: string,\n  limit = 50\n): Promise<AuditLog[]> {\n  const logIds = await redis.zrange<string[]>(\n    keys.auditLogsByEntity(entityType, entityId),\n    0,\n    limit - 1,\n    { rev: true }\n  );\n  if (!logIds.length) return [];\n  const logs = await Promise.all(logIds.map((id) => getAuditLog(id)));\n  return logs.filter((l): l is AuditLog => l !== null);\n}\n\nexport async function getAuditLogsByAction(action: AuditAction, limit = 50): Promise<AuditLog[]> {\n  const logIds = await redis.smembers<string[]>(keys.auditLogsByAction(action));\n  if (!logIds.length) return [];\n  const logs = await Promise.all(logIds.map((id) => getAuditLog(id)));\n  return logs\n    .filter((l): l is AuditLog => l !== null)\n    .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime())\n    .slice(0, limit);\n}\n\nexport async function getAuditLogsByActor(actorId: string, limit = 50): Promise<AuditLog[]> {\n  const logIds = await redis.zrange<string[]>(keys.auditLogsByActor(actorId), 0, limit - 1, {\n    rev: true,\n  });\n  if (!logIds.length) return [];\n  const logs = await Promise.all(logIds.map((id) => getAuditLog(id)));\n  return logs.filter((l): l is AuditLog => l !== null);\n}\n\n// Helper to add audit log\nexport async function addAuditLog(\n  action: AuditAction,\n  entityType: AuditLog['entityType'],\n  entityId: string,\n  actor: { id: string; name: string; type: AuditLog['actorType'] },\n  options?: {\n    entityName?: string;\n    changes?: AuditLog['changes'];\n    metadata?: AuditLog['metadata'];\n    ipAddress?: string;\n    userAgent?: string;\n  }\n): Promise<void> {\n  const log: AuditLog = {\n    id: generateId(),\n    actorId: actor.id,\n    actorName: actor.name,\n    actorType: actor.type,\n    action,\n    entityType,\n    entityId,\n    entityName: options?.entityName,\n    changes: options?.changes,\n    metadata: options?.metadata,\n    timestamp: new Date().toISOString(),\n    ipAddress: options?.ipAddress,\n    userAgent: options?.userAgent,\n  };\n\n  await createAuditLog(log);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1520, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/redis/index.ts"],"sourcesContent":["export { redis } from './client';\nexport { keys, TTL } from './keys';\nexport * from './operations';\n"],"names":[],"mappings":";AAAA;AACA;AACA"}},
    {"offset": {"line": 1531, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/auth/session.ts"],"sourcesContent":["import { cookies } from 'next/headers';\nimport bcrypt from 'bcryptjs';\nimport { createSession, getSession, deleteSession, getUserByEmail, getUser, getPartner } from '@/lib/redis';\nimport type { User, Partner, Session } from '@/types';\n\nconst SESSION_COOKIE = 'partner_session';\n\nexport interface SessionData {\n  session: Session;\n  user: User;\n  partner: Partner;\n}\n\nexport async function login(email: string, password: string): Promise<SessionData | null> {\n  const user = await getUserByEmail(email);\n  if (!user) return null;\n\n  const isValid = await bcrypt.compare(password, user.passwordHash);\n  if (!isValid) return null;\n\n  const partner = await getPartner(user.partnerId);\n  if (!partner) return null;\n\n  const session = await createSession(user.id, user.partnerId);\n\n  const cookieStore = await cookies();\n  cookieStore.set(SESSION_COOKIE, session.id, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    maxAge: 24 * 60 * 60, // 24 hours\n    path: '/',\n  });\n\n  return { session, user, partner };\n}\n\nexport async function logout(): Promise<void> {\n  const cookieStore = await cookies();\n  const sessionId = cookieStore.get(SESSION_COOKIE)?.value;\n\n  if (sessionId) {\n    await deleteSession(sessionId);\n  }\n\n  cookieStore.delete(SESSION_COOKIE);\n}\n\nexport async function getCurrentSession(): Promise<SessionData | null> {\n  const cookieStore = await cookies();\n  const sessionId = cookieStore.get(SESSION_COOKIE)?.value;\n\n  if (!sessionId) return null;\n\n  const session = await getSession(sessionId);\n  if (!session) return null;\n\n  const [user, partner] = await Promise.all([\n    getUser(session.userId),\n    getPartner(session.partnerId),\n  ]);\n\n  if (!user || !partner) {\n    await deleteSession(sessionId);\n    return null;\n  }\n\n  return { session, user, partner };\n}\n\nexport async function requireSession(): Promise<SessionData> {\n  const sessionData = await getCurrentSession();\n  if (!sessionData) {\n    throw new Error('Unauthorized');\n  }\n  return sessionData;\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 12);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AAAA;;;;AAGA,MAAM,iBAAiB;AAQhB,eAAe,MAAM,KAAa,EAAE,QAAgB;IACzD,MAAM,OAAO,MAAM,IAAA,0LAAc,EAAC;IAClC,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,UAAU,MAAM,mMAAM,CAAC,OAAO,CAAC,UAAU,KAAK,YAAY;IAChE,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,UAAU,MAAM,IAAA,sLAAU,EAAC,KAAK,SAAS;IAC/C,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,UAAU,MAAM,IAAA,yLAAa,EAAC,KAAK,EAAE,EAAE,KAAK,SAAS;IAE3D,MAAM,cAAc,MAAM,IAAA,6SAAO;IACjC,YAAY,GAAG,CAAC,gBAAgB,QAAQ,EAAE,EAAE;QAC1C,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK;QAClB,MAAM;IACR;IAEA,OAAO;QAAE;QAAS;QAAM;IAAQ;AAClC;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,6SAAO;IACjC,MAAM,YAAY,YAAY,GAAG,CAAC,iBAAiB;IAEnD,IAAI,WAAW;QACb,MAAM,IAAA,yLAAa,EAAC;IACtB;IAEA,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,6SAAO;IACjC,MAAM,YAAY,YAAY,GAAG,CAAC,iBAAiB;IAEnD,IAAI,CAAC,WAAW,OAAO;IAEvB,MAAM,UAAU,MAAM,IAAA,sLAAU,EAAC;IACjC,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,CAAC,MAAM,QAAQ,GAAG,MAAM,QAAQ,GAAG,CAAC;QACxC,IAAA,mLAAO,EAAC,QAAQ,MAAM;QACtB,IAAA,sLAAU,EAAC,QAAQ,SAAS;KAC7B;IAED,IAAI,CAAC,QAAQ,CAAC,SAAS;QACrB,MAAM,IAAA,yLAAa,EAAC;QACpB,OAAO;IACT;IAEA,OAAO;QAAE;QAAS;QAAM;IAAQ;AAClC;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM;IAC1B,IAAI,CAAC,aAAa;QAChB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,mMAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,OAAO,mMAAM,CAAC,OAAO,CAAC,UAAU;AAClC"}},
    {"offset": {"line": 1620, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/permissions/index.ts"],"sourcesContent":["// Role-Based Access Control (RBAC) System\n\nexport type UserRole = 'admin' | 'sales' | 'viewer' | 'sovra_admin';\n\nexport type Permission =\n  | 'deals:view'\n  | 'deals:create'\n  | 'training:view'\n  | 'legal:view'\n  | 'commissions:view'\n  | 'team:view'\n  | 'sovra:manage';\n\n// Permissions granted to each role\nexport const rolePermissions: Record<UserRole, Permission[]> = {\n  admin: [\n    'deals:view',\n    'deals:create',\n    'training:view',\n    'legal:view',\n    'commissions:view',\n    'team:view',\n  ],\n  sales: [\n    'deals:view',\n    'deals:create',\n    'training:view',\n  ],\n  viewer: [\n    'deals:view',\n    'training:view',\n  ],\n  sovra_admin: [\n    'sovra:manage',\n  ],\n};\n\n// Route to permission mapping\nconst routePermissions: Record<string, Permission> = {\n  '/partners/portal/deals': 'deals:view',\n  '/partners/portal/training': 'training:view',\n  '/partners/portal/training-center': 'training:view',\n  '/partners/portal/certifications': 'training:view',\n  '/partners/portal/legal': 'legal:view',\n  '/partners/portal/commissions': 'commissions:view',\n  '/partners/portal/team': 'team:view',\n};\n\n/**\n * Check if a role has a specific permission\n */\nexport function hasPermission(role: UserRole, permission: Permission): boolean {\n  const permissions = rolePermissions[role];\n  return permissions?.includes(permission) ?? false;\n}\n\n/**\n * Get all permissions for a role\n */\nexport function getRolePermissions(role: UserRole): Permission[] {\n  return rolePermissions[role] ?? [];\n}\n\n/**\n * Check if a role can access a specific route\n */\nexport function canAccessRoute(role: UserRole, route: string): boolean {\n  // Remove locale prefix (e.g., /en, /es, /pt)\n  const normalizedRoute = route.replace(/^\\/[a-z]{2}/, '');\n\n  // Dashboard is accessible to everyone\n  if (normalizedRoute === '/partners/portal' || normalizedRoute === '/partners/portal/') {\n    return true;\n  }\n\n  // Find matching route permission\n  for (const [routePattern, permission] of Object.entries(routePermissions)) {\n    if (normalizedRoute.startsWith(routePattern)) {\n      return hasPermission(role, permission);\n    }\n  }\n\n  // Default: allow access to routes not explicitly protected\n  return true;\n}\n\n/**\n * Get the required permission for a route\n */\nexport function getRoutePermission(route: string): Permission | null {\n  const normalizedRoute = route.replace(/^\\/[a-z]{2}/, '');\n\n  for (const [routePattern, permission] of Object.entries(routePermissions)) {\n    if (normalizedRoute.startsWith(routePattern)) {\n      return permission;\n    }\n  }\n\n  return null;\n}\n"],"names":[],"mappings":"AAAA,0CAA0C;;;;;;;;;;;;;AAcnC,MAAM,kBAAkD;IAC7D,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;KACD;IACD,OAAO;QACL;QACA;QACA;KACD;IACD,QAAQ;QACN;QACA;KACD;IACD,aAAa;QACX;KACD;AACH;AAEA,8BAA8B;AAC9B,MAAM,mBAA+C;IACnD,0BAA0B;IAC1B,6BAA6B;IAC7B,oCAAoC;IACpC,mCAAmC;IACnC,0BAA0B;IAC1B,gCAAgC;IAChC,yBAAyB;AAC3B;AAKO,SAAS,cAAc,IAAc,EAAE,UAAsB;IAClE,MAAM,cAAc,eAAe,CAAC,KAAK;IACzC,OAAO,aAAa,SAAS,eAAe;AAC9C;AAKO,SAAS,mBAAmB,IAAc;IAC/C,OAAO,eAAe,CAAC,KAAK,IAAI,EAAE;AACpC;AAKO,SAAS,eAAe,IAAc,EAAE,KAAa;IAC1D,6CAA6C;IAC7C,MAAM,kBAAkB,MAAM,OAAO,CAAC,eAAe;IAErD,sCAAsC;IACtC,IAAI,oBAAoB,sBAAsB,oBAAoB,qBAAqB;QACrF,OAAO;IACT;IAEA,iCAAiC;IACjC,KAAK,MAAM,CAAC,cAAc,WAAW,IAAI,OAAO,OAAO,CAAC,kBAAmB;QACzE,IAAI,gBAAgB,UAAU,CAAC,eAAe;YAC5C,OAAO,cAAc,MAAM;QAC7B;IACF;IAEA,2DAA2D;IAC3D,OAAO;AACT;AAKO,SAAS,mBAAmB,KAAa;IAC9C,MAAM,kBAAkB,MAAM,OAAO,CAAC,eAAe;IAErD,KAAK,MAAM,CAAC,cAAc,WAAW,IAAI,OAAO,OAAO,CAAC,kBAAmB;QACzE,IAAI,gBAAgB,UAAU,CAAC,eAAe;YAC5C,OAAO;QACT;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 1701, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/auth/withRoleGuard.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { requireSession } from './session';\nimport { hasPermission, type Permission } from '@/lib/permissions';\nimport type { UserRole } from '@/types';\n\n/**\n * Higher-order function to protect API routes with role-based access control\n */\nexport function withRoleGuard<T>(\n  permission: Permission,\n  handler: (sessionData: Awaited<ReturnType<typeof requireSession>>) => Promise<T>\n): () => Promise<NextResponse<T> | NextResponse<{ error: string }>> {\n  return async () => {\n    try {\n      const sessionData = await requireSession();\n      const userRole = sessionData.user.role as UserRole;\n\n      if (!hasPermission(userRole, permission)) {\n        return NextResponse.json(\n          { error: 'Forbidden: Insufficient permissions' },\n          { status: 403 }\n        );\n      }\n\n      return await handler(sessionData) as NextResponse<T>;\n    } catch (error) {\n      if (error instanceof Error && error.message === 'Unauthorized') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n      }\n      console.error('API error:', error);\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n  };\n}\n\n/**\n * Middleware function to check permission and return session data\n * Use this for more complex handlers that need request access\n */\nexport async function checkPermission(\n  permission: Permission\n): Promise<\n  | { authorized: true; sessionData: Awaited<ReturnType<typeof requireSession>> }\n  | { authorized: false; response: NextResponse<{ error: string }> }\n> {\n  try {\n    const sessionData = await requireSession();\n    const userRole = sessionData.user.role as UserRole;\n\n    if (!hasPermission(userRole, permission)) {\n      return {\n        authorized: false,\n        response: NextResponse.json(\n          { error: 'Forbidden: Insufficient permissions' },\n          { status: 403 }\n        ),\n      };\n    }\n\n    return { authorized: true, sessionData };\n  } catch (error) {\n    if (error instanceof Error && error.message === 'Unauthorized') {\n      return {\n        authorized: false,\n        response: NextResponse.json({ error: 'Unauthorized' }, { status: 401 }),\n      };\n    }\n    return {\n      authorized: false,\n      response: NextResponse.json({ error: 'Internal server error' }, { status: 500 }),\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAMO,SAAS,cACd,UAAsB,EACtB,OAAgF;IAEhF,OAAO;QACL,IAAI;YACF,MAAM,cAAc,MAAM,IAAA,sLAAc;YACxC,MAAM,WAAW,YAAY,IAAI,CAAC,IAAI;YAEtC,IAAI,CAAC,IAAA,0LAAa,EAAC,UAAU,aAAa;gBACxC,OAAO,iTAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAAsC,GAC/C;oBAAE,QAAQ;gBAAI;YAElB;YAEA,OAAO,MAAM,QAAQ;QACvB,EAAE,OAAO,OAAO;YACd,IAAI,iBAAiB,SAAS,MAAM,OAAO,KAAK,gBAAgB;gBAC9D,OAAO,iTAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAe,GAAG;oBAAE,QAAQ;gBAAI;YACpE;YACA,QAAQ,KAAK,CAAC,cAAc;YAC5B,OAAO,iTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;IACF;AACF;AAMO,eAAe,gBACpB,UAAsB;IAKtB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,sLAAc;QACxC,MAAM,WAAW,YAAY,IAAI,CAAC,IAAI;QAEtC,IAAI,CAAC,IAAA,0LAAa,EAAC,UAAU,aAAa;YACxC,OAAO;gBACL,YAAY;gBACZ,UAAU,iTAAY,CAAC,IAAI,CACzB;oBAAE,OAAO;gBAAsC,GAC/C;oBAAE,QAAQ;gBAAI;YAElB;QACF;QAEA,OAAO;YAAE,YAAY;YAAM;QAAY;IACzC,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,SAAS,MAAM,OAAO,KAAK,gBAAgB;YAC9D,OAAO;gBACL,YAAY;gBACZ,UAAU,iTAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAe,GAAG;oBAAE,QAAQ;gBAAI;YACvE;QACF;QACA,OAAO;YACL,YAAY;YACZ,UAAU,iTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAChF;IACF;AACF"}},
    {"offset": {"line": 1786, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/auth/index.ts"],"sourcesContent":["export {\n  login,\n  logout,\n  getCurrentSession,\n  requireSession,\n  hashPassword,\n  verifyPassword,\n  type SessionData,\n} from './session';\n\nexport { withRoleGuard, checkPermission } from './withRoleGuard';\n"],"names":[],"mappings":";AAAA;AAUA"}},
    {"offset": {"line": 1795, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/rewards/types.ts"],"sourcesContent":["// ============ Rewards System Types ============\n\n/**\n * Actions that can earn reward points\n */\nexport type RewardAction =\n  | 'DEAL_CLOSED'\n  | 'TRAINING_COMPLETED'\n  | 'COPILOT_SESSION'\n  | 'REFERRAL'\n  | 'DOCUMENT_SIGNED'\n  | 'POSITIVE_REVIEW'\n  | 'LOGIN_STREAK_7'\n  | 'FIRST_DEAL_MONTH';\n\n/**\n * Points awarded for each action\n */\nexport const REWARD_POINTS: Record<RewardAction, number> = {\n  DEAL_CLOSED: 100,\n  TRAINING_COMPLETED: 50,\n  COPILOT_SESSION: 10,\n  REFERRAL: 200,\n  DOCUMENT_SIGNED: 25,\n  POSITIVE_REVIEW: 75,\n  LOGIN_STREAK_7: 30,\n  FIRST_DEAL_MONTH: 50,\n};\n\n/**\n * Reward milestones that trigger special events\n */\nexport const REWARD_MILESTONES = [1000, 5000, 10000] as const;\nexport type RewardMilestone = typeof REWARD_MILESTONES[number];\n\n/**\n * Partner tier for rewards\n */\nexport type PartnerTier = 'bronze' | 'silver' | 'gold' | 'platinum';\n\n/**\n * Achievement categories\n */\nexport type AchievementCategory = 'deals' | 'training' | 'engagement' | 'milestones';\n\n/**\n * Achievement interface\n */\nexport interface Achievement {\n  id: string;\n  name: string;\n  description: string;\n  category: AchievementCategory;\n  points: number;\n  iconName: string;\n  condition: (stats: PartnerStats) => boolean;\n}\n\n/**\n * Partner statistics for rewards\n */\nexport interface PartnerStats {\n  dealsWon: number;\n  trainingsCompleted: number;\n  copilotSessions: number;\n  referrals: number;\n  loginStreak: number;\n  totalPoints: number;\n}\n\n/**\n * Record of points awarded for an action\n */\nexport interface PointsAwarded {\n  partnerId: string;\n  action: RewardAction;\n  points: number;\n  newTotal: number;\n  milestoneReached?: RewardMilestone;\n  achievementsUnlocked: string[];\n  timestamp: string;\n}\n\n/**\n * Overall reward status for a partner\n */\nexport interface RewardStatus {\n  partnerId: string;\n  totalPoints: number;\n  tier: PartnerTier;\n  achievements: string[];\n  nextMilestone: RewardMilestone | null;\n  pointsToNextMilestone: number;\n  leaderboardPosition: number | null;\n}\n\n/**\n * Leaderboard entry\n */\nexport interface LeaderboardEntry {\n  partnerId: string;\n  partnerName: string;\n  points: number;\n  tier: PartnerTier;\n  position: number;\n}\n"],"names":[],"mappings":"AAAA,iDAAiD;AAEjD;;CAEC;;;;;;AAcM,MAAM,gBAA8C;IACzD,aAAa;IACb,oBAAoB;IACpB,iBAAiB;IACjB,UAAU;IACV,iBAAiB;IACjB,iBAAiB;IACjB,gBAAgB;IAChB,kBAAkB;AACpB;AAKO,MAAM,oBAAoB;IAAC;IAAM;IAAM;CAAM"}},
    {"offset": {"line": 1823, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/rewards/calculator.ts"],"sourcesContent":["import { REWARD_POINTS, REWARD_MILESTONES, type RewardAction, type RewardMilestone } from './types';\n\n/**\n * Get points for a specific action\n */\nexport function calculatePointsForAction(action: RewardAction): number {\n  return REWARD_POINTS[action];\n}\n\n/**\n * Check if a milestone was reached between old and new point totals\n * Returns the milestone value if reached, null otherwise\n */\nexport function checkMilestoneReached(\n  oldPoints: number,\n  newPoints: number\n): RewardMilestone | null {\n  // Find milestones that were crossed\n  const crossedMilestones = REWARD_MILESTONES.filter(\n    (milestone) => oldPoints < milestone && newPoints >= milestone\n  );\n\n  // Return the highest milestone crossed, or null if none\n  return crossedMilestones.length > 0\n    ? crossedMilestones[crossedMilestones.length - 1]\n    : null;\n}\n\n/**\n * Calculate next milestone and points needed\n */\nexport function getNextMilestone(currentPoints: number): {\n  milestone: RewardMilestone | null;\n  pointsNeeded: number;\n} {\n  const nextMilestone = REWARD_MILESTONES.find((m) => m > currentPoints);\n\n  if (!nextMilestone) {\n    return { milestone: null, pointsNeeded: 0 };\n  }\n\n  return {\n    milestone: nextMilestone,\n    pointsNeeded: nextMilestone - currentPoints,\n  };\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAKO,SAAS,yBAAyB,MAAoB;IAC3D,OAAO,sLAAa,CAAC,OAAO;AAC9B;AAMO,SAAS,sBACd,SAAiB,EACjB,SAAiB;IAEjB,oCAAoC;IACpC,MAAM,oBAAoB,0LAAiB,CAAC,MAAM,CAChD,CAAC,YAAc,YAAY,aAAa,aAAa;IAGvD,wDAAwD;IACxD,OAAO,kBAAkB,MAAM,GAAG,IAC9B,iBAAiB,CAAC,kBAAkB,MAAM,GAAG,EAAE,GAC/C;AACN;AAKO,SAAS,iBAAiB,aAAqB;IAIpD,MAAM,gBAAgB,0LAAiB,CAAC,IAAI,CAAC,CAAC,IAAM,IAAI;IAExD,IAAI,CAAC,eAAe;QAClB,OAAO;YAAE,WAAW;YAAM,cAAc;QAAE;IAC5C;IAEA,OAAO;QACL,WAAW;QACX,cAAc,gBAAgB;IAChC;AACF"}},
    {"offset": {"line": 1859, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/rewards/achievements.ts"],"sourcesContent":["import type { Achievement, PartnerStats } from './types';\n\n/**\n * All available achievements\n */\nexport const ACHIEVEMENTS: Achievement[] = [\n  // Deals category\n  {\n    id: 'first-blood',\n    name: 'First Blood',\n    description: 'Close your first deal',\n    category: 'deals',\n    points: 50,\n    iconName: 'Trophy',\n    condition: (stats) => stats.dealsWon >= 1,\n  },\n  {\n    id: 'hat-trick',\n    name: 'Hat Trick',\n    description: 'Close 3 deals in a month',\n    category: 'deals',\n    points: 100,\n    iconName: 'Target',\n    condition: (stats) => stats.dealsWon >= 3,\n  },\n  {\n    id: 'deal-master',\n    name: 'Deal Master',\n    description: 'Close 10 deals',\n    category: 'deals',\n    points: 200,\n    iconName: 'Award',\n    condition: (stats) => stats.dealsWon >= 10,\n  },\n\n  // Training category\n  {\n    id: 'scholar',\n    name: 'Scholar',\n    description: 'Complete 5 training modules',\n    category: 'training',\n    points: 100,\n    iconName: 'GraduationCap',\n    condition: (stats) => stats.trainingsCompleted >= 5,\n  },\n  {\n    id: 'expert',\n    name: 'Expert',\n    description: 'Complete 10 training modules',\n    category: 'training',\n    points: 200,\n    iconName: 'BookOpen',\n    condition: (stats) => stats.trainingsCompleted >= 10,\n  },\n\n  // Engagement category\n  {\n    id: 'ai-enthusiast',\n    name: 'AI Enthusiast',\n    description: 'Use Copilot 20 times',\n    category: 'engagement',\n    points: 100,\n    iconName: 'Sparkles',\n    condition: (stats) => stats.copilotSessions >= 20,\n  },\n  {\n    id: 'marathon',\n    name: 'Marathon Runner',\n    description: 'Login 30 days in a row',\n    category: 'engagement',\n    points: 150,\n    iconName: 'Flame',\n    condition: (stats) => stats.loginStreak >= 30,\n  },\n  {\n    id: 'networker',\n    name: 'Networker',\n    description: 'Refer 3 new partners',\n    category: 'engagement',\n    points: 300,\n    iconName: 'Users',\n    condition: (stats) => stats.referrals >= 3,\n  },\n\n  // Milestones category\n  {\n    id: 'rising-star',\n    name: 'Rising Star',\n    description: 'Earn 1,000 reward points',\n    category: 'milestones',\n    points: 100,\n    iconName: 'Star',\n    condition: (stats) => stats.totalPoints >= 1000,\n  },\n  {\n    id: 'high-achiever',\n    name: 'High Achiever',\n    description: 'Earn 5,000 reward points',\n    category: 'milestones',\n    points: 250,\n    iconName: 'Zap',\n    condition: (stats) => stats.totalPoints >= 5000,\n  },\n  {\n    id: 'elite',\n    name: 'Elite Partner',\n    description: 'Earn 10,000 reward points',\n    category: 'milestones',\n    points: 500,\n    iconName: 'Crown',\n    condition: (stats) => stats.totalPoints >= 10000,\n  },\n];\n\n/**\n * Check if an achievement condition is met\n */\nexport function checkAchievementUnlocked(\n  achievement: Achievement,\n  stats: PartnerStats\n): boolean {\n  return achievement.condition(stats);\n}\n\n/**\n * Get all achievements that should be unlocked for given stats\n */\nexport function getUnlockedAchievements(\n  stats: PartnerStats,\n  currentlyUnlocked: string[]\n): Achievement[] {\n  return ACHIEVEMENTS.filter(\n    (achievement) =>\n      !currentlyUnlocked.includes(achievement.id) &&\n      checkAchievementUnlocked(achievement, stats)\n  );\n}\n"],"names":[],"mappings":";;;;;;;;AAKO,MAAM,eAA8B;IACzC,iBAAiB;IACjB;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,QAAQ,IAAI;IAC1C;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,QAAQ,IAAI;IAC1C;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,QAAQ,IAAI;IAC1C;IAEA,oBAAoB;IACpB;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,kBAAkB,IAAI;IACpD;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,kBAAkB,IAAI;IACpD;IAEA,sBAAsB;IACtB;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,eAAe,IAAI;IACjD;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,WAAW,IAAI;IAC7C;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,SAAS,IAAI;IAC3C;IAEA,sBAAsB;IACtB;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,WAAW,IAAI;IAC7C;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,WAAW,IAAI;IAC7C;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;QACV,QAAQ;QACR,UAAU;QACV,WAAW,CAAC,QAAU,MAAM,WAAW,IAAI;IAC7C;CACD;AAKM,SAAS,yBACd,WAAwB,EACxB,KAAmB;IAEnB,OAAO,YAAY,SAAS,CAAC;AAC/B;AAKO,SAAS,wBACd,KAAmB,EACnB,iBAA2B;IAE3B,OAAO,aAAa,MAAM,CACxB,CAAC,cACC,CAAC,kBAAkB,QAAQ,CAAC,YAAY,EAAE,KAC1C,yBAAyB,aAAa;AAE5C"}},
    {"offset": {"line": 1982, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/rewards/engine.ts"],"sourcesContent":["import { redis } from '@/lib/redis/client';\nimport { keys } from '@/lib/redis/keys';\nimport { calculatePointsForAction, checkMilestoneReached, getNextMilestone } from './calculator';\nimport { getUnlockedAchievements } from './achievements';\nimport type {\n  RewardAction,\n  PointsAwarded,\n  RewardStatus,\n  PartnerStats,\n  PartnerTier,\n} from './types';\n\n/**\n * Award points to a partner for completing an action\n * This is the main entry point for the rewards system\n */\nexport async function awardPoints(\n  partnerId: string,\n  action: RewardAction\n): Promise<PointsAwarded> {\n  // Calculate points for the action\n  const points = calculatePointsForAction(action);\n\n  // Get current points and achievements\n  const currentPoints = (await redis.get<number>(keys.rewardPoints(partnerId))) ?? 0;\n  const currentAchievements = (await redis.get<string[]>(keys.achievements(partnerId))) ?? [];\n\n  // Calculate new total\n  const newTotal = currentPoints + points;\n\n  // Check if milestone was reached\n  const milestoneReached = checkMilestoneReached(currentPoints, newTotal);\n\n  // Get partner stats to check for achievement unlocks\n  const partnerStats = (await redis.get<PartnerStats>(keys.partnerStats(partnerId))) ?? {\n    dealsWon: 0,\n    trainingsCompleted: 0,\n    copilotSessions: 0,\n    referrals: 0,\n    loginStreak: 0,\n    totalPoints: newTotal,\n  };\n\n  // Update total points in stats\n  partnerStats.totalPoints = newTotal;\n\n  // Check for newly unlocked achievements\n  const newlyUnlocked = getUnlockedAchievements(partnerStats, currentAchievements);\n  const newAchievementIds = newlyUnlocked.map((a) => a.id);\n\n  // Calculate bonus points from achievements\n  const achievementBonusPoints = newlyUnlocked.reduce((sum, a) => sum + a.points, 0);\n  const finalTotal = newTotal + achievementBonusPoints;\n\n  // Update Redis\n  await Promise.all([\n    // Update points\n    redis.set(keys.rewardPoints(partnerId), finalTotal),\n    // Update achievements\n    redis.set(keys.achievements(partnerId), [...currentAchievements, ...newAchievementIds]),\n    // Update leaderboard (sorted set by points)\n    redis.zadd(keys.rewardsLeaderboard(), { score: finalTotal, member: partnerId }),\n    // Store reward event\n    redis.set(\n      `${keys.rewardEvents(partnerId)}:${Date.now()}`,\n      {\n        action,\n        points,\n        timestamp: new Date().toISOString(),\n        milestoneReached,\n        achievementsUnlocked: newAchievementIds,\n      }\n    ),\n  ]);\n\n  return {\n    partnerId,\n    action,\n    points,\n    newTotal: finalTotal,\n    milestoneReached: milestoneReached ?? undefined,\n    achievementsUnlocked: newAchievementIds,\n    timestamp: new Date().toISOString(),\n  };\n}\n\n/**\n * Get the complete reward status for a partner\n */\nexport async function getRewardStatus(partnerId: string): Promise<RewardStatus> {\n  // Get data from Redis in parallel\n  const [totalPoints, achievements, leaderboardRank] = await Promise.all([\n    redis.get<number>(keys.rewardPoints(partnerId)),\n    redis.get<string[]>(keys.achievements(partnerId)),\n    redis.zrevrank(keys.rewardsLeaderboard(), partnerId),\n  ]);\n\n  const points = totalPoints ?? 0;\n  const unlockedAchievements = achievements ?? [];\n\n  // Calculate tier based on points\n  const tier = calculateTier(points);\n\n  // Calculate next milestone\n  const { milestone: nextMilestone, pointsNeeded } = getNextMilestone(points);\n\n  // Leaderboard position (zrevrank returns 0-indexed position, we want 1-indexed)\n  const leaderboardPosition = leaderboardRank !== null ? leaderboardRank + 1 : null;\n\n  return {\n    partnerId,\n    totalPoints: points,\n    tier,\n    achievements: unlockedAchievements,\n    nextMilestone,\n    pointsToNextMilestone: pointsNeeded,\n    leaderboardPosition,\n  };\n}\n\n/**\n * Calculate partner tier based on total points\n */\nfunction calculateTier(points: number): PartnerTier {\n  if (points >= 10000) return 'platinum';\n  if (points >= 5000) return 'gold';\n  if (points >= 1000) return 'silver';\n  return 'bronze';\n}\n\n/**\n * Update partner stats (called from various parts of the system)\n */\nexport async function updatePartnerStats(\n  partnerId: string,\n  updates: Partial<PartnerStats>\n): Promise<void> {\n  const currentStats = (await redis.get<PartnerStats>(keys.partnerStats(partnerId))) ?? {\n    dealsWon: 0,\n    trainingsCompleted: 0,\n    copilotSessions: 0,\n    referrals: 0,\n    loginStreak: 0,\n    totalPoints: 0,\n  };\n\n  const updatedStats = { ...currentStats, ...updates };\n  await redis.set(keys.partnerStats(partnerId), updatedStats);\n}\n\n/**\n * Get partner statistics\n */\nexport async function getPartnerStats(partnerId: string): Promise<PartnerStats> {\n  const stats = await redis.get<PartnerStats>(keys.partnerStats(partnerId));\n  return stats ?? {\n    dealsWon: 0,\n    trainingsCompleted: 0,\n    copilotSessions: 0,\n    referrals: 0,\n    loginStreak: 0,\n    totalPoints: 0,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2123, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/rewards/leaderboard.ts"],"sourcesContent":["import { redis } from '@/lib/redis/client';\nimport { keys } from '@/lib/redis/keys';\n\nexport interface LeaderboardEntry {\n  rank: number;\n  partnerId: string;\n  name: string;\n  points: number;\n}\n\n/**\n * Get the top partners from the leaderboard\n */\nexport async function getLeaderboard(limit: number = 10): Promise<LeaderboardEntry[]> {\n  // Get top partners from sorted set (highest to lowest)\n  const results = await redis.zrange(keys.rewardsLeaderboard(), 0, limit - 1, {\n    rev: true,\n    withScores: true,\n  });\n\n  if (!results || results.length === 0) {\n    return [];\n  }\n\n  // Get partner data in parallel\n  const partnerIds = results.map((r) => r.value);\n  const partnerData = await Promise.all(\n    partnerIds.map((id) => redis.get<{ name?: string }>(keys.partner(id)))\n  );\n\n  // Build leaderboard entries\n  return results.map((result, index) => ({\n    rank: index + 1,\n    partnerId: result.value,\n    name: partnerData[index]?.name ?? result.value, // Fallback to ID if name not found\n    points: result.score,\n  }));\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAYO,eAAe,eAAe,QAAgB,EAAE;IACrD,uDAAuD;IACvD,MAAM,UAAU,MAAM,6KAAK,CAAC,MAAM,CAAC,0KAAI,CAAC,kBAAkB,IAAI,GAAG,QAAQ,GAAG;QAC1E,KAAK;QACL,YAAY;IACd;IAEA,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,GAAG;QACpC,OAAO,EAAE;IACX;IAEA,+BAA+B;IAC/B,MAAM,aAAa,QAAQ,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK;IAC7C,MAAM,cAAc,MAAM,QAAQ,GAAG,CACnC,WAAW,GAAG,CAAC,CAAC,KAAO,6KAAK,CAAC,GAAG,CAAoB,0KAAI,CAAC,OAAO,CAAC;IAGnE,4BAA4B;IAC5B,OAAO,QAAQ,GAAG,CAAC,CAAC,QAAQ,QAAU,CAAC;YACrC,MAAM,QAAQ;YACd,WAAW,OAAO,KAAK;YACvB,MAAM,WAAW,CAAC,MAAM,EAAE,QAAQ,OAAO,KAAK;YAC9C,QAAQ,OAAO,KAAK;QACtB,CAAC;AACH"}},
    {"offset": {"line": 2155, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/lib/rewards/index.ts"],"sourcesContent":["/**\n * Rewards System - Main Entry Point\n *\n * This barrel export provides a clean interface to the rewards system.\n * Use this as the main import point for all reward-related functionality.\n *\n * Example:\n * ```\n * import { awardPoints, getRewardStatus, getLeaderboard } from '@/lib/rewards';\n * ```\n */\n\n// Core Engine Functions\nexport {\n  awardPoints,\n  getRewardStatus,\n  updatePartnerStats,\n  getPartnerStats,\n} from './engine';\n\n// Calculator Functions\nexport {\n  calculatePointsForAction,\n  checkMilestoneReached,\n  getNextMilestone,\n} from './calculator';\n\n// Achievement Functions\nexport {\n  getUnlockedAchievements,\n  getAchievementById,\n  getAllAchievements,\n} from './achievements';\n\n// Leaderboard Functions\nexport { getLeaderboard } from './leaderboard';\n\n// Type Exports\nexport type {\n  RewardAction,\n  PartnerTier,\n  Milestone,\n  Achievement,\n  PartnerStats,\n  PointsAwarded,\n  RewardStatus,\n  LeaderboardEntry,\n} from './types';\n\nexport type { LeaderboardEntry as LeaderboardEntryType } from './leaderboard';\n"],"names":[],"mappings":";AAAA;;;;;;;;;;CAUC,GAED,wBAAwB;AACxB;AAOA,uBAAuB;AACvB;AAMA,wBAAwB;AACxB;AAMA,wBAAwB;AACxB"}},
    {"offset": {"line": 2182, "column": 0}, "map": {"version":3,"sources":["file:///Users/lucasjolias/code/playground/apps/web/partners-portal/src/app/api/partners/rewards/status/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { getCurrentSession } from '@/lib/auth';\nimport { getRewardStatus } from '@/lib/rewards';\n\nexport async function GET() {\n  try {\n    // Check authentication\n    const session = await getCurrentSession();\n    if (!session) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      );\n    }\n\n    // Get reward status for the authenticated partner\n    const rewardStatus = await getRewardStatus(session.partner.id);\n\n    return NextResponse.json(rewardStatus);\n  } catch (error) {\n    console.error('Failed to fetch reward status:', error);\n    return NextResponse.json(\n      { error: 'Failed to fetch reward status' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEO,eAAe;IACpB,IAAI;QACF,uBAAuB;QACvB,MAAM,UAAU,MAAM,IAAA,yLAAiB;QACvC,IAAI,CAAC,SAAS;YACZ,OAAO,iTAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,kDAAkD;QAClD,MAAM,eAAe,MAAM,IAAA,yLAAe,EAAC,QAAQ,OAAO,CAAC,EAAE;QAE7D,OAAO,iTAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,iTAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAgC,GACzC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}