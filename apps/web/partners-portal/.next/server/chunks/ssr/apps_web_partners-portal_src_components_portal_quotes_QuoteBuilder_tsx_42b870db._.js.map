{"version":3,"sources":["../../../../../../../apps/web/partners-portal/src/components/portal/quotes/QuoteBuilder.tsx","../../../../../../../apps/web/partners-portal/src/lib/pricing/calculator.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Check, FileText, Download } from 'lucide-react';\nimport { SovraLoader } from '@/components/ui';\nimport { calculateQuote, formatCurrency, formatPopulation, type CalculatePriceParams, type CalculatedQuote } from '@/lib/pricing/calculator';\nimport type { Deal, Partner, PricingConfig, SovraIdPlan } from '@/types';\n\ninterface QuoteBuilderProps {\n  deal: Deal;\n  partner: Partner;\n  pricingConfig: PricingConfig;\n  locale: string;\n}\n\nconst SOVRA_ID_PLANS: { value: SovraIdPlan; label: string; description: string }[] = [\n  { value: 'essentials', label: 'Essentials', description: 'Ideal para empezar' },\n  { value: 'professional', label: 'Professional', description: 'Para gobiernos en crecimiento' },\n  { value: 'enterprise', label: 'Enterprise', description: 'Maximo poder y flexibilidad' },\n];\n\nexport function QuoteBuilder({ deal, partner, pricingConfig, locale }: QuoteBuilderProps) {\n  const router = useRouter();\n  const [isCreating, setIsCreating] = useState(false);\n  const [createdQuoteId, setCreatedQuoteId] = useState<string | null>(null);\n\n  // Form state\n  const [sovraGovIncluded, setSovraGovIncluded] = useState(true);\n  const [sovraIdIncluded, setSovraIdIncluded] = useState(true);\n  const [sovraIdPlan, setSovraIdPlan] = useState<SovraIdPlan>('professional');\n  const [walletImplementation, setWalletImplementation] = useState(false);\n  const [integrationHours, setIntegrationHours] = useState(0);\n\n  // Calculated quote\n  const [quote, setQuote] = useState<CalculatedQuote | null>(null);\n\n  // Calculate quote when inputs change\n  useEffect(() => {\n    const params: CalculatePriceParams = {\n      population: deal.population,\n      sovraGovIncluded,\n      sovraIdIncluded,\n      sovraIdPlan,\n      walletImplementation,\n      integrationHours,\n      partnerTier: partner.tier,\n      partnerGeneratedLead: deal.partnerGeneratedLead,\n    };\n\n    const calculated = calculateQuote(params, pricingConfig);\n    setQuote(calculated);\n  }, [deal.population, deal.partnerGeneratedLead, partner.tier, pricingConfig, sovraGovIncluded, sovraIdIncluded, sovraIdPlan, walletImplementation, integrationHours]);\n\n  const handleCreateQuote = async () => {\n    if (!quote) return;\n\n    setIsCreating(true);\n\n    try {\n      const response = await fetch('/api/partners/quotes', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dealId: deal.id,\n          products: quote.products,\n          services: quote.services,\n          discounts: quote.discounts,\n          subtotal: quote.subtotal,\n          totalDiscount: quote.totalDiscount,\n          total: quote.total,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create quote');\n      }\n\n      const { quote: createdQuote } = await response.json();\n      setCreatedQuoteId(createdQuote.id);\n    } catch (error) {\n      console.error('Error creating quote:', error);\n      alert('Error al crear la cotizacion');\n    } finally {\n      setIsCreating(false);\n    }\n  };\n\n  const handleDownloadPDF = () => {\n    if (!createdQuoteId) return;\n    window.open(`/api/partners/quotes/${createdQuoteId}/pdf`, '_blank');\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Deal Info */}\n      <div className=\"bg-gradient-to-r from-blue-600 to-blue-700 rounded-xl p-6 text-white\">\n        <h2 className=\"text-xl font-bold mb-2\">{deal.clientName}</h2>\n        <p className=\"text-blue-100\">\n          {deal.country} - {deal.governmentLevel === 'municipality' ? 'Municipio' : deal.governmentLevel === 'province' ? 'Provincia' : 'Nacional'}\n        </p>\n        <p className=\"text-2xl font-bold mt-2\">{formatPopulation(deal.population)} habitantes</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Configuration Column */}\n        <div className=\"lg:col-span-2 space-y-6\">\n          {/* SovraGov */}\n          <div className=\"bg-white rounded-xl border border-gray-200 overflow-hidden\">\n            <div className=\"p-4 border-b border-gray-100 flex items-center justify-between\">\n              <div>\n                <h3 className=\"font-semibold text-gray-900\">SovraGov</h3>\n                <p className=\"text-sm text-gray-500\">Plataforma de gobierno digital</p>\n              </div>\n              <label className=\"relative inline-flex items-center cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={sovraGovIncluded}\n                  onChange={(e) => setSovraGovIncluded(e.target.checked)}\n                  className=\"sr-only peer\"\n                />\n                <div className=\"w-11 h-6 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n              </label>\n            </div>\n            {sovraGovIncluded && quote && (\n              <div className=\"p-4 bg-gray-50\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600\">Precio por habitante</span>\n                  <span className=\"font-medium\">{formatCurrency(quote.products.sovraGov.pricePerInhabitant)}</span>\n                </div>\n                <div className=\"flex justify-between text-sm mt-2\">\n                  <span className=\"text-gray-600\">Poblacion</span>\n                  <span className=\"font-medium\">{formatPopulation(deal.population)}</span>\n                </div>\n                <div className=\"flex justify-between mt-3 pt-3 border-t border-gray-200\">\n                  <span className=\"font-medium text-gray-900\">Precio anual</span>\n                  <span className=\"font-bold text-blue-600\">{formatCurrency(quote.products.sovraGov.annualPrice)}</span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* SovraID */}\n          <div className=\"bg-white rounded-xl border border-gray-200 overflow-hidden\">\n            <div className=\"p-4 border-b border-gray-100 flex items-center justify-between\">\n              <div>\n                <h3 className=\"font-semibold text-gray-900\">SovraID</h3>\n                <p className=\"text-sm text-gray-500\">Identidad digital ciudadana</p>\n              </div>\n              <label className=\"relative inline-flex items-center cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={sovraIdIncluded}\n                  onChange={(e) => setSovraIdIncluded(e.target.checked)}\n                  className=\"sr-only peer\"\n                />\n                <div className=\"w-11 h-6 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n              </label>\n            </div>\n            {sovraIdIncluded && quote && (\n              <div className=\"p-4\">\n                <div className=\"grid grid-cols-3 gap-3\">\n                  {SOVRA_ID_PLANS.map((plan) => {\n                    const planConfig = pricingConfig.sovraId[plan.value];\n                    const isSelected = sovraIdPlan === plan.value;\n\n                    return (\n                      <button\n                        key={plan.value}\n                        onClick={() => setSovraIdPlan(plan.value)}\n                        className={`p-4 rounded-lg border-2 text-left transition-all ${\n                          isSelected\n                            ? 'border-blue-600 bg-blue-50'\n                            : 'border-gray-200 hover:border-gray-300'\n                        }`}\n                      >\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <span className=\"font-semibold text-gray-900\">{plan.label}</span>\n                          {isSelected && <Check className=\"w-5 h-5 text-blue-600\" />}\n                        </div>\n                        <p className=\"text-xs text-gray-500 mb-2\">{plan.description}</p>\n                        <p className=\"text-lg font-bold text-gray-900\">\n                          {formatCurrency(planConfig.monthlyPrice)}/mes\n                        </p>\n                        <p className=\"text-xs text-gray-500\">\n                          Hasta {planConfig.monthlyLimit.toLocaleString()} verificaciones/mes\n                        </p>\n                      </button>\n                    );\n                  })}\n                </div>\n                <div className=\"flex justify-between mt-4 pt-4 border-t border-gray-200\">\n                  <span className=\"font-medium text-gray-900\">Precio anual</span>\n                  <span className=\"font-bold text-blue-600\">{formatCurrency(quote.products.sovraId.annualPrice)}</span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Professional Services */}\n          <div className=\"bg-white rounded-xl border border-gray-200 overflow-hidden\">\n            <div className=\"p-4 border-b border-gray-100\">\n              <h3 className=\"font-semibold text-gray-900\">Servicios Profesionales</h3>\n              <p className=\"text-sm text-gray-500\">Implementacion e integracion</p>\n            </div>\n            <div className=\"p-4 space-y-4\">\n              {/* Wallet Implementation */}\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"font-medium text-gray-900\">Implementacion Wallet</p>\n                  <p className=\"text-sm text-gray-500\">{formatCurrency(pricingConfig.services.walletImplementation)}</p>\n                </div>\n                <label className=\"relative inline-flex items-center cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={walletImplementation}\n                    onChange={(e) => setWalletImplementation(e.target.checked)}\n                    className=\"sr-only peer\"\n                  />\n                  <div className=\"w-11 h-6 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n                </label>\n              </div>\n\n              {/* Integration Hours */}\n              <div>\n                <div className=\"flex items-center justify-between mb-2\">\n                  <p className=\"font-medium text-gray-900\">Horas de Integracion</p>\n                  <p className=\"text-sm text-gray-500\">{formatCurrency(pricingConfig.services.integrationHourlyRate)}/hora</p>\n                </div>\n                <div className=\"flex items-center gap-4\">\n                  <input\n                    type=\"range\"\n                    min=\"0\"\n                    max=\"100\"\n                    step=\"5\"\n                    value={integrationHours}\n                    onChange={(e) => setIntegrationHours(parseInt(e.target.value))}\n                    className=\"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer\"\n                  />\n                  <span className=\"text-lg font-bold text-gray-900 w-16 text-right\">{integrationHours}h</span>\n                </div>\n                {integrationHours > 0 && quote && (\n                  <p className=\"text-sm text-gray-600 mt-2\">\n                    Total: {formatCurrency(quote.services.integrationTotal)}\n                  </p>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Summary Column */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-white rounded-xl border border-gray-200 sticky top-24\">\n            <div className=\"p-4 border-b border-gray-100\">\n              <h3 className=\"font-semibold text-gray-900\">Resumen de Cotizacion</h3>\n            </div>\n            {quote && (\n              <div className=\"p-4 space-y-4\">\n                {/* Line items */}\n                {quote.products.sovraGov.included && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-600\">SovraGov</span>\n                    <span className=\"font-medium\">{formatCurrency(quote.products.sovraGov.annualPrice)}</span>\n                  </div>\n                )}\n                {quote.products.sovraId.included && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-600\">SovraID ({quote.products.sovraId.plan})</span>\n                    <span className=\"font-medium\">{formatCurrency(quote.products.sovraId.annualPrice)}</span>\n                  </div>\n                )}\n                {quote.services.walletImplementation && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-600\">Implementacion Wallet</span>\n                    <span className=\"font-medium\">{formatCurrency(quote.services.walletPrice)}</span>\n                  </div>\n                )}\n                {quote.services.integrationHours > 0 && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-600\">Integracion ({quote.services.integrationHours}h)</span>\n                    <span className=\"font-medium\">{formatCurrency(quote.services.integrationTotal)}</span>\n                  </div>\n                )}\n\n                {/* Subtotal */}\n                <div className=\"flex justify-between pt-4 border-t border-gray-200\">\n                  <span className=\"text-gray-900\">Subtotal</span>\n                  <span className=\"font-medium\">{formatCurrency(quote.subtotal)}</span>\n                </div>\n\n                {/* Discount */}\n                {quote.discounts.totalDiscountPercent > 0 && (\n                  <div className=\"bg-green-50 rounded-lg p-3\">\n                    <div className=\"flex justify-between text-sm text-green-800\">\n                      <span>Descuento Partner ({partner.tier})</span>\n                      <span>-{quote.discounts.baseDiscountPercent}%</span>\n                    </div>\n                    {quote.discounts.leadBonusPercent > 0 && (\n                      <div className=\"flex justify-between text-sm text-green-800 mt-1\">\n                        <span>Bonus Lead Generado</span>\n                        <span>-{quote.discounts.leadBonusPercent}%</span>\n                      </div>\n                    )}\n                    <div className=\"flex justify-between font-medium text-green-900 mt-2 pt-2 border-t border-green-200\">\n                      <span>Descuento total</span>\n                      <span>-{formatCurrency(quote.discounts.discountAmount)}</span>\n                    </div>\n                  </div>\n                )}\n\n                {/* Total */}\n                <div className=\"flex justify-between pt-4 border-t border-gray-200\">\n                  <span className=\"text-lg font-bold text-gray-900\">Total</span>\n                  <span className=\"text-2xl font-bold text-blue-600\">{formatCurrency(quote.total)}</span>\n                </div>\n                <p className=\"text-xs text-gray-500 text-right\">USD / ano</p>\n\n                {/* Actions */}\n                {!createdQuoteId ? (\n                  <button\n                    onClick={handleCreateQuote}\n                    disabled={isCreating || quote.subtotal === 0}\n                    className=\"w-full py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                  >\n                    {isCreating ? (\n                      <>\n                        <SovraLoader size=\"sm\" className=\"!w-4 !h-4 text-white\" />\n                        Generando...\n                      </>\n                    ) : (\n                      <>\n                        <FileText className=\"w-5 h-5\" />\n                        Crear Cotizacion\n                      </>\n                    )}\n                  </button>\n                ) : (\n                  <div className=\"space-y-3\">\n                    <div className=\"bg-green-50 border border-green-200 rounded-lg p-3 text-center\">\n                      <Check className=\"w-6 h-6 text-green-600 mx-auto mb-1\" />\n                      <p className=\"text-sm font-medium text-green-800\">Cotizacion creada</p>\n                    </div>\n                    <button\n                      onClick={handleDownloadPDF}\n                      className=\"w-full py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 flex items-center justify-center gap-2\"\n                    >\n                      <Download className=\"w-5 h-5\" />\n                      Descargar PDF\n                    </button>\n                    <button\n                      onClick={() => router.push(`/${locale}/partners/portal/deals/${deal.id}`)}\n                      className=\"w-full py-2 px-4 text-gray-600 hover:text-gray-800 text-sm\"\n                    >\n                      Volver al deal\n                    </button>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import type { PricingConfig, PartnerTier, QuoteProducts, QuoteServices, QuoteDiscounts, SovraIdPlan } from '@/types';\n\nexport interface CalculatePriceParams {\n  population: number;\n  sovraGovIncluded: boolean;\n  sovraIdIncluded: boolean;\n  sovraIdPlan: SovraIdPlan;\n  walletImplementation: boolean;\n  integrationHours: number;\n  partnerTier: PartnerTier;\n  partnerGeneratedLead: boolean;\n}\n\nexport interface CalculatedQuote {\n  products: QuoteProducts;\n  services: QuoteServices;\n  discounts: QuoteDiscounts;\n  subtotal: number;\n  totalDiscount: number;\n  total: number;\n}\n\nexport function getSovraGovPricePerInhabitant(population: number, config: PricingConfig): number {\n  // Find the appropriate tier based on population\n  const sortedTiers = [...config.sovraGov.tiers].sort((a, b) => a.maxPopulation - b.maxPopulation);\n\n  for (const tier of sortedTiers) {\n    if (population <= tier.maxPopulation) {\n      return tier.pricePerInhabitant;\n    }\n  }\n\n  // If population exceeds all tiers, use the last (largest) tier's price\n  return sortedTiers[sortedTiers.length - 1]?.pricePerInhabitant || 0.13;\n}\n\nexport function calculateSovraGovPrice(population: number, config: PricingConfig): { pricePerInhabitant: number; annualPrice: number } {\n  const pricePerInhabitant = getSovraGovPricePerInhabitant(population, config);\n  const annualPrice = population * pricePerInhabitant;\n\n  return { pricePerInhabitant, annualPrice };\n}\n\nexport function calculateSovraIdPrice(plan: SovraIdPlan, config: PricingConfig): { monthlyLimit: number; monthlyPrice: number; annualPrice: number } {\n  const planConfig = config.sovraId[plan];\n\n  return {\n    monthlyLimit: planConfig.monthlyLimit,\n    monthlyPrice: planConfig.monthlyPrice,\n    annualPrice: planConfig.monthlyPrice * 12,\n  };\n}\n\nexport function calculateDiscounts(\n  partnerTier: PartnerTier,\n  partnerGeneratedLead: boolean,\n  config: PricingConfig\n): { basePercent: number; leadBonus: number; totalPercent: number } {\n  const tierConfig = config.discounts[partnerTier];\n\n  const basePercent = tierConfig.base;\n  const leadBonus = partnerGeneratedLead ? tierConfig.leadBonus : 0;\n  const totalPercent = basePercent + leadBonus;\n\n  return { basePercent, leadBonus, totalPercent };\n}\n\nexport function calculateQuote(params: CalculatePriceParams, config: PricingConfig): CalculatedQuote {\n  // Calculate SovraGov\n  const sovraGovCalc = calculateSovraGovPrice(params.population, config);\n  const sovraGovAnnual = params.sovraGovIncluded ? sovraGovCalc.annualPrice : 0;\n\n  // Calculate SovraID\n  const sovraIdCalc = calculateSovraIdPrice(params.sovraIdPlan, config);\n  const sovraIdAnnual = params.sovraIdIncluded ? sovraIdCalc.annualPrice : 0;\n\n  // Calculate Services\n  const walletPrice = params.walletImplementation ? config.services.walletImplementation : 0;\n  const integrationTotal = params.integrationHours * config.services.integrationHourlyRate;\n\n  // Products\n  const products: QuoteProducts = {\n    sovraGov: {\n      included: params.sovraGovIncluded,\n      populationUsed: params.population,\n      pricePerInhabitant: sovraGovCalc.pricePerInhabitant,\n      annualPrice: params.sovraGovIncluded ? sovraGovCalc.annualPrice : 0,\n    },\n    sovraId: {\n      included: params.sovraIdIncluded,\n      plan: params.sovraIdPlan,\n      monthlyLimit: sovraIdCalc.monthlyLimit,\n      monthlyPrice: sovraIdCalc.monthlyPrice,\n      annualPrice: params.sovraIdIncluded ? sovraIdCalc.annualPrice : 0,\n    },\n  };\n\n  // Services\n  const services: QuoteServices = {\n    walletImplementation: params.walletImplementation,\n    walletPrice,\n    integrationHours: params.integrationHours,\n    integrationPricePerHour: config.services.integrationHourlyRate,\n    integrationTotal,\n  };\n\n  // Subtotal\n  const subtotal = sovraGovAnnual + sovraIdAnnual + walletPrice + integrationTotal;\n\n  // Discounts\n  const discountCalc = calculateDiscounts(params.partnerTier, params.partnerGeneratedLead, config);\n  const discountAmount = subtotal * (discountCalc.totalPercent / 100);\n\n  const discounts: QuoteDiscounts = {\n    partnerTier: params.partnerTier,\n    partnerGeneratedLead: params.partnerGeneratedLead,\n    baseDiscountPercent: discountCalc.basePercent,\n    leadBonusPercent: discountCalc.leadBonus,\n    totalDiscountPercent: discountCalc.totalPercent,\n    discountAmount,\n  };\n\n  // Total\n  const total = subtotal - discountAmount;\n\n  return {\n    products,\n    services,\n    discounts,\n    subtotal,\n    totalDiscount: discountAmount,\n    total,\n  };\n}\n\nexport function formatCurrency(amount: number): string {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 2,\n  }).format(amount);\n}\n\nexport function formatPopulation(population: number): string {\n  if (population >= 1000000) {\n    return `${(population / 1000000).toFixed(1)}M`;\n  }\n  if (population >= 1000) {\n    return `${(population / 1000).toFixed(0)}K`;\n  }\n  return population.toLocaleString();\n}\n"],"names":[],"mappings":"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"}