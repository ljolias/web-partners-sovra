module.exports=[72284,a=>{"use strict";let b=(0,a.i(53659).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],72284)},57038,a=>{"use strict";var b=a.i(34076),c=a.i(88972),d=a.i(53440),e=a.i(24321),f=a.i(76469),g=a.i(82840),h=a.i(72284),i=a.i(95201),j=a.i(32777),k=a.i(26464),l=a.i(38617),m=a.i(78551),n=a.i(10680),o=a.i(92032),p=a.i(76197);a.i(96149);var q=a.i(68956),r=a.i(6373),s=a.i(45968),t=a.i(41165),u=a.i(80801),v=a.i(37474);function w({params:a}){let{locale:w,documentId:x}=(0,c.use)(a),y=(0,d.useTranslations)("legal"),z=(0,e.useRouter)(),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(null);(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/partners/auth/me");if(!a.ok)return void z.replace(`/${w}/partners/login`);let b=(await a.json()).user;if(!(0,u.hasPermission)(b.role,"legal:view"))return void z.replace(`/${w}/partners/portal`);H(!0);let c=await fetch(`/api/partners/legal/${x}`);if(!c.ok){if(404===c.status)return void z.replace(`/${w}/partners/portal/legal`);throw Error("Failed to fetch document")}let d=await c.json();B(d.document),D(d.auditEvents||[])}catch(a){console.error("Failed to fetch document:",a)}finally{F(!1)}}()},[w,x,z]);let I=a=>new Date(a).toLocaleDateString("es"===w?"es-ES":"pt"===w?"pt-BR":"en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),J=a=>new Date(a).toLocaleDateString("es"===w?"es-ES":"pt"===w?"pt-BR":"en-US",{year:"numeric",month:"short",day:"numeric"}),K=async()=>{if(A)try{let a=await fetch(`/api/partners/legal/${x}/download`);if(a.ok){let b=await a.blob(),c=window.URL.createObjectURL(b),d=window.document.createElement("a");d.href=c,d.download=A.uploadMetadata?.fileName||`${A.title}.pdf`,window.document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),window.document.body.removeChild(d)}}catch(a){console.error("Failed to download document:",a)}},L=async()=>{if(A&&"docusign"===A.type)try{let a=await fetch(`/api/partners/legal/${x}/download?type=certificate`);if(a.ok){let b=await a.blob(),c=window.URL.createObjectURL(b),d=window.document.createElement("a");d.href=c,d.download=`${A.title}_certificate.pdf`,window.document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),window.document.body.removeChild(d)}}catch(a){console.error("Failed to download certificate:",a)}};return E||null===G?(0,b.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,b.jsx)(t.SovraLoader,{size:"md",className:"text-[var(--color-primary)]"})}):G&&A?("pending_signature"===A.status||A.status,(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(g.default,{href:`/${w}/partners/portal/legal`,className:"p-2 rounded-lg hover:bg-[var(--color-surface-hover)] transition-colors",children:(0,b.jsx)(h.ArrowLeft,{className:"h-5 w-5 text-[var(--color-text-secondary)]"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-[var(--color-text-primary)]",children:A.title}),A.version>1&&(0,b.jsxs)("span",{className:"text-sm text-[var(--color-text-secondary)]",children:["v",A.version]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(q.Button,{variant:"outline",onClick:K,children:[(0,b.jsx)(i.Download,{className:"h-4 w-4 mr-2"}),y("downloadDocument")]}),"docusign"===A.type&&"active"===A.status&&(0,b.jsxs)(q.Button,{variant:"outline",onClick:L,children:[(0,b.jsx)(j.Shield,{className:"h-4 w-4 mr-2"}),y("downloadCertificate")]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsx)(s.Card,{children:(0,b.jsxs)(s.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)(r.Badge,{variant:"active"===A.status?"success":"pending_signature"===A.status?"warning":"secondary",children:y(`status.${A.status}`)}),(0,b.jsx)(r.Badge,{variant:"outline",children:y(`categories.${A.category}`)}),"docusign"===A.type&&(0,b.jsx)(r.Badge,{variant:"outline",children:"DocuSign"})]}),A.description&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-[var(--color-text-primary)] mb-1",children:y("description")}),(0,b.jsx)("p",{className:"text-sm text-[var(--color-text-secondary)]",children:A.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[A.effectiveDate&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] mb-1",children:[(0,b.jsx)(p.Calendar,{className:"h-4 w-4"}),y("effectiveDate")]}),(0,b.jsx)("p",{className:"text-sm font-medium text-[var(--color-text-primary)]",children:J(A.effectiveDate)})]}),A.expirationDate&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] mb-1",children:[(0,b.jsx)(p.Calendar,{className:"h-4 w-4"}),y("expirationDate")]}),(0,b.jsx)("p",{className:(0,v.cn)("text-sm font-medium",new Date(A.expirationDate)<new Date?"text-red-500":"text-[var(--color-text-primary)]"),children:J(A.expirationDate)})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] mb-1",children:[(0,b.jsx)(o.User,{className:"h-4 w-4"}),y("createdBy")]}),(0,b.jsx)("p",{className:"text-sm font-medium text-[var(--color-text-primary)]",children:A.createdByName||y("unknown")})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] mb-1",children:[(0,b.jsx)(p.Calendar,{className:"h-4 w-4"}),y("createdAt")]}),(0,b.jsx)("p",{className:"text-sm font-medium text-[var(--color-text-primary)]",children:J(A.createdAt)})]})]})]})}),"docusign"===A.type&&A.docusignMetadata?.signers&&(0,b.jsx)(s.Card,{children:(0,b.jsxs)(s.CardContent,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)] mb-4",children:y("signatures")}),(0,b.jsx)("div",{className:"space-y-3",children:A.docusignMetadata.signers.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-[var(--color-bg)] rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-full bg-[var(--color-primary)]/10 flex items-center justify-center",children:(0,b.jsx)(o.User,{className:"h-5 w-5 text-[var(--color-primary)]"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-[var(--color-text-primary)]",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-[var(--color-text-secondary)]",children:["sovra"===a.role?"Sovra":y("partner")," - ",a.email]})]})]}),(0,b.jsx)("div",{className:"text-right",children:"signed"===a.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Badge,{variant:"success",children:y("signed")}),a.signedAt&&(0,b.jsx)("p",{className:"text-xs text-[var(--color-text-secondary)] mt-1",children:I(a.signedAt)})]}):"declined"===a.status?(0,b.jsx)(r.Badge,{variant:"destructive",children:y("declined")}):(0,b.jsx)(r.Badge,{variant:"warning",children:y("pending")})})]},c))})]})}),"upload"===A.type&&A.uploadMetadata&&(0,b.jsx)(s.Card,{children:(0,b.jsxs)(s.CardContent,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)] mb-4",children:y("fileInfo")}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between py-2 border-b border-[var(--color-border)]",children:[(0,b.jsx)("span",{className:"text-sm text-[var(--color-text-secondary)]",children:y("fileName")}),(0,b.jsx)("span",{className:"text-sm font-medium text-[var(--color-text-primary)]",children:A.uploadMetadata.fileName})]}),(0,b.jsxs)("div",{className:"flex justify-between py-2 border-b border-[var(--color-border)]",children:[(0,b.jsx)("span",{className:"text-sm text-[var(--color-text-secondary)]",children:y("uploadedBy")}),(0,b.jsx)("span",{className:"text-sm font-medium text-[var(--color-text-primary)]",children:A.uploadMetadata.uploadedByName})]}),A.uploadMetadata.verificationStatus&&(0,b.jsxs)("div",{className:"flex justify-between py-2",children:[(0,b.jsx)("span",{className:"text-sm text-[var(--color-text-secondary)]",children:y("verification")}),(0,b.jsx)(r.Badge,{variant:"verified"===A.uploadMetadata.verificationStatus?"success":"rejected"===A.uploadMetadata.verificationStatus?"destructive":"warning",children:y(`verificationStatus.${A.uploadMetadata.verificationStatus}`)})]})]})]})})]}),(0,b.jsx)("div",{children:(0,b.jsx)(s.Card,{children:(0,b.jsxs)(s.CardContent,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)] mb-4",children:y("history")}),C.length>0?(0,b.jsx)("div",{className:"space-y-4",children:C.map(a=>{let c=(a=>{switch(a){case"created":case"uploaded":default:return k.FileText;case"signed":return l.CheckCircle;case"sent_for_signature":return m.Clock;case"declined":case"rejected":return n.AlertTriangle;case"verified":return j.Shield}})(a.action);return(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-[var(--color-surface-hover)] flex items-center justify-center",children:(0,b.jsx)(c,{className:"h-4 w-4 text-[var(--color-text-secondary)]"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm text-[var(--color-text-primary)]",children:y(`auditActions.${a.action}`)}),a.actorName&&(0,b.jsx)("p",{className:"text-xs text-[var(--color-text-secondary)]",children:a.actorName}),(0,b.jsx)("p",{className:"text-xs text-[var(--color-text-secondary)]",children:I(a.timestamp)})]})]},a.id)})}):(0,b.jsx)("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"No history available"})]})})})]})]})):null}a.s(["default",()=>w])}];

//# sourceMappingURL=_d412d9ab._.js.map