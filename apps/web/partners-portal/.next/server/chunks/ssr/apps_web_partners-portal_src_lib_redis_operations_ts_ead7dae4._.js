module.exports=[13152,9358,15122,a=>{"use strict";let b,c;var d=a.i(66680);let e=d.default.webcrypto?.subtle||{};var f=Object.defineProperty,g={},h={UpstashError:()=>j,UpstashJSONParseError:()=>l,UrlError:()=>k};for(var i in h)f(g,i,{get:h[i],enumerable:!0});var j=class extends Error{constructor(a,b){super(a,b),this.name="UpstashError"}},k=class extends Error{constructor(a){super(`Upstash Redis client was passed an invalid URL. You should pass a URL starting with https. Received: "${a}". `),this.name="UrlError"}},l=class extends j{constructor(a,b){const c=a.length>200?a.slice(0,200)+"...":a;super(`Unable to parse response body: ${c}`,b),this.name="UpstashJSONParseError"}};function m(a){try{return function a(b){let c=Array.isArray(b)?b.map(b=>{try{return a(b)}catch{return b}}):JSON.parse(b);return"number"==typeof c&&c.toString()!==b?b:c}(a)}catch{return a}}function n(a){return[a[0],...m(a.slice(1))]}function o(a){let[b,c]=a,d=[];for(let a=0;a<c.length;a+=2)d.push({key:c[a],type:c[a+1]});return[b,d]}function p(a){if("object"==typeof a&&null!==a&&!Array.isArray(a))return a;if(!Array.isArray(a))return{};let b={};for(let c=0;c<a.length;c+=2)"string"==typeof a[c]&&(b[a[c]]=a[c+1]);return b}var q=class{baseUrl;headers;options;readYourWrites;upstashSyncToken="";hasCredentials;retry;constructor(a){if(this.options={backend:a.options?.backend,agent:a.agent,responseEncoding:a.responseEncoding??"base64",cache:a.cache,signal:a.signal,keepAlive:a.keepAlive??!0},this.upstashSyncToken="",this.readYourWrites=a.readYourWrites??!0,this.baseUrl=(a.baseUrl||"").replace(/\/$/,""),this.baseUrl&&!/^https?:\/\/[^\s#$./?].\S*$/.test(this.baseUrl))throw new k(this.baseUrl);this.headers={"Content-Type":"application/json",...a.headers},this.hasCredentials=!!(this.baseUrl&&this.headers.authorization.split(" ")[1]),"base64"===this.options.responseEncoding&&(this.headers["Upstash-Encoding"]="base64"),this.retry="boolean"!=typeof a.retry||a.retry?{attempts:a.retry?.retries??5,backoff:a.retry?.backoff??(a=>50*Math.exp(a))}:{attempts:1,backoff:()=>0}}mergeTelemetry(a){this.headers=t(this.headers,"Upstash-Telemetry-Runtime",a.runtime),this.headers=t(this.headers,"Upstash-Telemetry-Platform",a.platform),this.headers=t(this.headers,"Upstash-Telemetry-Sdk",a.sdk)}async request(a){let b,c=function(...a){let b={};for(let c of a)if(c)for(let[a,d]of Object.entries(c))null!=d&&(b[a]=d);return b}(this.headers,a.headers??{}),d=[this.baseUrl,...a.path??[]].join("/"),e="text/event-stream"===c.Accept,f=a.signal??this.options.signal,g="function"==typeof f,h={cache:this.options.cache,method:"POST",headers:c,body:JSON.stringify(a.body),keepalive:this.options.keepAlive,agent:this.options.agent,signal:g?f():f,backend:this.options.backend};if(this.hasCredentials||console.warn("[Upstash Redis] Redis client was initialized without url or token. Failed to execute command."),this.readYourWrites){let a=this.upstashSyncToken;this.headers["upstash-sync-token"]=a}let i=null,k=null;for(let a=0;a<=this.retry.attempts;a++)try{i=await fetch(d,h);break}catch(b){if(h.signal?.aborted&&g)throw b;if(h.signal?.aborted){i=new Response(new Blob([JSON.stringify({result:h.signal.reason??"Aborted"})]),{status:200,statusText:h.signal.reason??"Aborted"});break}k=b,a<this.retry.attempts&&await new Promise(b=>setTimeout(b,this.retry.backoff(a)))}if(!i)throw k??Error("Exhausted all retries");if(!i.ok){let b,c=await i.text();try{b=JSON.parse(c)}catch(a){throw new l(c,{cause:a})}throw new j(`${b.error}, command was: ${JSON.stringify(a.body)}`)}if(this.readYourWrites){let a=i.headers;this.upstashSyncToken=a.get("upstash-sync-token")??""}if(e&&a&&a.onMessage&&i.body){let b=i.body.getReader(),c=new TextDecoder;return(async()=>{try{let d="";for(;;){let{value:e,done:f}=await b.read();if(f)break;let g=(d+=c.decode(e,{stream:!0})).split("\n");if((d=g.pop()||"").length>1048576)throw Error("Buffer size exceeded (1MB)");for(let b of g)if(b.startsWith("data: ")){let c=b.slice(6);a.onMessage?.(c)}}}catch(a){a instanceof Error&&"AbortError"===a.name||console.error("Stream reading error:",a)}finally{try{await b.cancel()}catch{}}})(),{result:1}}let m=await i.text();try{b=JSON.parse(m)}catch(a){throw new l(m,{cause:a})}if(this.readYourWrites){let a=i.headers;this.upstashSyncToken=a.get("upstash-sync-token")??""}return"base64"===this.options.responseEncoding?Array.isArray(b)?b.map(({result:a,error:b})=>({result:s(a),error:b})):{result:s(b.result),error:b.error}:b}};function r(a){let b="";try{let c=atob(a),d=c.length,e=new Uint8Array(d);for(let a=0;a<d;a++)e[a]=c.charCodeAt(a);b=new TextDecoder().decode(e)}catch{b=a}return b}function s(a){let b;switch(typeof a){case"undefined":return a;case"number":b=a;break;case"object":b=Array.isArray(a)?a.map(a=>"string"==typeof a?r(a):Array.isArray(a)?a.map(a=>s(a)):a):null;break;case"string":b="OK"===a?"OK":r(a)}return b}function t(a,b,c){return c&&(a[b]=a[b]?[a[b],c].join(","):c),a}var u=a=>{switch(typeof a){case"string":case"number":case"boolean":return a;default:return JSON.stringify(a)}},v=class{command;serialize;deserialize;headers;path;onMessage;isStreaming;signal;constructor(a,b){if(this.serialize=u,this.deserialize=b?.automaticDeserialization===void 0||b.automaticDeserialization?b?.deserialize??m:a=>a,this.command=a.map(a=>this.serialize(a)),this.headers=b?.headers,this.path=b?.path,this.onMessage=b?.streamOptions?.onMessage,this.isStreaming=b?.streamOptions?.isStreaming??!1,this.signal=b?.streamOptions?.signal,b?.latencyLogging){const a=this.exec.bind(this);this.exec=async b=>{let c=performance.now(),d=await a(b),e=(performance.now()-c).toFixed(2);return console.log(`Latency for \x1b[38;2;19;185;39m${this.command[0].toString().toUpperCase()}\x1b[0m: \x1b[38;2;0;255;255m${e} ms\x1b[0m`),d}}}async exec(a){let{result:b,error:c}=await a.request({body:this.command,path:this.path,upstashSyncToken:a.upstashSyncToken,headers:this.headers,onMessage:this.onMessage,isStreaming:this.isStreaming,signal:this.signal});if(c)throw new j(c);if(void 0===b)throw TypeError("Request did not return a result");return this.deserialize(b)}},w=class extends v{constructor(a,b){const c=["hrandfield",a[0]];"number"==typeof a[1]&&c.push(a[1]),a[2]&&c.push("WITHVALUES"),super(c,{deserialize:a[2]?a=>(function(a){if(0===a.length)return null;let b={};for(let c=0;c<a.length;c+=2){let d=a[c],e=a[c+1];try{b[d]=JSON.parse(e)}catch{b[d]=e}}return b})(a):b?.deserialize,...b})}},x=class extends v{constructor(a,b){super(["append",...a],b)}},y=class extends v{constructor([a,b,c],d){const e=["bitcount",a];"number"==typeof b&&e.push(b),"number"==typeof c&&e.push(c),super(e,d)}},z=class{constructor(a,b,c,d=a=>a.exec(this.client)){this.client=b,this.opts=c,this.execOperation=d,this.command=["bitfield",...a]}command;chain(...a){return this.command.push(...a),this}get(...a){return this.chain("get",...a)}set(...a){return this.chain("set",...a)}incrby(...a){return this.chain("incrby",...a)}overflow(a){return this.chain("overflow",a)}exec(){let a=new v(this.command,this.opts);return this.execOperation(a)}},A=class extends v{constructor(a,b){super(["bitop",...a],b)}},B=class extends v{constructor(a,b){super(["bitpos",...a],b)}},C=class extends v{constructor([a,b],c){super(["CLIENT","SETINFO",a.toUpperCase(),b],c)}},D=class extends v{constructor([a,b,c],d){super(["COPY",a,b,...c?.replace?["REPLACE"]:[]],{...d,deserialize:a=>a>0?"COPIED":"NOT_COPIED"})}},E=class extends v{constructor(a){super(["dbsize"],a)}},F=class extends v{constructor(a,b){super(["decr",...a],b)}},G=class extends v{constructor(a,b){super(["decrby",...a],b)}},H=class extends v{constructor(a,b){super(["del",...a],b)}},I=class extends v{constructor(a,b){super(["echo",...a],b)}},J=class extends v{constructor([a,b,c],d){super(["eval_ro",a,b.length,...b,...c??[]],d)}},K=class extends v{constructor([a,b,c],d){super(["eval",a,b.length,...b,...c??[]],d)}},L=class extends v{constructor([a,b,c],d){super(["evalsha_ro",a,b.length,...b,...c??[]],d)}},M=class extends v{constructor([a,b,c],d){super(["evalsha",a,b.length,...b,...c??[]],d)}},N=class extends v{constructor(a,b){super(a.map(a=>"string"==typeof a?a:String(a)),b)}},O=class extends v{constructor(a,b){super(["exists",...a],b)}},P=class extends v{constructor(a,b){super(["expire",...a.filter(Boolean)],b)}},Q=class extends v{constructor(a,b){super(["expireat",...a],b)}},R=class extends v{constructor([a,b,c],d){super(["fcall",a,...b?[b.length,...b]:[0],...c??[]],d)}},S=class extends v{constructor([a,b,c],d){super(["fcall_ro",a,...b?[b.length,...b]:[0],...c??[]],d)}},T=class extends v{constructor(a,b){const c=["flushall"];a&&a.length>0&&a[0].async&&c.push("async"),super(c,b)}},U=class extends v{constructor([a],b){const c=["flushdb"];a?.async&&c.push("async"),super(c,b)}},V=class extends v{constructor([a],b){super(["function","delete",a],b)}},W=class extends v{constructor(a){super(["function","flush"],a)}},X=class extends v{constructor([a],b){const c=["function","list"];a?.libraryName&&c.push("libraryname",a.libraryName),a?.withCode&&c.push("withcode"),super(c,{deserialize:Y,...b})}};function Y(a){return Array.isArray(a)?a.map(a=>{let b=p(a),c=b.functions.map(a=>p(a));return{libraryName:b.library_name,engine:b.engine,functions:c.map(a=>({name:a.name,description:a.description??void 0,flags:a.flags})),libraryCode:b.library_code}}):[]}var Z=class extends v{constructor([a],b){super(["function","load",...a.replace?["replace"]:[],a.code],b)}},$=class extends v{constructor(a){super(["function","stats"],{deserialize:_,...a})}};function _(a){return{engines:Object.fromEntries(Object.entries(Object.fromEntries(Object.entries(p(p(a).engines)).map(([a,b])=>[a,p(b)]))).map(([a,b])=>[a,{librariesCount:b.libraries_count,functionsCount:b.functions_count}]))}}var aa=class extends v{constructor([a,b,...c],d){const e=["geoadd",a];"nx"in b&&b.nx?e.push("nx"):"xx"in b&&b.xx&&e.push("xx"),"ch"in b&&b.ch&&e.push("ch"),"latitude"in b&&b.latitude&&e.push(b.longitude,b.latitude,b.member),e.push(...c.flatMap(({latitude:a,longitude:b,member:c})=>[b,a,c])),super(e,d)}},ab=class extends v{constructor([a,b,c,d="M"],e){super(["GEODIST",a,b,c,d],e)}},ac=class extends v{constructor(a,b){const[c]=a;super(["GEOHASH",c,...Array.isArray(a[1])?a[1]:a.slice(1)],b)}},ad=class extends v{constructor(a,b){const[c]=a;super(["GEOPOS",c,...Array.isArray(a[1])?a[1]:a.slice(1)],{deserialize:a=>(function(a){let b=[];for(let c of a)c?.[0]&&c?.[1]&&b.push({lng:Number.parseFloat(c[0]),lat:Number.parseFloat(c[1])});return b})(a),...b})}},ae=class extends v{constructor([a,b,c,d,e],f){const g=["GEOSEARCH",a];("FROMMEMBER"===b.type||"frommember"===b.type)&&g.push(b.type,b.member),("FROMLONLAT"===b.type||"fromlonlat"===b.type)&&g.push(b.type,b.coordinate.lon,b.coordinate.lat),("BYRADIUS"===c.type||"byradius"===c.type)&&g.push(c.type,c.radius,c.radiusType),("BYBOX"===c.type||"bybox"===c.type)&&g.push(c.type,c.rect.width,c.rect.height,c.rectType),g.push(d),e?.count&&g.push("COUNT",e.count.limit,...e.count.any?["ANY"]:[]),super([...g,...e?.withCoord?["WITHCOORD"]:[],...e?.withDist?["WITHDIST"]:[],...e?.withHash?["WITHHASH"]:[]],{deserialize:a=>e?.withCoord||e?.withDist||e?.withHash?a.map(a=>{let b=1,c={};try{c.member=JSON.parse(a[0])}catch{c.member=a[0]}return e.withDist&&(c.dist=Number.parseFloat(a[b++])),e.withHash&&(c.hash=a[b++].toString()),e.withCoord&&(c.coord={long:Number.parseFloat(a[b][0]),lat:Number.parseFloat(a[b][1])}),c}):a.map(a=>{try{return{member:JSON.parse(a)}}catch{return{member:a}}}),...f})}},af=class extends v{constructor([a,b,c,d,e,f],g){const h=["GEOSEARCHSTORE",a,b];("FROMMEMBER"===c.type||"frommember"===c.type)&&h.push(c.type,c.member),("FROMLONLAT"===c.type||"fromlonlat"===c.type)&&h.push(c.type,c.coordinate.lon,c.coordinate.lat),("BYRADIUS"===d.type||"byradius"===d.type)&&h.push(d.type,d.radius,d.radiusType),("BYBOX"===d.type||"bybox"===d.type)&&h.push(d.type,d.rect.width,d.rect.height,d.rectType),h.push(e),f?.count&&h.push("COUNT",f.count.limit,...f.count.any?["ANY"]:[]),super([...h,...f?.storeDist?["STOREDIST"]:[]],g)}},ag=class extends v{constructor(a,b){super(["get",...a],b)}},ah=class extends v{constructor(a,b){super(["getbit",...a],b)}},ai=class extends v{constructor(a,b){super(["getdel",...a],b)}},aj=class extends v{constructor([a,b],c){const d=["getex",a];b&&("ex"in b&&"number"==typeof b.ex?d.push("ex",b.ex):"px"in b&&"number"==typeof b.px?d.push("px",b.px):"exat"in b&&"number"==typeof b.exat?d.push("exat",b.exat):"pxat"in b&&"number"==typeof b.pxat?d.push("pxat",b.pxat):"persist"in b&&b.persist&&d.push("persist")),super(d,c)}},ak=class extends v{constructor(a,b){super(["getrange",...a],b)}},al=class extends v{constructor(a,b){super(["getset",...a],b)}},am=class extends v{constructor(a,b){super(["hdel",...a],b)}},an=class extends v{constructor(a,b){super(["hexists",...a],b)}},ao=class extends v{constructor(a,b){const[c,d,e,f]=a,g=Array.isArray(d)?d:[d];super(["hexpire",c,e,...f?[f]:[],"FIELDS",g.length,...g],b)}},ap=class extends v{constructor(a,b){const[c,d,e,f]=a,g=Array.isArray(d)?d:[d];super(["hexpireat",c,e,...f?[f]:[],"FIELDS",g.length,...g],b)}},aq=class extends v{constructor(a,b){const[c,d]=a,e=Array.isArray(d)?d:[d];super(["hexpiretime",c,"FIELDS",e.length,...e],b)}},ar=class extends v{constructor(a,b){const[c,d]=a,e=Array.isArray(d)?d:[d];super(["hpersist",c,"FIELDS",e.length,...e],b)}},as=class extends v{constructor(a,b){const[c,d,e,f]=a,g=Array.isArray(d)?d:[d];super(["hpexpire",c,e,...f?[f]:[],"FIELDS",g.length,...g],b)}},at=class extends v{constructor(a,b){const[c,d,e,f]=a,g=Array.isArray(d)?d:[d];super(["hpexpireat",c,e,...f?[f]:[],"FIELDS",g.length,...g],b)}},au=class extends v{constructor(a,b){const[c,d]=a,e=Array.isArray(d)?d:[d];super(["hpexpiretime",c,"FIELDS",e.length,...e],b)}},av=class extends v{constructor(a,b){const[c,d]=a,e=Array.isArray(d)?d:[d];super(["hpttl",c,"FIELDS",e.length,...e],b)}},aw=class extends v{constructor(a,b){super(["hget",...a],b)}},ax=class extends v{constructor(a,b){super(["hgetall",...a],{deserialize:a=>(function(a){if(0===a.length)return null;let b={};for(let c=0;c<a.length;c+=2){let d=a[c],e=a[c+1];try{let a=!Number.isNaN(Number(e))&&!Number.isSafeInteger(Number(e));b[d]=a?e:JSON.parse(e)}catch{b[d]=e}}return b})(a),...b})}};function ay(a,b){if(b.every(a=>null===a))return null;let c={};for(let[d,e]of a.entries())try{c[e]=JSON.parse(b[d])}catch{c[e]=b[d]}return c}var az=class extends v{constructor([a,...b],c){super(["hmget",a,...b],{deserialize:a=>ay(b,a),...c})}},aA=class extends v{constructor([a,...b],c){super(["hgetdel",a,"FIELDS",b.length,...b],{deserialize:a=>ay(b.map(String),a),...c})}},aB=class extends v{constructor([a,b,...c],d){const e=["hgetex",a];"ex"in b&&"number"==typeof b.ex?e.push("EX",b.ex):"px"in b&&"number"==typeof b.px?e.push("PX",b.px):"exat"in b&&"number"==typeof b.exat?e.push("EXAT",b.exat):"pxat"in b&&"number"==typeof b.pxat?e.push("PXAT",b.pxat):"persist"in b&&b.persist&&e.push("PERSIST"),e.push("FIELDS",c.length,...c),super(e,{deserialize:a=>ay(c.map(String),a),...d})}},aC=class extends v{constructor(a,b){super(["hincrby",...a],b)}},aD=class extends v{constructor(a,b){super(["hincrbyfloat",...a],b)}},aE=class extends v{constructor([a],b){super(["hkeys",a],b)}},aF=class extends v{constructor(a,b){super(["hlen",...a],b)}},aG=class extends v{constructor([a,b],c){super(["hmset",a,...Object.entries(b).flatMap(([a,b])=>[a,b])],c)}},aH=class extends v{constructor([a,b,c],d){const e=["hscan",a,b];c?.match&&e.push("match",c.match),"number"==typeof c?.count&&e.push("count",c.count),super(e,{deserialize:n,...d})}},aI=class extends v{constructor([a,b],c){super(["hset",a,...Object.entries(b).flatMap(([a,b])=>[a,b])],c)}},aJ=class extends v{constructor([a,b,c],d){const e=["hsetex",a];b.conditional&&e.push(b.conditional.toUpperCase()),b.expiration&&("ex"in b.expiration&&"number"==typeof b.expiration.ex?e.push("EX",b.expiration.ex):"px"in b.expiration&&"number"==typeof b.expiration.px?e.push("PX",b.expiration.px):"exat"in b.expiration&&"number"==typeof b.expiration.exat?e.push("EXAT",b.expiration.exat):"pxat"in b.expiration&&"number"==typeof b.expiration.pxat?e.push("PXAT",b.expiration.pxat):"keepttl"in b.expiration&&b.expiration.keepttl&&e.push("KEEPTTL"));const f=Object.entries(c);for(const[a,b]of(e.push("FIELDS",f.length),f))e.push(a,b);super(e,d)}},aK=class extends v{constructor(a,b){super(["hsetnx",...a],b)}},aL=class extends v{constructor(a,b){super(["hstrlen",...a],b)}},aM=class extends v{constructor(a,b){const[c,d]=a,e=Array.isArray(d)?d:[d];super(["httl",c,"FIELDS",e.length,...e],b)}},aN=class extends v{constructor(a,b){super(["hvals",...a],b)}},aO=class extends v{constructor(a,b){super(["incr",...a],b)}},aP=class extends v{constructor(a,b){super(["incrby",...a],b)}},aQ=class extends v{constructor(a,b){super(["incrbyfloat",...a],b)}},aR=class extends v{constructor(a,b){super(["JSON.ARRAPPEND",...a],b)}},aS=class extends v{constructor(a,b){super(["JSON.ARRINDEX",...a],b)}},aT=class extends v{constructor(a,b){super(["JSON.ARRINSERT",...a],b)}},aU=class extends v{constructor(a,b){super(["JSON.ARRLEN",a[0],a[1]??"$"],b)}},aV=class extends v{constructor(a,b){super(["JSON.ARRPOP",...a],b)}},aW=class extends v{constructor(a,b){const c=a[1]??"$",d=a[2]??0,e=a[3]??0;super(["JSON.ARRTRIM",a[0],c,d,e],b)}},aX=class extends v{constructor(a,b){super(["JSON.CLEAR",...a],b)}},aY=class extends v{constructor(a,b){super(["JSON.DEL",...a],b)}},aZ=class extends v{constructor(a,b){super(["JSON.FORGET",...a],b)}},a$=class extends v{constructor(a,b){const c=["JSON.GET"];"string"==typeof a[1]?c.push(...a):(c.push(a[0]),a[1]&&(a[1].indent&&c.push("INDENT",a[1].indent),a[1].newline&&c.push("NEWLINE",a[1].newline),a[1].space&&c.push("SPACE",a[1].space)),c.push(...a.slice(2))),super(c,b)}},a_=class extends v{constructor(a,b){super(["JSON.MERGE",...a],b)}},a0=class extends v{constructor(a,b){super(["JSON.MGET",...a[0],a[1]],b)}},a1=class extends v{constructor(a,b){const c=["JSON.MSET"];for(const b of a)c.push(b.key,b.path,b.value);super(c,b)}},a2=class extends v{constructor(a,b){super(["JSON.NUMINCRBY",...a],b)}},a3=class extends v{constructor(a,b){super(["JSON.NUMMULTBY",...a],b)}},a4=class extends v{constructor(a,b){super(["JSON.OBJKEYS",...a],b)}},a5=class extends v{constructor(a,b){super(["JSON.OBJLEN",...a],b)}},a6=class extends v{constructor(a,b){super(["JSON.RESP",...a],b)}},a7=class extends v{constructor(a,b){const c=["JSON.SET",a[0],a[1],a[2]];a[3]&&(a[3].nx?c.push("NX"):a[3].xx&&c.push("XX")),super(c,b)}},a8=class extends v{constructor(a,b){super(["JSON.STRAPPEND",...a],b)}},a9=class extends v{constructor(a,b){super(["JSON.STRLEN",...a],b)}},ba=class extends v{constructor(a,b){super(["JSON.TOGGLE",...a],b)}},bb=class extends v{constructor(a,b){super(["JSON.TYPE",...a],b)}},bc=class extends v{constructor(a,b){super(["keys",...a],b)}},bd=class extends v{constructor(a,b){super(["lindex",...a],b)}},be=class extends v{constructor(a,b){super(["linsert",...a],b)}},bf=class extends v{constructor(a,b){super(["llen",...a],b)}},bg=class extends v{constructor(a,b){super(["lmove",...a],b)}},bh=class extends v{constructor(a,b){const[c,d,e,f]=a;super(["LMPOP",c,...d,e,...f?["COUNT",f]:[]],b)}},bi=class extends v{constructor(a,b){super(["lpop",...a],b)}},bj=class extends v{constructor(a,b){const c=["lpos",a[0],a[1]];"number"==typeof a[2]?.rank&&c.push("rank",a[2].rank),"number"==typeof a[2]?.count&&c.push("count",a[2].count),"number"==typeof a[2]?.maxLen&&c.push("maxLen",a[2].maxLen),super(c,b)}},bk=class extends v{constructor(a,b){super(["lpush",...a],b)}},bl=class extends v{constructor(a,b){super(["lpushx",...a],b)}},bm=class extends v{constructor(a,b){super(["lrange",...a],b)}},bn=class extends v{constructor(a,b){super(["lrem",...a],b)}},bo=class extends v{constructor(a,b){super(["lset",...a],b)}},bp=class extends v{constructor(a,b){super(["ltrim",...a],b)}},bq=class extends v{constructor(a,b){super(["mget",...Array.isArray(a[0])?a[0]:a],b)}},br=class extends v{constructor([a],b){super(["mset",...Object.entries(a).flatMap(([a,b])=>[a,b])],b)}},bs=class extends v{constructor([a],b){super(["msetnx",...Object.entries(a).flat()],b)}},bt=class extends v{constructor(a,b){super(["persist",...a],b)}},bu=class extends v{constructor(a,b){super(["pexpire",...a],b)}},bv=class extends v{constructor(a,b){super(["pexpireat",...a],b)}},bw=class extends v{constructor(a,b){super(["pfadd",...a],b)}},bx=class extends v{constructor(a,b){super(["pfcount",...a],b)}},by=class extends v{constructor(a,b){super(["pfmerge",...a],b)}},bz=class extends v{constructor(a,b){const c=["ping"];a?.[0]!==void 0&&c.push(a[0]),super(c,b)}},bA=class extends v{constructor(a,b){super(["psetex",...a],b)}},bB=class extends v{constructor(a,b){super(["pttl",...a],b)}},bC=class extends v{constructor(a,b){super(["publish",...a],b)}},bD=class extends v{constructor(a){super(["randomkey"],a)}},bE=class extends v{constructor(a,b){super(["rename",...a],b)}},bF=class extends v{constructor(a,b){super(["renamenx",...a],b)}},bG=class extends v{constructor(a,b){super(["rpop",...a],b)}},bH=class extends v{constructor(a,b){super(["rpush",...a],b)}},bI=class extends v{constructor(a,b){super(["rpushx",...a],b)}},bJ=class extends v{constructor(a,b){super(["sadd",...a],b)}},bK=class extends v{constructor([a,b],c){const d=["scan",a];b?.match&&d.push("match",b.match),"number"==typeof b?.count&&d.push("count",b.count),b&&"withType"in b&&!0===b.withType?d.push("withtype"):b&&"type"in b&&b.type&&b.type.length>0&&d.push("type",b.type),super(d,{deserialize:b?.withType?o:n,...c})}},bL=class extends v{constructor(a,b){super(["scard",...a],b)}},bM=class extends v{constructor(a,b){super(["script","exists",...a],{deserialize:a=>a,...b})}},bN=class extends v{constructor([a],b){const c=["script","flush"];a?.sync?c.push("sync"):a?.async&&c.push("async"),super(c,b)}},bO=class extends v{constructor(a,b){super(["script","load",...a],b)}},bP=class extends v{constructor(a,b){super(["sdiff",...a],b)}},bQ=class extends v{constructor(a,b){super(["sdiffstore",...a],b)}},bR=class extends v{constructor([a,b,c],d){const e=["set",a,b];c&&("nx"in c&&c.nx?e.push("nx"):"xx"in c&&c.xx&&e.push("xx"),"get"in c&&c.get&&e.push("get"),"ex"in c&&"number"==typeof c.ex?e.push("ex",c.ex):"px"in c&&"number"==typeof c.px?e.push("px",c.px):"exat"in c&&"number"==typeof c.exat?e.push("exat",c.exat):"pxat"in c&&"number"==typeof c.pxat?e.push("pxat",c.pxat):"keepTtl"in c&&c.keepTtl&&e.push("keepTtl")),super(e,d)}},bS=class extends v{constructor(a,b){super(["setbit",...a],b)}},bT=class extends v{constructor(a,b){super(["setex",...a],b)}},bU=class extends v{constructor(a,b){super(["setnx",...a],b)}},bV=class extends v{constructor(a,b){super(["setrange",...a],b)}},bW=class extends v{constructor(a,b){super(["sinter",...a],b)}},bX=class extends v{constructor(a,b){super(["sinterstore",...a],b)}},bY=class extends v{constructor(a,b){super(["sismember",...a],b)}},bZ=class extends v{constructor(a,b){super(["smembers",...a],b)}},b$=class extends v{constructor(a,b){super(["smismember",a[0],...a[1]],b)}},b_=class extends v{constructor(a,b){super(["smove",...a],b)}},b0=class extends v{constructor([a,b],c){const d=["spop",a];"number"==typeof b&&d.push(b),super(d,c)}},b1=class extends v{constructor([a,b],c){const d=["srandmember",a];"number"==typeof b&&d.push(b),super(d,c)}},b2=class extends v{constructor(a,b){super(["srem",...a],b)}},b3=class extends v{constructor([a,b,c],d){const e=["sscan",a,b];c?.match&&e.push("match",c.match),"number"==typeof c?.count&&e.push("count",c.count),super(e,{deserialize:n,...d})}},b4=class extends v{constructor(a,b){super(["strlen",...a],b)}},b5=class extends v{constructor(a,b){super(["sunion",...a],b)}},b6=class extends v{constructor(a,b){super(["sunionstore",...a],b)}},b7=class extends v{constructor(a){super(["time"],a)}},b8=class extends v{constructor(a,b){super(["touch",...a],b)}},b9=class extends v{constructor(a,b){super(["ttl",...a],b)}},ca=class extends v{constructor(a,b){super(["type",...a],b)}},cb=class extends v{constructor(a,b){super(["unlink",...a],b)}},cc=class extends v{constructor([a,b,c],d){super(["XACK",a,b,...Array.isArray(c)?[...c]:[c]],d)}},cd=class extends v{constructor([a,b,c,...d],e){const f=["XACKDEL",a,b];f.push(c.toUpperCase()),f.push("IDS",d.length,...d),super(f,e)}},ce=class extends v{constructor([a,b,c,d],e){const f=["XADD",a];for(const[a,e]of(d&&(d.nomkStream&&f.push("NOMKSTREAM"),d.trim&&(f.push(d.trim.type,d.trim.comparison,d.trim.threshold),void 0!==d.trim.limit&&f.push("LIMIT",d.trim.limit))),f.push(b),Object.entries(c)))f.push(a,e);super(f,e)}},cf=class extends v{constructor([a,b,c,d,e,f],g){const h=[];f?.count&&h.push("COUNT",f.count),f?.justId&&h.push("JUSTID"),super(["XAUTOCLAIM",a,b,c,d,e,...h],g)}},cg=class extends v{constructor([a,b,c,d,e,f],g){const h=Array.isArray(e)?[...e]:[e],i=[];f?.idleMS&&i.push("IDLE",f.idleMS),f?.idleMS&&i.push("TIME",f.timeMS),f?.retryCount&&i.push("RETRYCOUNT",f.retryCount),f?.force&&i.push("FORCE"),f?.justId&&i.push("JUSTID"),f?.lastId&&i.push("LASTID",f.lastId),super(["XCLAIM",a,b,c,d,...h,...i],g)}},ch=class extends v{constructor([a,b],c){super(["XDEL",a,...Array.isArray(b)?[...b]:[b]],c)}},ci=class extends v{constructor([a,b,...c],d){const e=["XDELEX",a];b&&e.push(b.toUpperCase()),e.push("IDS",c.length,...c),super(e,d)}},cj=class extends v{constructor([a,b],c){const d=["XGROUP"];switch(b.type){case"CREATE":d.push("CREATE",a,b.group,b.id),b.options&&(b.options.MKSTREAM&&d.push("MKSTREAM"),void 0!==b.options.ENTRIESREAD&&d.push("ENTRIESREAD",b.options.ENTRIESREAD.toString()));break;case"CREATECONSUMER":d.push("CREATECONSUMER",a,b.group,b.consumer);break;case"DELCONSUMER":d.push("DELCONSUMER",a,b.group,b.consumer);break;case"DESTROY":d.push("DESTROY",a,b.group);break;case"SETID":d.push("SETID",a,b.group,b.id),b.options?.ENTRIESREAD!==void 0&&d.push("ENTRIESREAD",b.options.ENTRIESREAD.toString());break;default:throw Error("Invalid XGROUP")}super(d,c)}},ck=class extends v{constructor([a,b],c){const d=[];"CONSUMERS"===b.type?d.push("CONSUMERS",a,b.group):d.push("GROUPS",a),super(["XINFO",...d],c)}},cl=class extends v{constructor(a,b){super(["XLEN",...a],b)}},cm=class extends v{constructor([a,b,c,d,e,f],g){const h=f?.consumer===void 0?[]:Array.isArray(f.consumer)?[...f.consumer]:[f.consumer];super(["XPENDING",a,b,...f?.idleTime?["IDLE",f.idleTime]:[],c,d,e,...h],g)}},cn=class extends v{constructor([a,b,c,d],e){const f=["XRANGE",a,b,c];"number"==typeof d&&f.push("COUNT",d),super(f,{deserialize:a=>(function(a){let b={};for(let c of a)for(let a=0;a<c.length;a+=2){let d=c[a],e=c[a+1];d in b||(b[d]={});for(let a=0;a<e.length;a+=2){let c=e[a],f=e[a+1];try{b[d][c]=JSON.parse(f)}catch{b[d][c]=f}}}return b})(a),...e})}},co=class extends v{constructor([a,b,c],d){if(Array.isArray(a)&&Array.isArray(b)&&a.length!==b.length)throw Error("ERR Unbalanced XREAD list of streams: for each stream key an ID or '$' must be specified");const e=[];"number"==typeof c?.count&&e.push("COUNT",c.count),"number"==typeof c?.blockMS&&e.push("BLOCK",c.blockMS),e.push("STREAMS",...Array.isArray(a)?[...a]:[a],...Array.isArray(b)?[...b]:[b]),super(["XREAD",...e],d)}},cp=class extends v{constructor([a,b,c,d,e],f){if(Array.isArray(c)&&Array.isArray(d)&&c.length!==d.length)throw Error("ERR Unbalanced XREADGROUP list of streams: for each stream key an ID or '$' must be specified");const g=[];"number"==typeof e?.count&&g.push("COUNT",e.count),"number"==typeof e?.blockMS&&g.push("BLOCK",e.blockMS),"boolean"==typeof e?.NOACK&&e.NOACK&&g.push("NOACK"),g.push("STREAMS",...Array.isArray(c)?[...c]:[c],...Array.isArray(d)?[...d]:[d]),super(["XREADGROUP","GROUP",a,b,...g],f)}},cq=class extends v{constructor([a,b,c,d],e){const f=["XREVRANGE",a,b,c];"number"==typeof d&&f.push("COUNT",d),super(f,{deserialize:a=>(function(a){let b={};for(let c of a)for(let a=0;a<c.length;a+=2){let d=c[a],e=c[a+1];d in b||(b[d]={});for(let a=0;a<e.length;a+=2){let c=e[a],f=e[a+1];try{b[d][c]=JSON.parse(f)}catch{b[d][c]=f}}}return b})(a),...e})}},cr=class extends v{constructor([a,b],c){const{limit:d,strategy:e,threshold:f,exactness:g="~"}=b;super(["XTRIM",a,e,g,f,...d?["LIMIT",d]:[]],c)}},cs=class extends v{constructor([a,b,...c],d){const e=["zadd",a];"nx"in b&&b.nx?e.push("nx"):"xx"in b&&b.xx&&e.push("xx"),"ch"in b&&b.ch&&e.push("ch"),"incr"in b&&b.incr&&e.push("incr"),"lt"in b&&b.lt?e.push("lt"):"gt"in b&&b.gt&&e.push("gt"),"score"in b&&"member"in b&&e.push(b.score,b.member),e.push(...c.flatMap(({score:a,member:b})=>[a,b])),super(e,d)}},ct=class extends v{constructor(a,b){super(["zcard",...a],b)}},cu=class extends v{constructor(a,b){super(["zcount",...a],b)}},cv=class extends v{constructor(a,b){super(["zincrby",...a],b)}},cw=class extends v{constructor([a,b,c,d],e){const f=["zinterstore",a,b];Array.isArray(c)?f.push(...c):f.push(c),d&&("weights"in d&&d.weights?f.push("weights",...d.weights):"weight"in d&&"number"==typeof d.weight&&f.push("weights",d.weight),"aggregate"in d&&f.push("aggregate",d.aggregate)),super(f,e)}},cx=class extends v{constructor(a,b){super(["zlexcount",...a],b)}},cy=class extends v{constructor([a,b],c){const d=["zpopmax",a];"number"==typeof b&&d.push(b),super(d,c)}},cz=class extends v{constructor([a,b],c){const d=["zpopmin",a];"number"==typeof b&&d.push(b),super(d,c)}},cA=class extends v{constructor([a,b,c,d],e){const f=["zrange",a,b,c];d?.byScore&&f.push("byscore"),d?.byLex&&f.push("bylex"),d?.rev&&f.push("rev"),d?.count!==void 0&&void 0!==d.offset&&f.push("limit",d.offset,d.count),d?.withScores&&f.push("withscores"),super(f,e)}},cB=class extends v{constructor(a,b){super(["zrank",...a],b)}},cC=class extends v{constructor(a,b){super(["zrem",...a],b)}},cD=class extends v{constructor(a,b){super(["zremrangebylex",...a],b)}},cE=class extends v{constructor(a,b){super(["zremrangebyrank",...a],b)}},cF=class extends v{constructor(a,b){super(["zremrangebyscore",...a],b)}},cG=class extends v{constructor(a,b){super(["zrevrank",...a],b)}},cH=class extends v{constructor([a,b,c],d){const e=["zscan",a,b];c?.match&&e.push("match",c.match),"number"==typeof c?.count&&e.push("count",c.count),super(e,{deserialize:n,...d})}},cI=class extends v{constructor(a,b){super(["zscore",...a],b)}},cJ=class extends v{constructor([a,b,c],d){const e=["zunion",a];Array.isArray(b)?e.push(...b):e.push(b),c&&("weights"in c&&c.weights?e.push("weights",...c.weights):"weight"in c&&"number"==typeof c.weight&&e.push("weights",c.weight),"aggregate"in c&&e.push("aggregate",c.aggregate),c.withScores&&e.push("withscores")),super(e,d)}},cK=class extends v{constructor([a,b,c,d],e){const f=["zunionstore",a,b];Array.isArray(c)?f.push(...c):f.push(c),d&&("weights"in d&&d.weights?f.push("weights",...d.weights):"weight"in d&&"number"==typeof d.weight&&f.push("weights",d.weight),"aggregate"in d&&f.push("aggregate",d.aggregate)),super(f,e)}},cL=class extends v{constructor(a,b){super(["zdiffstore",...a],b)}},cM=class extends v{constructor(a,b){const[c,d]=a;super(["zmscore",c,...d],b)}},cN=class{client;commands;commandOptions;multiExec;constructor(a){if(this.client=a.client,this.commands=[],this.commandOptions=a.commandOptions,this.multiExec=a.multiExec??!1,this.commandOptions?.latencyLogging){const a=this.exec.bind(this);this.exec=async b=>{let c=performance.now(),d=await (b?a(b):a()),e=(performance.now()-c).toFixed(2);return console.log(`Latency for \x1b[38;2;19;185;39m${this.multiExec?["MULTI-EXEC"]:["PIPELINE"].toString().toUpperCase()}\x1b[0m: \x1b[38;2;0;255;255m${e} ms\x1b[0m`),d}}}exec=async a=>{if(0===this.commands.length)throw Error("Pipeline is empty");let b=this.multiExec?["multi-exec"]:["pipeline"],c=await this.client.request({path:b,body:Object.values(this.commands).map(a=>a.command)});return a?.keepErrors?c.map(({error:a,result:b},c)=>({error:a,result:this.commands[c].deserialize(b)})):c.map(({error:a,result:b},c)=>{if(a)throw new j(`Command ${c+1} [ ${this.commands[c].command[0]} ] failed: ${a}`);return this.commands[c].deserialize(b)})};length(){return this.commands.length}chain(a){return this.commands.push(a),this}append=(...a)=>this.chain(new x(a,this.commandOptions));bitcount=(...a)=>this.chain(new y(a,this.commandOptions));bitfield=(...a)=>new z(a,this.client,this.commandOptions,this.chain.bind(this));bitop=(a,b,c,...d)=>this.chain(new A([a,b,c,...d],this.commandOptions));bitpos=(...a)=>this.chain(new B(a,this.commandOptions));clientSetinfo=(...a)=>this.chain(new C(a,this.commandOptions));copy=(...a)=>this.chain(new D(a,this.commandOptions));zdiffstore=(...a)=>this.chain(new cL(a,this.commandOptions));dbsize=()=>this.chain(new E(this.commandOptions));decr=(...a)=>this.chain(new F(a,this.commandOptions));decrby=(...a)=>this.chain(new G(a,this.commandOptions));del=(...a)=>this.chain(new H(a,this.commandOptions));echo=(...a)=>this.chain(new I(a,this.commandOptions));evalRo=(...a)=>this.chain(new J(a,this.commandOptions));eval=(...a)=>this.chain(new K(a,this.commandOptions));evalshaRo=(...a)=>this.chain(new L(a,this.commandOptions));evalsha=(...a)=>this.chain(new M(a,this.commandOptions));exists=(...a)=>this.chain(new O(a,this.commandOptions));expire=(...a)=>this.chain(new P(a,this.commandOptions));expireat=(...a)=>this.chain(new Q(a,this.commandOptions));flushall=a=>this.chain(new T(a,this.commandOptions));flushdb=(...a)=>this.chain(new U(a,this.commandOptions));geoadd=(...a)=>this.chain(new aa(a,this.commandOptions));geodist=(...a)=>this.chain(new ab(a,this.commandOptions));geopos=(...a)=>this.chain(new ad(a,this.commandOptions));geohash=(...a)=>this.chain(new ac(a,this.commandOptions));geosearch=(...a)=>this.chain(new ae(a,this.commandOptions));geosearchstore=(...a)=>this.chain(new af(a,this.commandOptions));get=(...a)=>this.chain(new ag(a,this.commandOptions));getbit=(...a)=>this.chain(new ah(a,this.commandOptions));getdel=(...a)=>this.chain(new ai(a,this.commandOptions));getex=(...a)=>this.chain(new aj(a,this.commandOptions));getrange=(...a)=>this.chain(new ak(a,this.commandOptions));getset=(a,b)=>this.chain(new al([a,b],this.commandOptions));hdel=(...a)=>this.chain(new am(a,this.commandOptions));hexists=(...a)=>this.chain(new an(a,this.commandOptions));hexpire=(...a)=>this.chain(new ao(a,this.commandOptions));hexpireat=(...a)=>this.chain(new ap(a,this.commandOptions));hexpiretime=(...a)=>this.chain(new aq(a,this.commandOptions));httl=(...a)=>this.chain(new aM(a,this.commandOptions));hpexpire=(...a)=>this.chain(new as(a,this.commandOptions));hpexpireat=(...a)=>this.chain(new at(a,this.commandOptions));hpexpiretime=(...a)=>this.chain(new au(a,this.commandOptions));hpttl=(...a)=>this.chain(new av(a,this.commandOptions));hpersist=(...a)=>this.chain(new ar(a,this.commandOptions));hget=(...a)=>this.chain(new aw(a,this.commandOptions));hgetall=(...a)=>this.chain(new ax(a,this.commandOptions));hgetdel=(...a)=>this.chain(new aA(a,this.commandOptions));hgetex=(...a)=>this.chain(new aB(a,this.commandOptions));hincrby=(...a)=>this.chain(new aC(a,this.commandOptions));hincrbyfloat=(...a)=>this.chain(new aD(a,this.commandOptions));hkeys=(...a)=>this.chain(new aE(a,this.commandOptions));hlen=(...a)=>this.chain(new aF(a,this.commandOptions));hmget=(...a)=>this.chain(new az(a,this.commandOptions));hmset=(a,b)=>this.chain(new aG([a,b],this.commandOptions));hrandfield=(a,b,c)=>this.chain(new w([a,b,c],this.commandOptions));hscan=(...a)=>this.chain(new aH(a,this.commandOptions));hset=(a,b)=>this.chain(new aI([a,b],this.commandOptions));hsetex=(...a)=>this.chain(new aJ(a,this.commandOptions));hsetnx=(a,b,c)=>this.chain(new aK([a,b,c],this.commandOptions));hstrlen=(...a)=>this.chain(new aL(a,this.commandOptions));hvals=(...a)=>this.chain(new aN(a,this.commandOptions));incr=(...a)=>this.chain(new aO(a,this.commandOptions));incrby=(...a)=>this.chain(new aP(a,this.commandOptions));incrbyfloat=(...a)=>this.chain(new aQ(a,this.commandOptions));keys=(...a)=>this.chain(new bc(a,this.commandOptions));lindex=(...a)=>this.chain(new bd(a,this.commandOptions));linsert=(a,b,c,d)=>this.chain(new be([a,b,c,d],this.commandOptions));llen=(...a)=>this.chain(new bf(a,this.commandOptions));lmove=(...a)=>this.chain(new bg(a,this.commandOptions));lpop=(...a)=>this.chain(new bi(a,this.commandOptions));lmpop=(...a)=>this.chain(new bh(a,this.commandOptions));lpos=(...a)=>this.chain(new bj(a,this.commandOptions));lpush=(a,...b)=>this.chain(new bk([a,...b],this.commandOptions));lpushx=(a,...b)=>this.chain(new bl([a,...b],this.commandOptions));lrange=(...a)=>this.chain(new bm(a,this.commandOptions));lrem=(a,b,c)=>this.chain(new bn([a,b,c],this.commandOptions));lset=(a,b,c)=>this.chain(new bo([a,b,c],this.commandOptions));ltrim=(...a)=>this.chain(new bp(a,this.commandOptions));mget=(...a)=>this.chain(new bq(a,this.commandOptions));mset=a=>this.chain(new br([a],this.commandOptions));msetnx=a=>this.chain(new bs([a],this.commandOptions));persist=(...a)=>this.chain(new bt(a,this.commandOptions));pexpire=(...a)=>this.chain(new bu(a,this.commandOptions));pexpireat=(...a)=>this.chain(new bv(a,this.commandOptions));pfadd=(...a)=>this.chain(new bw(a,this.commandOptions));pfcount=(...a)=>this.chain(new bx(a,this.commandOptions));pfmerge=(...a)=>this.chain(new by(a,this.commandOptions));ping=a=>this.chain(new bz(a,this.commandOptions));psetex=(a,b,c)=>this.chain(new bA([a,b,c],this.commandOptions));pttl=(...a)=>this.chain(new bB(a,this.commandOptions));publish=(...a)=>this.chain(new bC(a,this.commandOptions));randomkey=()=>this.chain(new bD(this.commandOptions));rename=(...a)=>this.chain(new bE(a,this.commandOptions));renamenx=(...a)=>this.chain(new bF(a,this.commandOptions));rpop=(...a)=>this.chain(new bG(a,this.commandOptions));rpush=(a,...b)=>this.chain(new bH([a,...b],this.commandOptions));rpushx=(a,...b)=>this.chain(new bI([a,...b],this.commandOptions));sadd=(a,b,...c)=>this.chain(new bJ([a,b,...c],this.commandOptions));scan=(...a)=>this.chain(new bK(a,this.commandOptions));scard=(...a)=>this.chain(new bL(a,this.commandOptions));scriptExists=(...a)=>this.chain(new bM(a,this.commandOptions));scriptFlush=(...a)=>this.chain(new bN(a,this.commandOptions));scriptLoad=(...a)=>this.chain(new bO(a,this.commandOptions));sdiff=(...a)=>this.chain(new bP(a,this.commandOptions));sdiffstore=(...a)=>this.chain(new bQ(a,this.commandOptions));set=(a,b,c)=>this.chain(new bR([a,b,c],this.commandOptions));setbit=(...a)=>this.chain(new bS(a,this.commandOptions));setex=(a,b,c)=>this.chain(new bT([a,b,c],this.commandOptions));setnx=(a,b)=>this.chain(new bU([a,b],this.commandOptions));setrange=(...a)=>this.chain(new bV(a,this.commandOptions));sinter=(...a)=>this.chain(new bW(a,this.commandOptions));sinterstore=(...a)=>this.chain(new bX(a,this.commandOptions));sismember=(a,b)=>this.chain(new bY([a,b],this.commandOptions));smembers=(...a)=>this.chain(new bZ(a,this.commandOptions));smismember=(a,b)=>this.chain(new b$([a,b],this.commandOptions));smove=(a,b,c)=>this.chain(new b_([a,b,c],this.commandOptions));spop=(...a)=>this.chain(new b0(a,this.commandOptions));srandmember=(...a)=>this.chain(new b1(a,this.commandOptions));srem=(a,...b)=>this.chain(new b2([a,...b],this.commandOptions));sscan=(...a)=>this.chain(new b3(a,this.commandOptions));strlen=(...a)=>this.chain(new b4(a,this.commandOptions));sunion=(...a)=>this.chain(new b5(a,this.commandOptions));sunionstore=(...a)=>this.chain(new b6(a,this.commandOptions));time=()=>this.chain(new b7(this.commandOptions));touch=(...a)=>this.chain(new b8(a,this.commandOptions));ttl=(...a)=>this.chain(new b9(a,this.commandOptions));type=(...a)=>this.chain(new ca(a,this.commandOptions));unlink=(...a)=>this.chain(new cb(a,this.commandOptions));zadd=(...a)=>("score"in a[1],this.chain(new cs([a[0],a[1],...a.slice(2)],this.commandOptions)));xadd=(...a)=>this.chain(new ce(a,this.commandOptions));xack=(...a)=>this.chain(new cc(a,this.commandOptions));xackdel=(...a)=>this.chain(new cd(a,this.commandOptions));xdel=(...a)=>this.chain(new ch(a,this.commandOptions));xdelex=(...a)=>this.chain(new ci(a,this.commandOptions));xgroup=(...a)=>this.chain(new cj(a,this.commandOptions));xread=(...a)=>this.chain(new co(a,this.commandOptions));xreadgroup=(...a)=>this.chain(new cp(a,this.commandOptions));xinfo=(...a)=>this.chain(new ck(a,this.commandOptions));xlen=(...a)=>this.chain(new cl(a,this.commandOptions));xpending=(...a)=>this.chain(new cm(a,this.commandOptions));xclaim=(...a)=>this.chain(new cg(a,this.commandOptions));xautoclaim=(...a)=>this.chain(new cf(a,this.commandOptions));xtrim=(...a)=>this.chain(new cr(a,this.commandOptions));xrange=(...a)=>this.chain(new cn(a,this.commandOptions));xrevrange=(...a)=>this.chain(new cq(a,this.commandOptions));zcard=(...a)=>this.chain(new ct(a,this.commandOptions));zcount=(...a)=>this.chain(new cu(a,this.commandOptions));zincrby=(a,b,c)=>this.chain(new cv([a,b,c],this.commandOptions));zinterstore=(...a)=>this.chain(new cw(a,this.commandOptions));zlexcount=(...a)=>this.chain(new cx(a,this.commandOptions));zmscore=(...a)=>this.chain(new cM(a,this.commandOptions));zpopmax=(...a)=>this.chain(new cy(a,this.commandOptions));zpopmin=(...a)=>this.chain(new cz(a,this.commandOptions));zrange=(...a)=>this.chain(new cA(a,this.commandOptions));zrank=(a,b)=>this.chain(new cB([a,b],this.commandOptions));zrem=(a,...b)=>this.chain(new cC([a,...b],this.commandOptions));zremrangebylex=(...a)=>this.chain(new cD(a,this.commandOptions));zremrangebyrank=(...a)=>this.chain(new cE(a,this.commandOptions));zremrangebyscore=(...a)=>this.chain(new cF(a,this.commandOptions));zrevrank=(a,b)=>this.chain(new cG([a,b],this.commandOptions));zscan=(...a)=>this.chain(new cH(a,this.commandOptions));zscore=(a,b)=>this.chain(new cI([a,b],this.commandOptions));zunionstore=(...a)=>this.chain(new cK(a,this.commandOptions));zunion=(...a)=>this.chain(new cJ(a,this.commandOptions));get json(){return{arrappend:(...a)=>this.chain(new aR(a,this.commandOptions)),arrindex:(...a)=>this.chain(new aS(a,this.commandOptions)),arrinsert:(...a)=>this.chain(new aT(a,this.commandOptions)),arrlen:(...a)=>this.chain(new aU(a,this.commandOptions)),arrpop:(...a)=>this.chain(new aV(a,this.commandOptions)),arrtrim:(...a)=>this.chain(new aW(a,this.commandOptions)),clear:(...a)=>this.chain(new aX(a,this.commandOptions)),del:(...a)=>this.chain(new aY(a,this.commandOptions)),forget:(...a)=>this.chain(new aZ(a,this.commandOptions)),get:(...a)=>this.chain(new a$(a,this.commandOptions)),merge:(...a)=>this.chain(new a_(a,this.commandOptions)),mget:(...a)=>this.chain(new a0(a,this.commandOptions)),mset:(...a)=>this.chain(new a1(a,this.commandOptions)),numincrby:(...a)=>this.chain(new a2(a,this.commandOptions)),nummultby:(...a)=>this.chain(new a3(a,this.commandOptions)),objkeys:(...a)=>this.chain(new a4(a,this.commandOptions)),objlen:(...a)=>this.chain(new a5(a,this.commandOptions)),resp:(...a)=>this.chain(new a6(a,this.commandOptions)),set:(...a)=>this.chain(new a7(a,this.commandOptions)),strappend:(...a)=>this.chain(new a8(a,this.commandOptions)),strlen:(...a)=>this.chain(new a9(a,this.commandOptions)),toggle:(...a)=>this.chain(new ba(a,this.commandOptions)),type:(...a)=>this.chain(new bb(a,this.commandOptions))}}get functions(){return{load:(...a)=>this.chain(new Z(a,this.commandOptions)),list:(...a)=>this.chain(new X(a,this.commandOptions)),delete:(...a)=>this.chain(new V(a,this.commandOptions)),flush:()=>this.chain(new W(this.commandOptions)),stats:()=>this.chain(new $(this.commandOptions)),call:(...a)=>this.chain(new R(a,this.commandOptions)),callRo:(...a)=>this.chain(new S(a,this.commandOptions))}}},cO=new Set(["scan","keys","flushdb","flushall","dbsize","hscan","hgetall","hkeys","lrange","sscan","smembers","xrange","xrevrange","zscan","zrange","exec"]),cP=class{pipelinePromises=new WeakMap;activePipeline=null;indexInCurrentPipeline=0;redis;pipeline;pipelineCounter=0;constructor(a){this.redis=a,this.pipeline=a.pipeline()}async withAutoPipeline(a){let b=this.activePipeline??this.redis.pipeline();this.activePipeline||(this.activePipeline=b,this.indexInCurrentPipeline=0);let c=this.indexInCurrentPipeline++;a(b);let d=this.deferExecution().then(()=>{if(!this.pipelinePromises.has(b)){let a=b.exec({keepErrors:!0});this.pipelineCounter+=1,this.pipelinePromises.set(b,a),this.activePipeline=null}return this.pipelinePromises.get(b)}),e=(await d)[c];if(e.error)throw new j(`Command failed: ${e.error}`);return e.result}async deferExecution(){await Promise.resolve(),await Promise.resolve()}},cQ=class extends v{constructor(a,b){super([],{...b,headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"},path:["psubscribe",...a],streamOptions:{isStreaming:!0,onMessage:b?.streamOptions?.onMessage,signal:b?.streamOptions?.signal}})}},cR=class extends EventTarget{subscriptions;client;listeners;opts;constructor(a,b,c=!1,d){for(const e of(super(),this.client=a,this.subscriptions=new Map,this.listeners=new Map,this.opts=d,b))c?this.subscribeToPattern(e):this.subscribeToChannel(e)}subscribeToChannel(a){let b=new AbortController,c=new cS([a],{streamOptions:{signal:b.signal,onMessage:a=>this.handleMessage(a,!1)}});c.exec(this.client).catch(a=>{"AbortError"!==a.name&&this.dispatchToListeners("error",a)}),this.subscriptions.set(a,{command:c,controller:b,isPattern:!1})}subscribeToPattern(a){let b=new AbortController,c=new cQ([a],{streamOptions:{signal:b.signal,onMessage:a=>this.handleMessage(a,!0)}});c.exec(this.client).catch(a=>{"AbortError"!==a.name&&this.dispatchToListeners("error",a)}),this.subscriptions.set(a,{command:c,controller:b,isPattern:!0})}handleMessage(a,b){let c=a.replace(/^data:\s*/,""),d=c.indexOf(","),e=c.indexOf(",",d+1),f=b?c.indexOf(",",e+1):-1;if(-1!==d&&-1!==e){let a=c.slice(0,d);if(b&&"pmessage"===a&&-1!==f){let a=c.slice(d+1,e),b=c.slice(e+1,f),g=c.slice(f+1);try{let c=this.opts?.automaticDeserialization===!1?g:JSON.parse(g);this.dispatchToListeners("pmessage",{pattern:a,channel:b,message:c}),this.dispatchToListeners(`pmessage:${a}`,{pattern:a,channel:b,message:c})}catch(a){this.dispatchToListeners("error",Error(`Failed to parse message: ${a}`))}}else{let b=c.slice(d+1,e),f=c.slice(e+1);try{if("subscribe"===a||"psubscribe"===a||"unsubscribe"===a||"punsubscribe"===a){let b=Number.parseInt(f);this.dispatchToListeners(a,b)}else{let c=this.opts?.automaticDeserialization===!1?f:cT(f);this.dispatchToListeners(a,{channel:b,message:c}),this.dispatchToListeners(`${a}:${b}`,{channel:b,message:c})}}catch(a){this.dispatchToListeners("error",Error(`Failed to parse message: ${a}`))}}}}dispatchToListeners(a,b){let c=this.listeners.get(a);if(c)for(let a of c)a(b)}on(a,b){this.listeners.has(a)||this.listeners.set(a,new Set),this.listeners.get(a)?.add(b)}removeAllListeners(){this.listeners.clear()}async unsubscribe(a){if(a)for(let b of a){let a=this.subscriptions.get(b);if(a){try{a.controller.abort()}catch{}this.subscriptions.delete(b)}}else{for(let a of this.subscriptions.values())try{a.controller.abort()}catch{}this.subscriptions.clear(),this.removeAllListeners()}}getSubscribedChannels(){return[...this.subscriptions.keys()]}},cS=class extends v{constructor(a,b){super([],{...b,headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"},path:["subscribe",...a],streamOptions:{isStreaming:!0,onMessage:b?.streamOptions?.onMessage,signal:b?.streamOptions?.signal}})}},cT=a=>{try{return JSON.parse(a)}catch{return a}},cU=class{script;sha1;redis;constructor(a,b){this.redis=a,this.script=b,this.sha1="",this.init(b)}async init(a){this.sha1||(this.sha1=await this.digest(a))}async eval(a,b){return await this.init(this.script),await this.redis.eval(this.script,a,b)}async evalsha(a,b){return await this.init(this.script),await this.redis.evalsha(this.sha1,a,b)}async exec(a,b){return await this.init(this.script),await this.redis.evalsha(this.sha1,a,b).catch(async c=>{if(c instanceof Error&&c.message.toLowerCase().includes("noscript"))return await this.redis.eval(this.script,a,b);throw c})}async digest(a){let b=new TextEncoder().encode(a);return[...new Uint8Array(await e.digest("SHA-1",b))].map(a=>a.toString(16).padStart(2,"0")).join("")}},cV=class{script;sha1;redis;constructor(a,b){this.redis=a,this.sha1="",this.script=b,this.init(b)}async init(a){this.sha1||(this.sha1=await this.digest(a))}async evalRo(a,b){return await this.init(this.script),await this.redis.evalRo(this.script,a,b)}async evalshaRo(a,b){return await this.init(this.script),await this.redis.evalshaRo(this.sha1,a,b)}async exec(a,b){return await this.init(this.script),await this.redis.evalshaRo(this.sha1,a,b).catch(async c=>{if(c instanceof Error&&c.message.toLowerCase().includes("noscript"))return await this.redis.evalRo(this.script,a,b);throw c})}async digest(a){let b=new TextEncoder().encode(a);return[...new Uint8Array(await e.digest("SHA-1",b))].map(a=>a.toString(16).padStart(2,"0")).join("")}},cW=class{client;opts;enableTelemetry;enableAutoPipelining;constructor(a,b){this.client=a,this.opts=b,this.enableTelemetry=b?.enableTelemetry??!0,b?.readYourWrites===!1&&(this.client.readYourWrites=!1),this.enableAutoPipelining=b?.enableAutoPipelining??!0}get readYourWritesSyncToken(){return this.client.upstashSyncToken}set readYourWritesSyncToken(a){this.client.upstashSyncToken=a}get json(){return{arrappend:(...a)=>new aR(a,this.opts).exec(this.client),arrindex:(...a)=>new aS(a,this.opts).exec(this.client),arrinsert:(...a)=>new aT(a,this.opts).exec(this.client),arrlen:(...a)=>new aU(a,this.opts).exec(this.client),arrpop:(...a)=>new aV(a,this.opts).exec(this.client),arrtrim:(...a)=>new aW(a,this.opts).exec(this.client),clear:(...a)=>new aX(a,this.opts).exec(this.client),del:(...a)=>new aY(a,this.opts).exec(this.client),forget:(...a)=>new aZ(a,this.opts).exec(this.client),get:(...a)=>new a$(a,this.opts).exec(this.client),merge:(...a)=>new a_(a,this.opts).exec(this.client),mget:(...a)=>new a0(a,this.opts).exec(this.client),mset:(...a)=>new a1(a,this.opts).exec(this.client),numincrby:(...a)=>new a2(a,this.opts).exec(this.client),nummultby:(...a)=>new a3(a,this.opts).exec(this.client),objkeys:(...a)=>new a4(a,this.opts).exec(this.client),objlen:(...a)=>new a5(a,this.opts).exec(this.client),resp:(...a)=>new a6(a,this.opts).exec(this.client),set:(...a)=>new a7(a,this.opts).exec(this.client),strappend:(...a)=>new a8(a,this.opts).exec(this.client),strlen:(...a)=>new a9(a,this.opts).exec(this.client),toggle:(...a)=>new ba(a,this.opts).exec(this.client),type:(...a)=>new bb(a,this.opts).exec(this.client)}}get functions(){return{load:(...a)=>new Z(a,this.opts).exec(this.client),list:(...a)=>new X(a,this.opts).exec(this.client),delete:(...a)=>new V(a,this.opts).exec(this.client),flush:()=>new W(this.opts).exec(this.client),stats:()=>new $(this.opts).exec(this.client),call:(...a)=>new R(a,this.opts).exec(this.client),callRo:(...a)=>new S(a,this.opts).exec(this.client)}}use=a=>{let b=this.client.request.bind(this.client);this.client.request=c=>a(c,b)};addTelemetry=a=>{if(this.enableTelemetry)try{this.client.mergeTelemetry(a)}catch{}};createScript(a,b){return b?.readonly?new cV(this,a):new cU(this,a)}pipeline=()=>new cN({client:this.client,commandOptions:this.opts,multiExec:!1});autoPipeline=()=>(function a(b,c="root"){return b.autoPipelineExecutor||(b.autoPipelineExecutor=new cP(b)),new Proxy(b,{get:(b,d)=>{if("pipelineCounter"===d)return b.autoPipelineExecutor.pipelineCounter;if("root"===c&&"json"===d)return a(b,"json");if("root"===c&&"functions"===d)return a(b,"functions");if("root"===c){let a=d in b&&!(d in b.autoPipelineExecutor.pipeline),c=cO.has(d);if(a||c)return b[d]}let e=b.autoPipelineExecutor.pipeline,f="json"===c?e.json[d]:"functions"===c?e.functions[d]:e[d];return"function"==typeof f?(...a)=>b.autoPipelineExecutor.withAutoPipeline(b=>{("json"===c?b.json[d]:"functions"===c?b.functions[d]:b[d])(...a)}):f}})})(this);multi=()=>new cN({client:this.client,commandOptions:this.opts,multiExec:!0});bitfield=(...a)=>new z(a,this.client,this.opts);append=(...a)=>new x(a,this.opts).exec(this.client);bitcount=(...a)=>new y(a,this.opts).exec(this.client);bitop=(a,b,c,...d)=>new A([a,b,c,...d],this.opts).exec(this.client);bitpos=(...a)=>new B(a,this.opts).exec(this.client);clientSetinfo=(...a)=>new C(a,this.opts).exec(this.client);copy=(...a)=>new D(a,this.opts).exec(this.client);dbsize=()=>new E(this.opts).exec(this.client);decr=(...a)=>new F(a,this.opts).exec(this.client);decrby=(...a)=>new G(a,this.opts).exec(this.client);del=(...a)=>new H(a,this.opts).exec(this.client);echo=(...a)=>new I(a,this.opts).exec(this.client);evalRo=(...a)=>new J(a,this.opts).exec(this.client);eval=(...a)=>new K(a,this.opts).exec(this.client);evalshaRo=(...a)=>new L(a,this.opts).exec(this.client);evalsha=(...a)=>new M(a,this.opts).exec(this.client);exec=a=>new N(a,this.opts).exec(this.client);exists=(...a)=>new O(a,this.opts).exec(this.client);expire=(...a)=>new P(a,this.opts).exec(this.client);expireat=(...a)=>new Q(a,this.opts).exec(this.client);flushall=a=>new T(a,this.opts).exec(this.client);flushdb=(...a)=>new U(a,this.opts).exec(this.client);geoadd=(...a)=>new aa(a,this.opts).exec(this.client);geopos=(...a)=>new ad(a,this.opts).exec(this.client);geodist=(...a)=>new ab(a,this.opts).exec(this.client);geohash=(...a)=>new ac(a,this.opts).exec(this.client);geosearch=(...a)=>new ae(a,this.opts).exec(this.client);geosearchstore=(...a)=>new af(a,this.opts).exec(this.client);get=(...a)=>new ag(a,this.opts).exec(this.client);getbit=(...a)=>new ah(a,this.opts).exec(this.client);getdel=(...a)=>new ai(a,this.opts).exec(this.client);getex=(...a)=>new aj(a,this.opts).exec(this.client);getrange=(...a)=>new ak(a,this.opts).exec(this.client);getset=(a,b)=>new al([a,b],this.opts).exec(this.client);hdel=(...a)=>new am(a,this.opts).exec(this.client);hexists=(...a)=>new an(a,this.opts).exec(this.client);hexpire=(...a)=>new ao(a,this.opts).exec(this.client);hexpireat=(...a)=>new ap(a,this.opts).exec(this.client);hexpiretime=(...a)=>new aq(a,this.opts).exec(this.client);httl=(...a)=>new aM(a,this.opts).exec(this.client);hpexpire=(...a)=>new as(a,this.opts).exec(this.client);hpexpireat=(...a)=>new at(a,this.opts).exec(this.client);hpexpiretime=(...a)=>new au(a,this.opts).exec(this.client);hpttl=(...a)=>new av(a,this.opts).exec(this.client);hpersist=(...a)=>new ar(a,this.opts).exec(this.client);hget=(...a)=>new aw(a,this.opts).exec(this.client);hgetall=(...a)=>new ax(a,this.opts).exec(this.client);hgetdel=(...a)=>new aA(a,this.opts).exec(this.client);hgetex=(...a)=>new aB(a,this.opts).exec(this.client);hincrby=(...a)=>new aC(a,this.opts).exec(this.client);hincrbyfloat=(...a)=>new aD(a,this.opts).exec(this.client);hkeys=(...a)=>new aE(a,this.opts).exec(this.client);hlen=(...a)=>new aF(a,this.opts).exec(this.client);hmget=(...a)=>new az(a,this.opts).exec(this.client);hmset=(a,b)=>new aG([a,b],this.opts).exec(this.client);hrandfield=(a,b,c)=>new w([a,b,c],this.opts).exec(this.client);hscan=(...a)=>new aH(a,this.opts).exec(this.client);hset=(a,b)=>new aI([a,b],this.opts).exec(this.client);hsetex=(...a)=>new aJ(a,this.opts).exec(this.client);hsetnx=(a,b,c)=>new aK([a,b,c],this.opts).exec(this.client);hstrlen=(...a)=>new aL(a,this.opts).exec(this.client);hvals=(...a)=>new aN(a,this.opts).exec(this.client);incr=(...a)=>new aO(a,this.opts).exec(this.client);incrby=(...a)=>new aP(a,this.opts).exec(this.client);incrbyfloat=(...a)=>new aQ(a,this.opts).exec(this.client);keys=(...a)=>new bc(a,this.opts).exec(this.client);lindex=(...a)=>new bd(a,this.opts).exec(this.client);linsert=(a,b,c,d)=>new be([a,b,c,d],this.opts).exec(this.client);llen=(...a)=>new bf(a,this.opts).exec(this.client);lmove=(...a)=>new bg(a,this.opts).exec(this.client);lpop=(...a)=>new bi(a,this.opts).exec(this.client);lmpop=(...a)=>new bh(a,this.opts).exec(this.client);lpos=(...a)=>new bj(a,this.opts).exec(this.client);lpush=(a,...b)=>new bk([a,...b],this.opts).exec(this.client);lpushx=(a,...b)=>new bl([a,...b],this.opts).exec(this.client);lrange=(...a)=>new bm(a,this.opts).exec(this.client);lrem=(a,b,c)=>new bn([a,b,c],this.opts).exec(this.client);lset=(a,b,c)=>new bo([a,b,c],this.opts).exec(this.client);ltrim=(...a)=>new bp(a,this.opts).exec(this.client);mget=(...a)=>new bq(a,this.opts).exec(this.client);mset=a=>new br([a],this.opts).exec(this.client);msetnx=a=>new bs([a],this.opts).exec(this.client);persist=(...a)=>new bt(a,this.opts).exec(this.client);pexpire=(...a)=>new bu(a,this.opts).exec(this.client);pexpireat=(...a)=>new bv(a,this.opts).exec(this.client);pfadd=(...a)=>new bw(a,this.opts).exec(this.client);pfcount=(...a)=>new bx(a,this.opts).exec(this.client);pfmerge=(...a)=>new by(a,this.opts).exec(this.client);ping=a=>new bz(a,this.opts).exec(this.client);psetex=(a,b,c)=>new bA([a,b,c],this.opts).exec(this.client);psubscribe=a=>{let b=Array.isArray(a)?a:[a];return new cR(this.client,b,!0,this.opts)};pttl=(...a)=>new bB(a,this.opts).exec(this.client);publish=(...a)=>new bC(a,this.opts).exec(this.client);randomkey=()=>new bD().exec(this.client);rename=(...a)=>new bE(a,this.opts).exec(this.client);renamenx=(...a)=>new bF(a,this.opts).exec(this.client);rpop=(...a)=>new bG(a,this.opts).exec(this.client);rpush=(a,...b)=>new bH([a,...b],this.opts).exec(this.client);rpushx=(a,...b)=>new bI([a,...b],this.opts).exec(this.client);sadd=(a,b,...c)=>new bJ([a,b,...c],this.opts).exec(this.client);scan(a,b){return new bK([a,b],this.opts).exec(this.client)}scard=(...a)=>new bL(a,this.opts).exec(this.client);scriptExists=(...a)=>new bM(a,this.opts).exec(this.client);scriptFlush=(...a)=>new bN(a,this.opts).exec(this.client);scriptLoad=(...a)=>new bO(a,this.opts).exec(this.client);sdiff=(...a)=>new bP(a,this.opts).exec(this.client);sdiffstore=(...a)=>new bQ(a,this.opts).exec(this.client);set=(a,b,c)=>new bR([a,b,c],this.opts).exec(this.client);setbit=(...a)=>new bS(a,this.opts).exec(this.client);setex=(a,b,c)=>new bT([a,b,c],this.opts).exec(this.client);setnx=(a,b)=>new bU([a,b],this.opts).exec(this.client);setrange=(...a)=>new bV(a,this.opts).exec(this.client);sinter=(...a)=>new bW(a,this.opts).exec(this.client);sinterstore=(...a)=>new bX(a,this.opts).exec(this.client);sismember=(a,b)=>new bY([a,b],this.opts).exec(this.client);smismember=(a,b)=>new b$([a,b],this.opts).exec(this.client);smembers=(...a)=>new bZ(a,this.opts).exec(this.client);smove=(a,b,c)=>new b_([a,b,c],this.opts).exec(this.client);spop=(...a)=>new b0(a,this.opts).exec(this.client);srandmember=(...a)=>new b1(a,this.opts).exec(this.client);srem=(a,...b)=>new b2([a,...b],this.opts).exec(this.client);sscan=(...a)=>new b3(a,this.opts).exec(this.client);strlen=(...a)=>new b4(a,this.opts).exec(this.client);subscribe=a=>{let b=Array.isArray(a)?a:[a];return new cR(this.client,b,!1,this.opts)};sunion=(...a)=>new b5(a,this.opts).exec(this.client);sunionstore=(...a)=>new b6(a,this.opts).exec(this.client);time=()=>new b7().exec(this.client);touch=(...a)=>new b8(a,this.opts).exec(this.client);ttl=(...a)=>new b9(a,this.opts).exec(this.client);type=(...a)=>new ca(a,this.opts).exec(this.client);unlink=(...a)=>new cb(a,this.opts).exec(this.client);xadd=(...a)=>new ce(a,this.opts).exec(this.client);xack=(...a)=>new cc(a,this.opts).exec(this.client);xackdel=(...a)=>new cd(a,this.opts).exec(this.client);xdel=(...a)=>new ch(a,this.opts).exec(this.client);xdelex=(...a)=>new ci(a,this.opts).exec(this.client);xgroup=(...a)=>new cj(a,this.opts).exec(this.client);xread=(...a)=>new co(a,this.opts).exec(this.client);xreadgroup=(...a)=>new cp(a,this.opts).exec(this.client);xinfo=(...a)=>new ck(a,this.opts).exec(this.client);xlen=(...a)=>new cl(a,this.opts).exec(this.client);xpending=(...a)=>new cm(a,this.opts).exec(this.client);xclaim=(...a)=>new cg(a,this.opts).exec(this.client);xautoclaim=(...a)=>new cf(a,this.opts).exec(this.client);xtrim=(...a)=>new cr(a,this.opts).exec(this.client);xrange=(...a)=>new cn(a,this.opts).exec(this.client);xrevrange=(...a)=>new cq(a,this.opts).exec(this.client);zadd=(...a)=>("score"in a[1],new cs([a[0],a[1],...a.slice(2)],this.opts).exec(this.client));zcard=(...a)=>new ct(a,this.opts).exec(this.client);zcount=(...a)=>new cu(a,this.opts).exec(this.client);zdiffstore=(...a)=>new cL(a,this.opts).exec(this.client);zincrby=(a,b,c)=>new cv([a,b,c],this.opts).exec(this.client);zinterstore=(...a)=>new cw(a,this.opts).exec(this.client);zlexcount=(...a)=>new cx(a,this.opts).exec(this.client);zmscore=(...a)=>new cM(a,this.opts).exec(this.client);zpopmax=(...a)=>new cy(a,this.opts).exec(this.client);zpopmin=(...a)=>new cz(a,this.opts).exec(this.client);zrange=(...a)=>new cA(a,this.opts).exec(this.client);zrank=(a,b)=>new cB([a,b],this.opts).exec(this.client);zrem=(a,...b)=>new cC([a,...b],this.opts).exec(this.client);zremrangebylex=(...a)=>new cD(a,this.opts).exec(this.client);zremrangebyrank=(...a)=>new cE(a,this.opts).exec(this.client);zremrangebyscore=(...a)=>new cF(a,this.opts).exec(this.client);zrevrank=(a,b)=>new cG([a,b],this.opts).exec(this.client);zscan=(...a)=>new cH(a,this.opts).exec(this.client);zscore=(a,b)=>new cI([a,b],this.opts).exec(this.client);zunion=(...a)=>new cJ(a,this.opts).exec(this.client);zunionstore=(...a)=>new cK(a,this.opts).exec(this.client)};"u"<typeof atob&&(a.g.atob=a=>Buffer.from(a,"base64").toString("utf8"));var cX=class a extends cW{constructor(a){if("request"in a)return void super(a);a.url?(a.url.startsWith(" ")||a.url.endsWith(" ")||/\r|\n/.test(a.url))&&console.warn("[Upstash Redis] The redis url contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'url' property is missing or undefined in your Redis config."),a.token?(a.token.startsWith(" ")||a.token.endsWith(" ")||/\r|\n/.test(a.token))&&console.warn("[Upstash Redis] The redis token contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'token' property is missing or undefined in your Redis config.");const b=new q({baseUrl:a.url,retry:a.retry,headers:{authorization:`Bearer ${a.token}`},agent:a.agent,responseEncoding:a.responseEncoding,cache:a.cache??"no-store",signal:a.signal,keepAlive:a.keepAlive,readYourWrites:a.readYourWrites}),c="object"==typeof process&&process&&"object"==typeof process.env&&process.env?process.env:{};super(b,{automaticDeserialization:a.automaticDeserialization,enableTelemetry:a.enableTelemetry??!c.UPSTASH_DISABLE_TELEMETRY,latencyLogging:a.latencyLogging,enableAutoPipelining:a.enableAutoPipelining});const d="object"==typeof process&&process?process.version:void 0;if(this.addTelemetry({runtime:"string"==typeof EdgeRuntime?"edge-light":d?`node@${d}`:"unknown",platform:c.UPSTASH_CONSOLE?"console":c.VERCEL?"vercel":c.AWS_REGION?"aws":"unknown",sdk:"@upstash/redis@v1.36.2"}),this.enableAutoPipelining)return this.autoPipeline()}static fromEnv(b){if("object"!=typeof process||!process||"object"!=typeof process.env||!process.env)throw TypeError('[Upstash Redis] Unable to get environment variables, `process.env` is undefined. If you are deploying to cloudflare, please import from "@upstash/redis/cloudflare" instead');let c=process.env.UPSTASH_REDIS_REST_URL||process.env.KV_REST_API_URL;c||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_URL`");let d=process.env.UPSTASH_REDIS_REST_TOKEN||process.env.KV_REST_API_TOKEN;return d||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_TOKEN`"),new a({...b,url:c,token:d})}};let cY=(b=process.env.UPSTASH_REDIS_REST_URL,c=process.env.UPSTASH_REDIS_REST_TOKEN,b&&c?new cX({url:b,token:c}):(console.error("Redis credentials not configured"),new cX({url:b||"https://placeholder.upstash.io",token:c||"placeholder"})));a.s(["redis",0,cY],9358);let cZ={partner:a=>`partner:${a}`,partnerUsers:a=>`partner:${a}:users`,partnersByTier:a=>`partners:by-tier:${a}`,partnersByStatus:a=>`partners:by-status:${a}`,partnersByCountry:a=>`partners:by-country:${a}`,allPartners:()=>"partners:all",partnerCredential:a=>`credential:${a}`,partnerCredentials:a=>`partner:${a}:credentials`,allCredentials:()=>"credentials:all",credentialsByStatus:a=>`credentials:by-status:${a}`,credentialByEmail:a=>`credential:email:${a.toLowerCase()}`,user:a=>`user:${a}`,userByEmail:a=>`user:email:${a.toLowerCase()}`,session:a=>`session:${a}`,deal:a=>`deal:${a}`,partnerDeals:a=>`partner:${a}:deals`,dealsByDomain:a=>`deals:by-domain:${a.toLowerCase()}`,dealsByStage:a=>`deals:by-stage:${a}`,dealsByStatus:a=>`deals:by-status:${a}`,allDeals:()=>"deals:all",quote:a=>`quote:${a}`,dealQuotes:a=>`deal:${a}:quotes`,partnerQuotes:a=>`partner:${a}:quotes`,pricingConfig:()=>"pricing:config",trainingModule:a=>`training:module:${a}`,trainingModules:()=>"training:modules",userTrainingProgress:a=>`user:${a}:training:progress`,certification:a=>`certification:${a}`,userCertifications:a=>`user:${a}:certifications`,partnerCertifications:a=>`partner:${a}:certifications`,legalDocument:a=>`legal:document:${a}`,legalDocuments:()=>"legal:documents",legalSignature:a=>`legal:signature:${a}`,userSignatures:a=>`user:${a}:signatures`,partnerSignatures:a=>`partner:${a}:signatures`,legalDocumentV2:a=>`legal:v2:document:${a}`,partnerLegalDocuments:a=>`partner:${a}:legal:documents`,allLegalDocumentsV2:()=>"legal:v2:all",legalDocumentsByCategory:a=>`legal:v2:by-category:${a}`,legalDocumentsByStatus:a=>`legal:v2:by-status:${a}`,docusignEnvelope:a=>`legal:docusign:envelope:${a}`,documentAuditEvents:a=>`legal:v2:document:${a}:audit`,documentAuditEvent:a=>`legal:v2:audit:${a}`,copilotSession:a=>`copilot:session:${a}`,copilotMessages:a=>`copilot:session:${a}:messages`,copilotMeddic:a=>`copilot:session:${a}:meddic`,dealCopilotSessions:a=>`deal:${a}:copilot:sessions`,commission:a=>`commission:${a}`,partnerCommissions:a=>`partner:${a}:commissions`,dealCommission:a=>`deal:${a}:commission`,ratingEvents:a=>`partner:${a}:rating:events`,ratingCalculation:a=>`partner:${a}:rating:calculation`,partnerLastLogin:a=>`partner:${a}:last-login`,trainingCourse:a=>`training:course:${a}`,allTrainingCourses:()=>"training:courses:all",publishedTrainingCourses:()=>"training:courses:published",trainingCoursesByCategory:a=>`training:courses:by-category:${a}`,userCourseProgress:a=>`user:${a}:courses:progress`,auditLog:a=>`audit:log:${a}`,allAuditLogs:()=>"audit:logs:all",auditLogsByEntity:(a,b)=>`audit:logs:entity:${a}:${b}`,auditLogsByAction:a=>`audit:logs:by-action:${a}`,auditLogsByActor:a=>`audit:logs:by-actor:${a}`};async function c$(a){let b=await cY.hgetall(cZ.partner(a));return b&&b.id?("string"==typeof b.rating&&(b.rating=parseFloat(b.rating)),"string"==typeof b.totalDeals&&(b.totalDeals=parseInt(b.totalDeals,10)),"string"==typeof b.wonDeals&&(b.wonDeals=parseInt(b.wonDeals,10)),"string"==typeof b.totalRevenue&&(b.totalRevenue=parseFloat(b.totalRevenue)),"string"==typeof b.certifications&&b.certifications&&(b.certifications=JSON.parse(b.certifications)),b):null}async function c_(a=100){let b=await cY.zrange(cZ.allPartners(),0,a-1,{rev:!0});return(b.length||(b=(await cY.keys("partner:*")).filter(a=>!a.includes(":")||2===a.split(":").length).filter(a=>!a.includes("users")&&!a.includes("deals")&&!a.includes("legal")).map(a=>a.replace("partner:",""))),b.length)?(await Promise.all(b.map(a=>c$(a)))).filter(a=>null!==a):[]}async function c0(a){let b=await cY.smembers(cZ.partnersByStatus(a));return b.length?(await Promise.all(b.map(a=>c$(a)))).filter(a=>null!==a):[]}async function c1(a){let b=await cY.hgetall(cZ.user(a));return b&&b.id?b:null}async function c2(a){let b=await cY.hgetall(cZ.session(a));return b&&b.id?new Date(b.expiresAt)<new Date?(await c3(a),null):b:null}async function c3(a){await cY.del(cZ.session(a))}async function c4(a){let b=await cY.hgetall(cZ.deal(a));return b&&b.id?("string"==typeof b.population&&(b.population=parseInt(b.population,10)),"string"==typeof b.partnerGeneratedLead&&(b.partnerGeneratedLead="true"===b.partnerGeneratedLead),b):null}async function c5(a,b=50){let c=await cY.zrange(cZ.partnerDeals(a),0,b-1,{rev:!0});return c.length?(await Promise.all(c.map(a=>c4(a)))).filter(a=>null!==a):[]}async function c6(a){let b=await cY.smembers(cZ.dealsByStatus(a));return b.length?(await Promise.all(b.map(a=>c4(a)))).filter(a=>null!==a):[]}async function c7(a=100){let b=await cY.zrange(cZ.allDeals(),0,a-1,{rev:!0});return b.length?(await Promise.all(b.map(a=>c4(a)))).filter(a=>null!==a):[]}async function c8(a){let b=await cY.hgetall(cZ.certification(a));return b&&b.id?b:null}async function c9(a){let b=await cY.smembers(cZ.userCertifications(a));return b.length?(await Promise.all(b.map(a=>c8(a)))).filter(a=>null!==a):[]}async function da(a){let b=await cY.hgetall(cZ.commission(a));return b&&b.id?b:null}async function db(a){let b=await cY.smembers(cZ.partnerCommissions(a));return b.length?(await Promise.all(b.map(a=>da(a)))).filter(a=>null!==a):[]}a.s(["keys",0,cZ],15122);let dc={sovraGov:{tiers:[{maxPopulation:1e5,pricePerInhabitant:.5},{maxPopulation:25e4,pricePerInhabitant:.4},{maxPopulation:5e5,pricePerInhabitant:.32},{maxPopulation:1e6,pricePerInhabitant:.26},{maxPopulation:25e5,pricePerInhabitant:.2},{maxPopulation:5e6,pricePerInhabitant:.16},{maxPopulation:1e7,pricePerInhabitant:.13}]},sovraId:{essentials:{monthlyLimit:1e4,monthlyPrice:1e3},professional:{monthlyLimit:3e4,monthlyPrice:2e3},enterprise:{monthlyLimit:5e4,monthlyPrice:3e3}},services:{walletImplementation:5e3,integrationHourlyRate:150},discounts:{bronze:{base:5,leadBonus:0},silver:{base:20,leadBonus:10},gold:{base:25,leadBonus:15},platinum:{base:30,leadBonus:20}}};async function dd(){let a=await cY.get(cZ.pricingConfig());return a?"string"==typeof a?JSON.parse(a):a:(await de(dc),dc)}async function de(a){await cY.set(cZ.pricingConfig(),JSON.stringify(a))}async function df(a){let b=await cY.hgetall(cZ.auditLog(a));return b&&b.id?("string"==typeof b.changes&&b.changes&&(b.changes=JSON.parse(b.changes)),"string"==typeof b.metadata&&b.metadata&&(b.metadata=JSON.parse(b.metadata)),b):null}async function dg(a=100,b=0){let c=await cY.zrange(cZ.allAuditLogs(),b,b+a-1,{rev:!0});return c.length?(await Promise.all(c.map(a=>df(a)))).filter(a=>null!==a):[]}a.s(["deleteSession",()=>c3,"getAllAuditLogs",()=>dg,"getAllDeals",()=>c7,"getAllPartners",()=>c_,"getDeal",()=>c4,"getDealsByStatus",()=>c6,"getPartner",()=>c$,"getPartnerCommissions",()=>db,"getPartnerDeals",()=>c5,"getPartnersByStatus",()=>c0,"getPricingConfig",()=>dd,"getSession",()=>c2,"getUser",()=>c1,"getUserCertifications",()=>c9],13152)}];

//# sourceMappingURL=apps_web_partners-portal_src_lib_redis_operations_ts_ead7dae4._.js.map