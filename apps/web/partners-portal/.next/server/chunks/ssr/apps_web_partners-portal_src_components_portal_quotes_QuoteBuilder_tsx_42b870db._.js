module.exports=[35826,a=>{"use strict";var b=a.i(34076),c=a.i(88972),d=a.i(24321),e=a.i(41203),f=a.i(26464),g=a.i(95201);a.i(96149);var h=a.i(41165);function i(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(a)}function j(a){return a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(0)}K`:a.toLocaleString()}let k=[{value:"essentials",label:"Essentials",description:"Ideal para empezar"},{value:"professional",label:"Professional",description:"Para gobiernos en crecimiento"},{value:"enterprise",label:"Enterprise",description:"Maximo poder y flexibilidad"}];function l({deal:a,partner:l,pricingConfig:m,locale:n}){let o=(0,d.useRouter)(),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)("professional"),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(0),[D,E]=(0,c.useState)(null);(0,c.useEffect)(()=>{var b,c,d,e,f;let g,h,i,j,k,n,o,p,q,r,s,u,w,y,A,C,D;E((b={population:a.population,sovraGovIncluded:t,sovraIdIncluded:v,sovraIdPlan:x,walletImplementation:z,integrationHours:B,partnerTier:l.tier,partnerGeneratedLead:a.partnerGeneratedLead},g=function(a,b){let c=[...b.sovraGov.tiers].sort((a,b)=>a.maxPopulation-b.maxPopulation);for(let b of c)if(a<=b.maxPopulation)return b.pricePerInhabitant;return c[c.length-1]?.pricePerInhabitant||.13}(c=b.population,m),h=c*g,i={pricePerInhabitant:g,annualPrice:h},j=b.sovraGovIncluded?i.annualPrice:0,d=b.sovraIdPlan,n={monthlyLimit:(k=m.sovraId[d]).monthlyLimit,monthlyPrice:k.monthlyPrice,annualPrice:12*k.monthlyPrice},o=b.sovraIdIncluded?n.annualPrice:0,p=b.walletImplementation?m.services.walletImplementation:0,q=b.integrationHours*m.services.integrationHourlyRate,r={sovraGov:{included:b.sovraGovIncluded,populationUsed:b.population,pricePerInhabitant:i.pricePerInhabitant,annualPrice:b.sovraGovIncluded?i.annualPrice:0},sovraId:{included:b.sovraIdIncluded,plan:b.sovraIdPlan,monthlyLimit:n.monthlyLimit,monthlyPrice:n.monthlyPrice,annualPrice:b.sovraIdIncluded?n.annualPrice:0}},s={walletImplementation:b.walletImplementation,walletPrice:p,integrationHours:b.integrationHours,integrationPricePerHour:m.services.integrationHourlyRate,integrationTotal:q},u=j+o+p+q,e=b.partnerTier,f=b.partnerGeneratedLead,D=u*((C={basePercent:y=(w=m.discounts[e]).base,leadBonus:A=f?w.leadBonus:0,totalPercent:y+A}).totalPercent/100),{products:r,services:s,discounts:{partnerTier:b.partnerTier,partnerGeneratedLead:b.partnerGeneratedLead,baseDiscountPercent:C.basePercent,leadBonusPercent:C.leadBonus,totalDiscountPercent:C.totalPercent,discountAmount:D},subtotal:u,totalDiscount:D,total:u-D}))},[a.population,a.partnerGeneratedLead,l.tier,m,t,v,x,z,B]);let F=async()=>{if(D){q(!0);try{let b=await fetch("/api/partners/quotes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dealId:a.id,products:D.products,services:D.services,discounts:D.discounts,subtotal:D.subtotal,totalDiscount:D.totalDiscount,total:D.total})});if(!b.ok)throw Error("Failed to create quote");let{quote:c}=await b.json();s(c.id)}catch(a){console.error("Error creating quote:",a),alert("Error al crear la cotizacion")}finally{q(!1)}}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-xl p-6 text-white",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-2",children:a.clientName}),(0,b.jsxs)("p",{className:"text-blue-100",children:[a.country," - ","municipality"===a.governmentLevel?"Municipio":"province"===a.governmentLevel?"Provincia":"Nacional"]}),(0,b.jsxs)("p",{className:"text-2xl font-bold mt-2",children:[j(a.population)," habitantes"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"SovraGov"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Plataforma de gobierno digital"})]}),(0,b.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:t,onChange:a=>u(a.target.checked),className:"sr-only peer"}),(0,b.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),t&&D&&(0,b.jsxs)("div",{className:"p-4 bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Precio por habitante"}),(0,b.jsx)("span",{className:"font-medium",children:i(D.products.sovraGov.pricePerInhabitant)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm mt-2",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Poblacion"}),(0,b.jsx)("span",{className:"font-medium",children:j(a.population)})]}),(0,b.jsxs)("div",{className:"flex justify-between mt-3 pt-3 border-t border-gray-200",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:"Precio anual"}),(0,b.jsx)("span",{className:"font-bold text-blue-600",children:i(D.products.sovraGov.annualPrice)})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"SovraID"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Identidad digital ciudadana"})]}),(0,b.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:v,onChange:a=>w(a.target.checked),className:"sr-only peer"}),(0,b.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),v&&D&&(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("div",{className:"grid grid-cols-3 gap-3",children:k.map(a=>{let c=m.sovraId[a.value],d=x===a.value;return(0,b.jsxs)("button",{onClick:()=>y(a.value),className:`p-4 rounded-lg border-2 text-left transition-all ${d?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-900",children:a.label}),d&&(0,b.jsx)(e.Check,{className:"w-5 h-5 text-blue-600"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:a.description}),(0,b.jsxs)("p",{className:"text-lg font-bold text-gray-900",children:[i(c.monthlyPrice),"/mes"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Hasta ",c.monthlyLimit.toLocaleString()," verificaciones/mes"]})]},a.value)})}),(0,b.jsxs)("div",{className:"flex justify-between mt-4 pt-4 border-t border-gray-200",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:"Precio anual"}),(0,b.jsx)("span",{className:"font-bold text-blue-600",children:i(D.products.sovraId.annualPrice)})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"Servicios Profesionales"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Implementacion e integracion"})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:"Implementacion Wallet"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:i(m.services.walletImplementation)})]}),(0,b.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:z,onChange:a=>A(a.target.checked),className:"sr-only peer"}),(0,b.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:"Horas de Integracion"}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[i(m.services.integrationHourlyRate),"/hora"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("input",{type:"range",min:"0",max:"100",step:"5",value:B,onChange:a=>C(parseInt(a.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,b.jsxs)("span",{className:"text-lg font-bold text-gray-900 w-16 text-right",children:[B,"h"]})]}),B>0&&D&&(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Total: ",i(D.services.integrationTotal)]})]})]})]})]}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 sticky top-24",children:[(0,b.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:"Resumen de Cotizacion"})}),D&&(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[D.products.sovraGov.included&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"SovraGov"}),(0,b.jsx)("span",{className:"font-medium",children:i(D.products.sovraGov.annualPrice)})]}),D.products.sovraId.included&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:["SovraID (",D.products.sovraId.plan,")"]}),(0,b.jsx)("span",{className:"font-medium",children:i(D.products.sovraId.annualPrice)})]}),D.services.walletImplementation&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Implementacion Wallet"}),(0,b.jsx)("span",{className:"font-medium",children:i(D.services.walletPrice)})]}),D.services.integrationHours>0&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:["Integracion (",D.services.integrationHours,"h)"]}),(0,b.jsx)("span",{className:"font-medium",children:i(D.services.integrationTotal)})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[(0,b.jsx)("span",{className:"text-gray-900",children:"Subtotal"}),(0,b.jsx)("span",{className:"font-medium",children:i(D.subtotal)})]}),D.discounts.totalDiscountPercent>0&&(0,b.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm text-green-800",children:[(0,b.jsxs)("span",{children:["Descuento Partner (",l.tier,")"]}),(0,b.jsxs)("span",{children:["-",D.discounts.baseDiscountPercent,"%"]})]}),D.discounts.leadBonusPercent>0&&(0,b.jsxs)("div",{className:"flex justify-between text-sm text-green-800 mt-1",children:[(0,b.jsx)("span",{children:"Bonus Lead Generado"}),(0,b.jsxs)("span",{children:["-",D.discounts.leadBonusPercent,"%"]})]}),(0,b.jsxs)("div",{className:"flex justify-between font-medium text-green-900 mt-2 pt-2 border-t border-green-200",children:[(0,b.jsx)("span",{children:"Descuento total"}),(0,b.jsxs)("span",{children:["-",i(D.discounts.discountAmount)]})]})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[(0,b.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"Total"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:i(D.total)})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 text-right",children:"USD / ano"}),r?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-center",children:[(0,b.jsx)(e.Check,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),(0,b.jsx)("p",{className:"text-sm font-medium text-green-800",children:"Cotizacion creada"})]}),(0,b.jsxs)("button",{onClick:()=>{r&&window.open(`/api/partners/quotes/${r}/pdf`,"_blank")},className:"w-full py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 flex items-center justify-center gap-2",children:[(0,b.jsx)(g.Download,{className:"w-5 h-5"}),"Descargar PDF"]}),(0,b.jsx)("button",{onClick:()=>o.push(`/${n}/partners/portal/deals/${a.id}`),className:"w-full py-2 px-4 text-gray-600 hover:text-gray-800 text-sm",children:"Volver al deal"})]}):(0,b.jsx)("button",{onClick:F,disabled:p||0===D.subtotal,className:"w-full py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.SovraLoader,{size:"sm",className:"!w-4 !h-4 text-white"}),"Generando..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.FileText,{className:"w-5 h-5"}),"Crear Cotizacion"]})})]})]})})]})]})}a.s(["QuoteBuilder",()=>l],35826)}];

//# sourceMappingURL=apps_web_partners-portal_src_components_portal_quotes_QuoteBuilder_tsx_42b870db._.js.map